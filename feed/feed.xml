<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="pretty-atom-feed.xsl" type="text/xsl"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
  <title>DJ Adams</title>
  <subtitle>Reserving the right to be wrong</subtitle>
  <link href="https://qmacro.org/feed/feed.xml" rel="self" />
  <link href="https://qmacro.org/blog/" />
  <updated>2026-01-21T00:00:00Z</updated>
  <id>https://qmacro.org/blog/</id>
  <author>
    <name>DJ Adams</name>
  </author>
  <entry>
    <title>Modules, modularity &amp; reuse in CDS models - part 4 - from passive to active with @capire/common</title>
    <link href="https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/" />
    <updated>2026-01-21T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/</id>
    <content type="html">&lt;p&gt;(Get to all the parts in this series via the &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/&quot;&gt;series
post&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;In the &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/&quot;&gt;previous
part&lt;/a&gt;
we published &lt;code&gt;@qmacro/common&lt;/code&gt;. Let&#39;s start out here by creating a new simple
CAP Node.js project and bringing in that &lt;code&gt;@qmacro/common&lt;/code&gt; package; not only
will this show that we really do have a publicly available &amp;amp; shareable reuse
package, but observing what happens will also underline its simple and
&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/#active-vs-passive&quot;&gt;passive&lt;/a&gt;
nature.&lt;/p&gt;
&lt;h2 id=&quot;creating-a-simple-host-project&quot;&gt;Creating a simple host project&lt;/h2&gt;
&lt;p&gt;Instead of turning back to the &amp;quot;host&amp;quot; CAP Node.js project that &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#creating-a-simple-cap-node-js-project&quot;&gt;we created in
part
1&lt;/a&gt;
with the &lt;code&gt;packages/@qmacro/common&lt;/code&gt; workspace, let&#39;s create a fresh host project
to have a clean context into which to bring each reuse module. First, let&#39;s set
up&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; &lt;code&gt;use-qmacro&lt;/code&gt; for
&lt;a href=&quot;https://github.com/qmacro/common&quot;&gt;qmacro/common&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;cds init &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--add&lt;/span&gt; tiny-sample &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  use-qmacro &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The CDS model artifacts in the &amp;quot;tiny-sample&amp;quot; facet are still simple enough,
which is what we want. Starting the server now (with &lt;code&gt;cds watch&lt;/code&gt;) will allow us
to see what happens (and, perhaps a little more telling, what does not happen)
in subsequent steps:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; loaded model from &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; file&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;

  srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cat&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;outbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds

&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; connect to db &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; sqlite &lt;span class=&quot;token operator&quot;&gt;{&lt;/span&gt; url&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;:memory:&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; init from db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;data&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;my&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bookshop&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Books&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; successfully deployed to in&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;memory database&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Noteworthy here are the files which are being loaded for the CDS model, and the
initial data load from a CSV file that was found.&lt;/p&gt;
&lt;h2 id=&quot;qmacro-common&quot;&gt;@qmacro/common&lt;/h2&gt;
&lt;p&gt;It&#39;s now time to start exploring what it&#39;s like to actually use a reuse
package. We&#39;ll start here with &lt;code&gt;@qmacro/common&lt;/code&gt; and then later take a first
look at &lt;code&gt;@capire/common&lt;/code&gt;, so that we can compare what happens.&lt;/p&gt;
&lt;h3 id=&quot;adding-qmacro-common&quot;&gt;Adding @qmacro/common&lt;/h3&gt;
&lt;p&gt;In a second terminal session (so we can monitor the &lt;code&gt;cds watch&lt;/code&gt; output in the
first) let&#39;s install&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#footnotes&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; the &lt;code&gt;@qmacro/common&lt;/code&gt; reuse
module:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; @qmacro/common&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This emits something like this&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#footnotes&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;added &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; package&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; and audited &lt;span class=&quot;token number&quot;&gt;115&lt;/span&gt; packages in &lt;span class=&quot;token number&quot;&gt;858ms&lt;/span&gt;

found &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; vulnerabilities&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;More importantly, it causes the CAP server to restart. But so far, there are no
new log lines of interest - the same 3 files as before are loaded for the CDS
model, and the same single CSV file.&lt;/p&gt;
&lt;h3 id=&quot;using-qmacro-common&quot;&gt;Using @qmacro/common&lt;/h3&gt;
&lt;p&gt;Let&#39;s now make use of this simple passive reuse package by
importing&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#footnotes&quot;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;, as a first step:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; qmacro &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@qmacro/common&#39;; &lt;span class=&quot;token single-line-comment comment&quot;&gt;// &amp;lt;--&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; my.bookshop;

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Books {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID    : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
      title : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
      stock : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As soon as the file is saved with this new &lt;code&gt;using&lt;/code&gt; directive, the CAP server
restarts, and a new CDS file appears in the list of sources used to create the
CDS model:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; loaded model from &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; file&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;

  srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cat&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;outbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It&#39;s the
&lt;a href=&quot;https://github.com/qmacro/common/blob/a6e2daea6f9805e1b44fa71deccbe5ac9a6a0333/index.cds&quot;&gt;index.cds&lt;/a&gt;
file that &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#creating-the-index-entry-point&quot;&gt;we created in part
2&lt;/a&gt;,
nice!&lt;/p&gt;
&lt;p&gt;We haven&#39;t made use of the &lt;code&gt;qmacro.common.T&lt;/code&gt; type yet, but the compiler still
loads the reuse package contents (whatever &lt;code&gt;index.cds&lt;/code&gt; contains and / or refers
to).&lt;/p&gt;
&lt;p&gt;But the important thing to observe with this &amp;quot;passive&amp;quot; reuse package is that
&lt;em&gt;it&#39;s only once we explicitly refer to it in our model definitions that
anything happens&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To complete the test of this simple reuse package, we can of course add a
further element to the &lt;code&gt;Books&lt;/code&gt; entity definition like this, defined with this
imported type:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; qmacro &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@qmacro/common&#39;;

&lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; my.bookshop;

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Books {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID    : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
      title : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
      stock : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
      newel : qmacro.common.T; &lt;span class=&quot;token single-line-comment comment&quot;&gt;// &amp;lt;--&lt;/span&gt;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but this has no further effect on how the package is used or behaves.&lt;/p&gt;
&lt;p&gt;So far, so good! Let&#39;s now compare that with a first look at using
&lt;code&gt;@capire/common&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;creating-a-second-host-project&quot;&gt;Creating a second host project&lt;/h2&gt;
&lt;p&gt;To keep things clean and separate, let&#39;s now create a second host project just
like &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#creating-a-simple-host-project&quot;&gt;the first&lt;/a&gt;, this time called &lt;code&gt;use-capire&lt;/code&gt;,
and start up the CAP server straight after:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;cds init &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--add&lt;/span&gt; tiny-sample &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  use-capire &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cds &lt;span class=&quot;token function&quot;&gt;watch&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;If you&#39;re playing along at home, make sure you create this parallel to
&lt;code&gt;use-qmacro&lt;/code&gt;, not &lt;em&gt;within it&lt;/em&gt;, of course.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;From the &lt;code&gt;cds watch&lt;/code&gt; output, we see the same output as previously, at the same
stage, with &lt;code&gt;use-qmacro&lt;/code&gt;, most notably that the CDS model is composed of 3 files:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; loaded model from &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; file&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;

  srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cat&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;outbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;capire-common&quot;&gt;@capire/common&lt;/h2&gt;
&lt;p&gt;In the same way as with &lt;code&gt;@qmacro/common&lt;/code&gt;, let&#39;s this time add &lt;code&gt;@capire/common&lt;/code&gt;
to the project.&lt;/p&gt;
&lt;h3 id=&quot;associating-the-scope-with-the-registry&quot;&gt;Associating the scope with the registry&lt;/h3&gt;
&lt;p&gt;Just like how we associated &lt;code&gt;@qmacro&lt;/code&gt; with the GitHub Packages NPM registry &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/#associating-the-scope-with-the-registry&quot;&gt;in
the previous
part&lt;/a&gt;,
we&#39;ll need to do the same for &lt;code&gt;@capire&lt;/code&gt;, by adding another line to our
&lt;code&gt;~/.npmrc&lt;/code&gt; file&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#footnotes&quot;&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-ini&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token key attr-name&quot;&gt;@capire:registry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;https://npm.pkg.github.com&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;adding-capire-common&quot;&gt;Adding @capire/common&lt;/h3&gt;
&lt;p&gt;Now we can add it:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; @capire/common&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We get similar output to this as before, but significantly, when the CAP server
restarts, we see this:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; loaded model from &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; file&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;

  srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cat&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;outbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;capire&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;index&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;capire&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;regions&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;capire&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;currencies&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Waitwhat?&lt;/p&gt;
&lt;h3 id=&quot;active-vs-passive&quot;&gt;Active vs passive&lt;/h3&gt;
&lt;p&gt;What&#39;s going on? Where did they come from? Why are they appearing, even when we
haven&#39;t imported anything into the &lt;code&gt;use-capire&lt;/code&gt; model yet?&lt;/p&gt;
&lt;p&gt;This is our first glimpse of a side effect coming from the fact that -- unlike
&lt;code&gt;@qmacro/common&lt;/code&gt;, which is &lt;em&gt;passive&lt;/em&gt; -- &lt;code&gt;@capire/common&lt;/code&gt; is
&lt;em&gt;active&lt;/em&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/#footnotes&quot;&gt;&lt;sup&gt;6&lt;/sup&gt;&lt;/a&gt;. In other words, the reuse package will do
things, explicitly and sometimes immediately, as soon as we&#39;ve added it.&lt;/p&gt;
&lt;p&gt;How does that work? We&#39;ll find out in the next part!&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;While things would be fine without an &lt;code&gt;npm install&lt;/code&gt; at this setup stage
(using the globally installed &lt;code&gt;@sap/cds&lt;/code&gt; package rather than a project-local
one), we&#39;ll use &lt;code&gt;npm install&lt;/code&gt; here mostly for cosmetics - references in the
log output will be to project-local resources rather than global ones which
have far longer paths; also, we&#39;ll be running a package install shortly
anyway, so the main part of the install work might as well be done now.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Remember that you&#39;ll have to have the appropriate settings in an
&lt;a href=&quot;https://docs.npmjs.com/cli/v11/configuring-npm/npmrc&quot;&gt;npmrc&lt;/a&gt; file; see the
&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/#preparing-to-publish-the-package&quot;&gt;Preparing to publish the
package&lt;/a&gt;
section of the previous part for a reminder about this. Basically, you&#39;ll
need something like this, say, in &lt;code&gt;~/.npmrc&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-ini&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token key attr-name&quot;&gt;@qmacro:registry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;https://npm.pkg.github.com&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;//npm.pkg.github.com/:_authToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;A-CLASSIC-TOKEN-WITH-AT-LEAST-READ-PACKAGES-SCOPE&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The use of the top level name only (i.e. just &lt;code&gt;qmacro&lt;/code&gt;) in the &lt;code&gt;using&lt;/code&gt;
directive is deliberate here, just to show a different way of referencing
the scope and subsequent use in definition positions. See the
&lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#namespaces&quot;&gt;Namespaces&lt;/a&gt; section of
Capire&#39;s CDL topic for further details.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;I have &lt;code&gt;fund=false&lt;/code&gt; in my &lt;code&gt;~/.npmrc&lt;/code&gt; file so the &amp;quot;... packages are looking
for funding ...&amp;quot; messages are suppressed.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;There&#39;s an entire blog post on &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/blog/posts/2025/10/12/using-capire-modules-from-github-packages/&quot;&gt;Using @capire modules from GitHub
Packages&lt;/a&gt;,
in case you&#39;re interested.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The terms &amp;quot;active&amp;quot; and &amp;quot;passive&amp;quot; aren&#39;t official CAP terms, they&#39;re just
what I have come up wih to distinguish reuse package types.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>Modules, modularity &amp; reuse in CDS models - part 3 - publishing the simple reuse package</title>
    <link href="https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/" />
    <updated>2026-01-14T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/</id>
    <content type="html">&lt;p&gt;(Get to all the parts in this series via the &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/&quot;&gt;series
post&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;What we have from &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/&quot;&gt;part
2&lt;/a&gt;
is a simple project &lt;code&gt;myproj/&lt;/code&gt; which relies upon a simple reuse package
&lt;code&gt;@qmacro/common&lt;/code&gt;. That reuse package currently exists only within a workspace
within the &lt;code&gt;myproj/&lt;/code&gt; project. In order to be able to use it elsewhere and share
the reuse package with others, we need to publish it to a public NPM registry.&lt;/p&gt;
&lt;p&gt;One possibility would be the standard NPM registry at &lt;a href=&quot;https://www.npmjs.org&quot;&gt;https://www.npmjs.org&lt;/a&gt;.
Another is the NPM registry which is part of &lt;a href=&quot;https://docs.github.com/en/packages&quot;&gt;GitHub
Packages&lt;/a&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.
That&#39;s what I&#39;ll use here. It makes sense also to share the source too, which I
can do in parallel via a public repo in my &lt;a href=&quot;https://github.com/qmacro/&quot;&gt;user
space&lt;/a&gt; on GitHub, and I&#39;ll link the NPM package to
that repo as well.&lt;/p&gt;
&lt;p&gt;What we want to end up with is a setup that follows the
&lt;a href=&quot;https://github.com/capire/common&quot;&gt;capire/common&lt;/a&gt; repo and package:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/capire-common.png&quot; alt=&quot;The capire/common repo&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;sharing-the-reuse-package-source&quot;&gt;Sharing the reuse package source&lt;/h2&gt;
&lt;p&gt;First, let&#39;s share the source of &lt;code&gt;@qmacro/common&lt;/code&gt;. Clearly the content is not
earth-shattering, but serves to illustrate the pattern as a
passive&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; reuse package.&lt;/p&gt;
&lt;p&gt;As a reminder, here&#39;s what the entire project and workspace-enclosed reuse
package looks like (minus the &lt;code&gt;node_modules/&lt;/code&gt; directory, to keep things brief):&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package-lock.json&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
├── packages
│   └── &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro
│       └── common
│           ├── &lt;span class=&quot;token domain constant&quot;&gt;index.cds&lt;/span&gt;
│           └── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
└── &lt;span class=&quot;token domain constant&quot;&gt;services.cds&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It&#39;s the content of &lt;code&gt;packages/@qmacro/common/&lt;/code&gt; that we want to share, and we
can do that in the normal way, by introducing git-based source code control,
then creating a repo on GitHub based on that git-controlled source.&lt;/p&gt;
&lt;p&gt;While we can also add the main &lt;code&gt;myproj/&lt;/code&gt; project source to git-based source
code control, we won&#39;t do that now. Whenever we do it, we also want to remember
to exclude the content in &lt;code&gt;packages/&lt;/code&gt; as we want to share and manage the
packages source lifecycle separately.&lt;/p&gt;
&lt;h3 id=&quot;moving-to-the-appropriate-place&quot;&gt;Moving to the appropriate place&lt;/h3&gt;
&lt;p&gt;So first of all, starting from within the main project&#39;s root, i.e. &lt;code&gt;myproj/&lt;/code&gt;,
let&#39;s move into the reuse package&#39;s directory:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; packages/@qmacro/common/&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;adding-a-readme&quot;&gt;Adding a README&lt;/h3&gt;
&lt;p&gt;Every public repo on GitHub should have a README, even one as simple as this.
Let&#39;s just add one now:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;EOF&lt;span class=&quot;token bash punctuation&quot;&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;README.md&lt;/span&gt;
# @qmacro/common

See the series post
[Modules, modularity &amp;amp; reuse in CDS models](https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/)
for the background to this simple passive CDS model reuse package example.
EOF&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;setting-up-the-repo&quot;&gt;Setting up the repo&lt;/h3&gt;
&lt;p&gt;Now, within &lt;code&gt;packages/@qmacro/common/&lt;/code&gt;, let&#39;s set up the git-based source code
control:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; init &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; commit &lt;span class=&quot;token parameter variable&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;initial commit&#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This emits:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;Initialized empty Git repository in myproj&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;packages&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;git&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;main &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;commit&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;37f0091&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; initial commit
 &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; files changed&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; insertions&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;
 create mode &lt;span class=&quot;token number&quot;&gt;100644&lt;/span&gt; README&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;md
 create mode &lt;span class=&quot;token number&quot;&gt;100644&lt;/span&gt; &lt;span class=&quot;token domain constant&quot;&gt;index.cds&lt;/span&gt;
 create mode &lt;span class=&quot;token number&quot;&gt;100644&lt;/span&gt; &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;pushing-the-repo-to-github&quot;&gt;Pushing the repo to GitHub&lt;/h3&gt;
&lt;p&gt;Now let&#39;s share this with others by pushing it to GitHub, specifically as &lt;a href=&quot;https://github.com/qmacro?tab=repositories&quot;&gt;a
new repo in my user space&lt;/a&gt;. I&#39;m a
&lt;a href=&quot;https://qmacro.org/tags/gh/&quot;&gt;happy user&lt;/a&gt; of the excellent GitHub CLI
&lt;a href=&quot;https://cli.github.com/&quot;&gt;gh&lt;/a&gt;, so let&#39;s use that
here&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;gh repo create common &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--description&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Simple passive CDS model reuse package example&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--source&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--public&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--push&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This emits:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;✓ Created repository qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common on GitHub
✓ Added remote &lt;span class=&quot;token url&quot;&gt;https://github.com/qmacro/common.git&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Enumerating objects:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; done&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Counting objects:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; done&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
Delta compression using up to &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; threads
&lt;span class=&quot;token property&quot;&gt;Compressing objects:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; done&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Writing objects:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;686&lt;/span&gt; bytes &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;686.00&lt;/span&gt; KiB&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;s&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; done&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
Total &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;delta &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reused &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;delta &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pack&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;reused &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
To &lt;span class=&quot;token url&quot;&gt;https://github.com/qmacro/common.git&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;new branch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;      HEAD &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; main
branch &lt;span class=&quot;token string&quot;&gt;&#39;main&#39;&lt;/span&gt; set up to track &lt;span class=&quot;token string&quot;&gt;&#39;origin/main&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
✓ Pushed commits to &lt;span class=&quot;token url&quot;&gt;https://github.com/qmacro/common.git&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Et voila, the repo on GitHub is there.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/qmacro-common-no-package.png&quot; alt=&quot;the qmacro/common repo on
GitHub&quot;&gt;&lt;/p&gt;
&lt;p&gt;But there&#39;s no package ... yet.&lt;/p&gt;
&lt;h2 id=&quot;preparing-to-publish-the-package&quot;&gt;Preparing to publish the package&lt;/h2&gt;
&lt;p&gt;Let&#39;s do that now. First, there&#39;s some setup required for working with the NPM
registry in GitHub Packages.&lt;/p&gt;
&lt;h3 id=&quot;generating-a-token-for-authentication&quot;&gt;Generating a token for authentication&lt;/h3&gt;
&lt;p&gt;As the GitHub documentation article &lt;a href=&quot;https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry&quot;&gt;Working with the npm
registry&lt;/a&gt;
states:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;quot;You need an access token to publish, install, and delete private, internal,
and public packages.&amp;quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Heading over to the &lt;a href=&quot;https://github.com/settings/tokens&quot;&gt;Tokens (classic)&lt;/a&gt; area
of the GitHub Developer Settings, we should create a new classic token with the
following scopes:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/token-scopes.png&quot; alt=&quot;token scopes&quot;&gt;&lt;/p&gt;
&lt;p&gt;and will end up with something like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/classic-token-full-registry-access.png&quot; alt=&quot;classic token&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;associating-the-token-with-the-registry&quot;&gt;Associating the token with the registry&lt;/h3&gt;
&lt;p&gt;The value of the token can now be associated, in the
&lt;a href=&quot;https://docs.npmjs.com/cli/v11/configuring-npm/npmrc&quot;&gt;npmrc&lt;/a&gt;-based
configuration, with the NPM registry in GitHub Packages, which has the address
&lt;code&gt;npm.pkg.github.com&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In an existing or new &lt;code&gt;.npmrc&lt;/code&gt; file in your home directory, we need to add
this:&lt;/p&gt;
&lt;pre class=&quot;language-ini&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token key attr-name&quot;&gt;//npm.pkg.github.com/:_authToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;THE-TOKEN-JUST-GENERATED&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;For more on this, see the &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/blog/posts/2025/10/12/using-capire-modules-from-github-packages/#associate-the-token-with-the-registry&quot;&gt;Associate the token with the
registry&lt;/a&gt;
section of the blog post &lt;a href=&quot;https://qmacro.org/blog/posts/2025/10/12/using-capire-modules-from-github-packages/&quot;&gt;Using @capire modules from GitHub
Packages&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;associating-the-scope-with-the-registry&quot;&gt;Associating the scope with the registry&lt;/h3&gt;
&lt;p&gt;Additionally we&#39;ll need to tell the &lt;code&gt;npm&lt;/code&gt; command line tool about how it should
use the GitHub Packages NPM registry, rather than the (default) NPM registry at
&lt;a href=&quot;https://www.npmjs.com&quot;&gt;https://www.npmjs.com&lt;/a&gt;, for &lt;code&gt;@qmacro&lt;/code&gt;-scoped packages.&lt;/p&gt;
&lt;p&gt;Details about this are also covered in the aforementioned blog post in the
section &lt;a href=&quot;https://qmacro.org/blog/posts/2025/10/12/using-capire-modules-from-github-packages/#namespace-registry-mapping-required&quot;&gt;Namespace registry mapping
required&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In that same &lt;code&gt;~/.npmrc&lt;/code&gt; file, we need to add this too:&lt;/p&gt;
&lt;pre class=&quot;language-ini&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token key attr-name&quot;&gt;@qmacro:registry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;https://npm.pkg.github.com&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;associate-the-repo-with-the-package&quot;&gt;Associate the repo with the package&lt;/h2&gt;
&lt;p&gt;While one can register packages in the NPM registry on GitHub Packages that are
independent of any source repo on GitHub, it makes a lot of sense to have both
and have them linked. That way, one can go from the repo source to the package,
and from the package back to the repo source.&lt;/p&gt;
&lt;p&gt;All that&#39;s needed to make this association is a &lt;code&gt;repository&lt;/code&gt; property in the
&lt;code&gt;package.json&lt;/code&gt; file. So let&#39;s add that, and commit &amp;amp; push the change to GitHub.
Here&#39;s the entire contents of the &lt;code&gt;package.json&lt;/code&gt; file with that new
&lt;code&gt;repository&lt;/code&gt; property&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt; added:&lt;/p&gt;
&lt;pre class=&quot;language-json&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@qmacro/common&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;repository&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;git&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;url&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;git+https://github.com/qmacro/common.git&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;index.js&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;devDependencies&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;echo &#92;&quot;Error: no test specified&#92;&quot; &amp;amp;&amp;amp; exit 1&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;keywords&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;license&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ISC&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After committing this change and pushing it to the remote on GitHub:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; package.json &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; commit &lt;span class=&quot;token parameter variable&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;add repository property&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; push&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we&#39;re ready to actually publish the package!&lt;/p&gt;
&lt;h2 id=&quot;publishing-the-package&quot;&gt;Publishing the package&lt;/h2&gt;
&lt;p&gt;After all that preparation, our &lt;code&gt;~/.npmrc&lt;/code&gt; contents in place:&lt;/p&gt;
&lt;pre class=&quot;language-ini&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token key attr-name&quot;&gt;@qmacro:registry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;https://npm.pkg.github.com&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;//npm.pkg.github.com/:_authToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token value attr-value&quot;&gt;ghp_...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we&#39;re all set, and the process is simple:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; publish&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This emits output similar to the following:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;npm notice
npm notice 📦  &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0.0&lt;/span&gt;
npm notice Tarball Contents
npm notice &lt;span class=&quot;token number&quot;&gt;243B&lt;/span&gt; README&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;md
npm notice &lt;span class=&quot;token number&quot;&gt;44B&lt;/span&gt; &lt;span class=&quot;token domain constant&quot;&gt;index.cds&lt;/span&gt;
npm notice &lt;span class=&quot;token number&quot;&gt;349B&lt;/span&gt; &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
npm notice Tarball Details
&lt;span class=&quot;token property&quot;&gt;npm notice name:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common
&lt;span class=&quot;token property&quot;&gt;npm notice version:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.0.0&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;npm notice filename:&lt;/span&gt; qmacro&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tgz
&lt;span class=&quot;token property&quot;&gt;npm notice package size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;528&lt;/span&gt; B
&lt;span class=&quot;token property&quot;&gt;npm notice unpacked size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;636&lt;/span&gt; B
&lt;span class=&quot;token property&quot;&gt;npm notice shasum:&lt;/span&gt; d6b369d2e3db3878df8f9d9745b393f68a18b18b
&lt;span class=&quot;token property&quot;&gt;npm notice integrity:&lt;/span&gt; sha512&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Anr74Mjy9kRvb&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;RkUg3wgpto8UA&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;npm notice total files:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
npm notice
npm notice Publishing to &lt;span class=&quot;token url&quot;&gt;https://npm.pkg.github.com&lt;/span&gt; with tag latest and default access
&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which denotes success.&lt;/p&gt;
&lt;h2 id=&quot;examining-the-results&quot;&gt;Examining the results&lt;/h2&gt;
&lt;p&gt;Indeed, we can now see a package associated with the &lt;code&gt;qmacro/common&lt;/code&gt; repo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/qmacro-common-package-associated.png&quot; alt=&quot;qmacro/common package
associated&quot;&gt;&lt;/p&gt;
&lt;p&gt;and following that package link to the &lt;a href=&quot;https://github.com/qmacro/common/pkgs/npm/common&quot;&gt;package
page&lt;/a&gt;, we see:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/qmacro-common-package-info.png&quot; alt=&quot;qmacro/common package info&quot;&gt;&lt;/p&gt;
&lt;p&gt;which indeed also has a link (via the README) back to the
&lt;a href=&quot;https://github.com/qmacro/common&quot;&gt;repo&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;making-the-package-public&quot;&gt;Making the package public&lt;/h2&gt;
&lt;p&gt;As described in the &lt;a href=&quot;https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry#publishing-a-package&quot;&gt;Publishing a
package&lt;/a&gt;
section of &lt;a href=&quot;https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry&quot;&gt;Working with the npm
registry&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;quot;When you first publish a package, the default visibility is private.&amp;quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So in order for you to try this out, let&#39;s take one final step in this post,
and change the visibility to public.&lt;/p&gt;
&lt;p&gt;This is also simple and can be done via the package settings:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/changing-package-visibility-to-public.png&quot; alt=&quot;changing package visibility to
public&quot;&gt;&lt;/p&gt;
&lt;p&gt;And that&#39;s it!&lt;/p&gt;
&lt;h2 id=&quot;wrapping-up&quot;&gt;Wrapping up&lt;/h2&gt;
&lt;p&gt;All that&#39;s left for this post is for you to try the package out, by &lt;code&gt;npm add&lt;/code&gt;ing it to a CAP Node.js project. Let me know in the comments if it works
for you.&lt;/p&gt;
&lt;p&gt;Now that we understand the basics of a CDS model reuse package, in the next
post we&#39;ll start to take a closer look at
&lt;a href=&quot;https://github.com/capire/common&quot;&gt;capire/common&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;There are multiple registries in GitHub Packages - for Docker, Apache Maven,
RubyGems and more, as well as for Node.js packages.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;There&#39;s that
&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/#active-vs-passive&quot;&gt;passive&lt;/a&gt;
word again. I&#39;ll get to explaining what I mean by it at some point in this
series, honest!&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If you&#39;re not yet familiar with the command line tool options, you can
invoke just &lt;code&gt;gh repo create&lt;/code&gt; and follow the interactive prompts instead,
which start like this:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; What would you like to do&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Use arrows to move&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; type to filter&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Create a new repository on GitHub from scratch
  Push an existing local repository to GitHub&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;While a simpler string value like this:&lt;/p&gt;
&lt;pre class=&quot;language-json&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;repository&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://github.com/qmacro/common&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;will work (similar to &lt;a href=&quot;https://github.com/capire/common/blob/6fe89fb51a6b06cf65d18f6d66ef880545a9054f/package.json#L4&quot;&gt;how it&#39;s defined for
capire/common&lt;/a&gt;),
&lt;code&gt;npm publish&lt;/code&gt; will emit a warning like this:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;npm warn publish npm auto&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;corrected some errors in your &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt; when publishing&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;  Please run &lt;span class=&quot;token string&quot;&gt;&quot;npm pkg fix&quot;&lt;/span&gt; to address these errors&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;npm warn publish errors corrected:&lt;/span&gt;
npm warn publish &lt;span class=&quot;token string&quot;&gt;&quot;repository&quot;&lt;/span&gt; was changed from a string to an object
npm warn publish &lt;span class=&quot;token string&quot;&gt;&quot;repository.url&quot;&lt;/span&gt; was normalized to &lt;span class=&quot;token string&quot;&gt;&quot;git+https://github.com/qmacro/common.git&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>Modules, modularity &amp; reuse in CDS models - part 2 - creating a simple reuse package</title>
    <link href="https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/" />
    <updated>2026-01-07T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/</id>
    <content type="html">&lt;p&gt;(Get to all the parts in this series via the &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/&quot;&gt;series post&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;In &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/#wrapping-up&quot;&gt;wrapping up the end of part
1&lt;/a&gt;
we looked forward to creating the simplest kind of reuse module, not only as an
important fundamental building block but as a base for further understanding
and exploration (especially when we start looking closer at
&lt;a href=&quot;https://github.com/capire/common&quot;&gt;capire/common&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;What we&#39;ll do in this post is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;create a simple CAP Node.js project with a basic CDS model&lt;/li&gt;
&lt;li&gt;extend it by defining a custom type in a separate file, and using that type&lt;/li&gt;
&lt;li&gt;make that custom type definition reusable by creating an NPM package and putting it there instead&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Following best practice &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES002.md&quot;&gt;BES002 Think
local-first&lt;/a&gt;
we&#39;ll create and build out that NPM package locally, for the ultimate in
development iteration and &lt;a href=&quot;https://cap.cloud.sap/docs/about/#fast-inner-loops&quot;&gt;fast inner
loops&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;creating-a-simple-cap-node-js-project&quot;&gt;Creating a simple CAP Node.js project&lt;/h2&gt;
&lt;p&gt;For simplicity&#39;s sake, and to highlight the even more basic alternative
approach (to using &lt;code&gt;cds init&lt;/code&gt;) to create a new CAP Node.js project, we&#39;ll use
the NPM command line tool &lt;code&gt;npm&lt;/code&gt; as demonstrated by Daniel Schlachter in our &lt;a href=&quot;https://youtu.be/fUYNjuQbLzQ?si=7GyAUdnrAsUaTmlF&amp;amp;t=354&quot;&gt;Expert
Session: Getting started with CAP Node.js - 2025/2026
edition!&lt;/a&gt;. After all,
this post is ultimately all about Node.js packages.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://youtu.be/fUYNjuQbLzQ?si=7GyAUdnrAsUaTmlF&amp;amp;t=354&quot;&gt;&lt;img src=&quot;https://qmacro.org/images/2026/01/daniel-schlachter-from-scratch.png&quot; alt=&quot;Daniel uses npm init -y to start a new CAP Node.js project from
scratch&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Here goes:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; myproj &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; init &lt;span class=&quot;token parameter variable&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; @sap/cds express &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; --save-dev @cap-js/sqlite&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This creates everything we need for starting to develop a CAP Node.js project.
Firing things up with &lt;code&gt;cds watch&lt;/code&gt; gives us:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;cds serve all &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;with&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;mocks &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;in&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;memory&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt; live reload enabled for browsers &lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;
        ___________________________

    No models found in db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;app&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;app&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;schema&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    Waiting for some to arrive&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;All subsequent command line invocations in this post are from the same
location as this, i.e. at the project root, in &lt;code&gt;myproj/&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;adding-a-simple-cds-model&quot;&gt;Adding a simple CDS model&lt;/h2&gt;
&lt;p&gt;To keep things as simple as possible and not distract us from the goal, let&#39;s
define the CDS model in &lt;code&gt;services.cds&lt;/code&gt; as something minimal:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;context&lt;/span&gt; schema {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        e  : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
  }
}

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; S {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;on&lt;/span&gt; schema.E;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For those wondering about the starkness, here are a few notes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;In minimal scenarios like this, I like to have everything in one file, and my
choice of &lt;code&gt;services.cds&lt;/code&gt; is explained in &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/&quot;&gt;Why I use services.cds in simple
CDS model
examples&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Because everything is in one file, I can either define an entity directly
within a service, &amp;quot;in-flight&amp;quot; as it were, like this:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; Bookshop {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Books {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID    : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        title : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
        stock : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(this is from my &lt;code&gt;cdsnano&lt;/code&gt;
&lt;a href=&quot;https://github.com/qmacro/dotfiles/blob/main/scripts/cdsnano-template/services.cds&quot;&gt;template&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;but I have come to
&lt;a href=&quot;https://github.com/qmacro/dotfiles/blob/main/scripts/cdspico&quot;&gt;prefer&lt;/a&gt; using
the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#context&quot;&gt;context&lt;/a&gt; directive; that
way, I can make use of
&lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#views-projections&quot;&gt;projections&lt;/a&gt; as the
projection target is in a separate namespace (scope).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Even simpler than the Bookshop or Northwind theme, I am using single letters,
while still following the &lt;a href=&quot;https://cap.cloud.sap/docs/guides/domain-modeling#naming-conventions&quot;&gt;naming convention
rules&lt;/a&gt;
on capitalisation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;entity &lt;code&gt;E&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;element &lt;code&gt;e&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;service &lt;code&gt;S&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I chose &lt;code&gt;schema&lt;/code&gt; as the namespace, mostly because it reminds me of the name
of the first file I usually create in a &lt;code&gt;db/&lt;/code&gt; directory when modelling:
&lt;code&gt;schema.cds&lt;/code&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With the definitions in &lt;code&gt;services.cds&lt;/code&gt;, we&#39;re up and running with a full
service (some log lines omitted for brevity):&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; loaded model from &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; file&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;

  &lt;span class=&quot;token domain constant&quot;&gt;services.cds&lt;/span&gt;
  node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;outbox&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds

&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; serving S &lt;span class=&quot;token operator&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;at:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;/odata/v4/s&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;decl:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;services.cds:8&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;impl:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;node_modules/@sap/cds/srv/app-service.js&#39;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cds&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; server listening on &lt;span class=&quot;token operator&quot;&gt;{&lt;/span&gt; url&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;http://localhost:4004&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now let&#39;s start to extend that model a little.&lt;/p&gt;
&lt;h2 id=&quot;extending-with-a-separate-file-in-the-project&quot;&gt;Extending with a separate file in the project&lt;/h2&gt;
&lt;p&gt;For the sake of illustration, let&#39;s say we have a custom type that we want to
use in this model. We can take the smallest first step in the direction of a
couple of best practices:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES005.md&quot;&gt;BES005 Factor out separate
concerns&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES006.md&quot;&gt;BES006 Compose with reuse in
mind&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;by factoring that type out into a separate file, and then importing it into our
main model file &lt;code&gt;services.cds&lt;/code&gt; with the &lt;code&gt;using&lt;/code&gt; directive.&lt;/p&gt;
&lt;h3 id=&quot;a-simple-type-t&quot;&gt;A simple type T&lt;/h3&gt;
&lt;p&gt;In a new file &lt;code&gt;base.cds&lt;/code&gt;, also at the project root alongside &lt;code&gt;services.cds&lt;/code&gt;,
let&#39;s define the type:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; T : &lt;span class=&quot;token type builtin&quot;&gt;Boolean&lt;/span&gt;;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And in &lt;code&gt;services.cds&lt;/code&gt; let&#39;s use that to redefine the element &lt;code&gt;e&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; T &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;./base&#39;;

&lt;span class=&quot;token keyword&quot;&gt;context&lt;/span&gt; schema {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        e  : T;
  }
}

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; S {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;on&lt;/span&gt; schema.E;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So far so good.&lt;/p&gt;
&lt;h3 id=&quot;namespaces-are-a-good-idea&quot;&gt;Namespaces are a good idea&lt;/h3&gt;
&lt;p&gt;But that simple name &lt;code&gt;T&lt;/code&gt; makes me a little nervous in that it&#39;s unscoped, i.e.
at the equivalent of the global level, and this sort of practice is asking for
trouble down the line with name clashes. So let&#39;s put this definition for &lt;code&gt;T&lt;/code&gt;
into a scope with the &lt;code&gt;namespace&lt;/code&gt; directive; that way, we can more readily
reuse and share it.&lt;/p&gt;
&lt;p&gt;In &lt;code&gt;base.cds&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; qmacro.common;

&lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; T : &lt;span class=&quot;token type builtin&quot;&gt;Boolean&lt;/span&gt;;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In &lt;code&gt;services.cds&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; qmacro.common.T &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;./base&#39;;

&lt;span class=&quot;token keyword&quot;&gt;context&lt;/span&gt; schema {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        e  : T;
  }
}

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; S {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;on&lt;/span&gt; schema.E;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That&#39;s better!&lt;/p&gt;
&lt;p&gt;Everything works well, and I can add to the &lt;code&gt;base.cds&lt;/code&gt; file and use the
definitions therein as I build out the rest of the CDS model for the current
project.&lt;/p&gt;
&lt;p&gt;But one thing I cannot do is easily reuse those definitions in other projects.&lt;/p&gt;
&lt;h2 id=&quot;extending-via-an-npm-package&quot;&gt;Extending via an NPM package&lt;/h2&gt;
&lt;p&gt;To remedy this, I can transfer what I have in &lt;code&gt;base.cds&lt;/code&gt; to a new NPM package,
and use that. That way, I not only get to reuse the definitions in the current
project but I can also:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;maintain it independently, in its own lifecycle&lt;/li&gt;
&lt;li&gt;use it in other projects I&#39;m working on&lt;/li&gt;
&lt;li&gt;make it available for others to use in their projects&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Just like &lt;a href=&quot;https://github.com/capire/common&quot;&gt;capire/common&lt;/a&gt;, in fact! But much,
much simpler&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;creating-the-package-locally&quot;&gt;Creating the package locally&lt;/h3&gt;
&lt;p&gt;Best practice &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES002.md&quot;&gt;BES002 Think
local-first&lt;/a&gt;
exhorts us to take a local-first approach to development. That goes not only
for CAP components, but in general. And with NPM&#39;s
&lt;a href=&quot;https://docs.npmjs.com/cli/v11/using-npm/workspaces&quot;&gt;workspaces&lt;/a&gt; concept, we
can follow this best practice in building out our reuse package too.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;See the &lt;a href=&quot;https://qmacro.org/blog/posts/2025/02/14/tasc-notes-part-8/#local-development-submodules-and-workspaces&quot;&gt;Local development, submodules and
workspaces&lt;/a&gt;
section of the notes accompanying part 8 of &lt;a href=&quot;https://qmacro.org/blog/posts/2024/12/06/the-art-and-science-of-cap/&quot;&gt;The Art and Science of
CAP&lt;/a&gt;
for more on this.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;deciding-on-a-scope-and-a-name&quot;&gt;Deciding on a scope and a name&lt;/h4&gt;
&lt;p&gt;Like the namespace we added to the definition in &lt;code&gt;base.cds&lt;/code&gt;
&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#namespaces-are-a-good-idea&quot;&gt;earlier&lt;/a&gt;, it&#39;s also a good idea to think about a
scope for the package (in the same way that
&lt;a href=&quot;https://www.npmjs.com/search?q=%40sap&quot;&gt;@sap&lt;/a&gt;,
&lt;a href=&quot;https://www.npmjs.com/search?q=%40cap-js&quot;&gt;@cap-js&lt;/a&gt; and
&lt;a href=&quot;https://github.com/orgs/capire/packages&quot;&gt;@capire&lt;/a&gt; exist). It would make sense
to eventually publish it, and GitHub Packages&#39; NPM registry seems a good
bet.&lt;/p&gt;
&lt;p&gt;So let&#39;s go for &lt;code&gt;qmacro&lt;/code&gt; as the scope, and &lt;code&gt;common&lt;/code&gt; as the package name&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;setting-up-and-examining-the-workspace-constructs&quot;&gt;Setting up and examining the workspace constructs&lt;/h4&gt;
&lt;p&gt;Previously, in the &lt;a href=&quot;https://qmacro.org/blog/posts/2024/12/30/cap-node-js-plugins/&quot;&gt;CAP Node.js
Plugins&lt;/a&gt; mini
series, we set up a workspace in the &lt;a href=&quot;https://qmacro.org/blog/posts/2024/10/05/cap-node-js-plugins-part-1-how-things-work/#creating-our-own-plugin-package&quot;&gt;Creating our own plugin
package&lt;/a&gt;
section of part 1. We&#39;ll take a similar approach now, taking care to specify
our chosen scope this time:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; init &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--yes&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--workspace&lt;/span&gt; packages/@qmacro/common &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--scope&lt;/span&gt; @qmacro&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Running this command does quite a few things. Let&#39;s look at (a cut down version
of) the project&#39;s structure as a result of this:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
├── node_modules&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│   ├── &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;cap&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;js&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│   │   └── &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
│   ├── &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│   │   └── common &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;packages&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
│   ├── &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;sap&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;                                          &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
│   │       └── &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;                                    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package-lock.json&lt;/span&gt;                                  &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;                                       &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
├── packages&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;      &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token separator comment&quot;&gt;-----------------------------------&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
│   └── &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│       └── common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│           └── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;base.cds&lt;/span&gt;
└── &lt;span class=&quot;token domain constant&quot;&gt;services.cds&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What can we see? Well:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;There&#39;s a new &lt;code&gt;packages/&lt;/code&gt; directory in the project root; the name that we
chose (via the value for the &lt;code&gt;--workspace&lt;/code&gt; option) makes sense, given it&#39;s a
container for the NPM package we&#39;re going to create&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;That NPM package is represented locally within this new &lt;code&gt;packages/&lt;/code&gt;
directory, and currently contains just a simple &lt;code&gt;package.json&lt;/code&gt; file with
defaults (as we used &lt;code&gt;--yes&lt;/code&gt; to skip the package initialisation
questionnaire):&lt;/p&gt;
&lt;pre class=&quot;language-json&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@qmacro/common&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;index.js&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;devDependencies&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;echo &#92;&quot;Error: no test specified&#92;&quot; &amp;amp;&amp;amp; exit 1&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;keywords&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;license&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ISC&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Because of the &lt;code&gt;--scoped @qmacro&lt;/code&gt; option, this is a scoped package&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Additionally:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Within the standard NPM package location for the project, i.e. the
&lt;code&gt;node_modules/&lt;/code&gt; directory, there&#39;s a new path &lt;code&gt;@qmacro/common&lt;/code&gt; that has been
created as a symbolic link to the NPM package within &lt;code&gt;packages/&lt;/code&gt;, as
illustrated by the arrow; this means that we can work on developing the
package locally within &lt;code&gt;packages/@qmacro/common/&lt;/code&gt; and use it immediately in
the context of our project.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And if we look inside the project&#39;s &lt;code&gt;package.json&lt;/code&gt; file, we&#39;ll see:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;there&#39;s a new top level &lt;code&gt;workspaces&lt;/code&gt; property which has a reference to this
local NPM package directory:&lt;/p&gt;
&lt;pre class=&quot;language-json&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;myproj&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;...&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;workspaces&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;packages/@qmacro/common&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is a key component in the mechanism that allows a simplified use of
locally existing NPM packages within a project, &lt;a href=&quot;https://www.clivebanks.co.uk/THHGTTG/THHGTTGradio2.htm#:~:text=The%20Infinite%20Improbability%20Drive%20is%20a%20wonderful%20new%20method%20of%20crossing%20interstellar%20distances%20in%20a%20few%20seconds%2C%20without%20all%20that%20tedious%20mucking%20about%20in%20hyperspace&quot;&gt;without all that tedious
mucking about
with&lt;/a&gt;
&lt;code&gt;npm link&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;adding-the-package-as-a-project-dependency&quot;&gt;Adding the package as a project dependency&lt;/h4&gt;
&lt;p&gt;There&#39;s one more thing we should do now, but let&#39;s &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#adding-the-package-as-a-dependency&quot;&gt;defer it to the end of
this post&lt;/a&gt;, which will allow me to
illustrate some local behaviours.&lt;/p&gt;
&lt;h3 id=&quot;transferring-the-type-definition&quot;&gt;Transferring the type definition&lt;/h3&gt;
&lt;p&gt;Now that we have the NPM package, let&#39;s move the contents of &lt;code&gt;base.cds&lt;/code&gt; to it,
and also make a corresponding modification to the reference to it.&lt;/p&gt;
&lt;h4 id=&quot;moving-the-definition&quot;&gt;Moving the definition&lt;/h4&gt;
&lt;p&gt;The simplest first step is to move &lt;code&gt;base.cds&lt;/code&gt; from where it is in the project
root to the root of the &lt;code&gt;@qmacro/common&lt;/code&gt; package, i.e. to
&lt;code&gt;packages/@qmacro/common/&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mv&lt;/span&gt; base.cds packages/@qmacro/common/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;At this point, the structure for our project and our new local package looks
like this (the &lt;code&gt;node_modules/&lt;/code&gt; directory content has been omitted here for
brevity):&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package-lock.json&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
├── packages&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│   └── &lt;span class=&quot;token operator&quot;&gt;@&lt;/span&gt;qmacro&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│       └── common&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
│           ├── &lt;span class=&quot;token domain constant&quot;&gt;base.cds&lt;/span&gt;
│           └── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
└── &lt;span class=&quot;token domain constant&quot;&gt;services.cds&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;changing-the-using-directive&quot;&gt;Changing the using directive&lt;/h4&gt;
&lt;p&gt;Next up we should modify the reference in &lt;code&gt;services.cds&lt;/code&gt;. Instead of loading
&lt;code&gt;qmacro.common.T&lt;/code&gt; from &lt;code&gt;./base&lt;/code&gt;, i.e. the &lt;code&gt;base.cds&lt;/code&gt; file that was in the
project root, we&#39;ll want to load it from the &lt;code&gt;@qmacro/common&lt;/code&gt; package. This is
what we need to change &lt;code&gt;services.cds&lt;/code&gt; to (just the &lt;code&gt;using&lt;/code&gt; line has changed
here):&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; qmacro.common.T &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@qmacro/common&#39;;

&lt;span class=&quot;token keyword&quot;&gt;context&lt;/span&gt; schema {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        e  : T;
  }
}

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; S {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; E &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;on&lt;/span&gt; schema.E;
}&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;understanding-model-resolution&quot;&gt;Understanding model resolution&lt;/h4&gt;
&lt;p&gt;At this point, if you&#39;re using a decent editor with LSP support connected to an
instance of the CDS language server&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#footnotes&quot;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;, you&#39;ll likely
see a diagnostics error:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;Can&#39;t find package module &lt;span class=&quot;token string&quot;&gt;&#39;@qmacro/common&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;file&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;unknown&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;package&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can also elicit this error report by simply attempting to compile the
contents of &lt;code&gt;services.cds&lt;/code&gt; to CSN, like this, for example:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;cds compile services.cds&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This error occurs &lt;em&gt;not&lt;/em&gt; because the local setup of the NPM package is somehow
not right. It&#39;s because of the way &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#model-resolution&quot;&gt;model
resolution&lt;/a&gt; works:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Resolving module references: Names starting with neither &lt;code&gt;.&lt;/code&gt; nor &lt;code&gt;/&lt;/code&gt; such as
&lt;code&gt;@sap/cds/common&lt;/code&gt; are fetched for in &lt;code&gt;node_modules&lt;/code&gt; folders:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Files having &lt;code&gt;.cds&lt;/code&gt;, &lt;code&gt;.csn&lt;/code&gt;, or &lt;code&gt;.json&lt;/code&gt; as suffixes, appended in order&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Folders, from either the file set in &lt;code&gt;cds.main&lt;/code&gt; in the folder&#39;s
&lt;code&gt;package.json&lt;/code&gt; or &lt;code&gt;index.&amp;lt;cds|csn|json&amp;gt;&lt;/code&gt; file.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;In other words, we either need to use an &amp;quot;index&amp;quot; file, or add configuration to
the NPM package&#39;s &lt;code&gt;package.json&lt;/code&gt; file to point to the actual file in there,
i.e. &lt;code&gt;base.cds&lt;/code&gt;; that &lt;code&gt;cds.main&lt;/code&gt; configuration in &lt;code&gt;package.json&lt;/code&gt; would look
like this:&lt;/p&gt;
&lt;pre class=&quot;language-json&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;@qmacro/common&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;index.js&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;devDependencies&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;echo &#92;&quot;Error: no test specified&#92;&quot; &amp;amp;&amp;amp; exit 1&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;keywords&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;license&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ISC&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;cds&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;base&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;With this in place, the reference in&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; qmacro.common.T &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@qmacro/common&#39;;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;works fine and the error goes away.&lt;/p&gt;
&lt;p&gt;However, while it works, adding explicit configuration like this goes against
axiom &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/axioms/AXI003.md&quot;&gt;AX003 Convention over
configuration&lt;/a&gt;. So
let&#39;s not do that.&lt;/p&gt;
&lt;p&gt;Moreover, it&#39;s actually good practice to use an &amp;quot;index&amp;quot; file (in the form of
&lt;code&gt;index.cds&lt;/code&gt;) as the entry point for reuse packages such as this one that we&#39;re
creating - see &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES007.md&quot;&gt;BES007 Provide public entry points to reuse
packages&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;creating-the-index-entry-point&quot;&gt;Creating the index entry point&lt;/h4&gt;
&lt;p&gt;So let&#39;s avoid any explicit &lt;code&gt;cds.main&lt;/code&gt; configuration, and create an &lt;code&gt;index.cds&lt;/code&gt;
file in the package root. The simplest thing would be to rename &lt;code&gt;base.cds&lt;/code&gt;, so
that&#39;s what we&#39;ll do:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mv&lt;/span&gt; packages/@qmacro/common/base.cds packages/@qmacro/common/index.cds&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nice!&lt;/p&gt;
&lt;h3 id=&quot;adding-the-package-as-a-dependency&quot;&gt;Adding the package as a dependency&lt;/h3&gt;
&lt;p&gt;There&#39;s one more thing we need to do, &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/#adding-the-package-as-a-project-dependency&quot;&gt;something which we deliberately deferred
until now&lt;/a&gt;, which is to add the
&lt;code&gt;@qmacro/common&lt;/code&gt; reuse package as a project dependency.&lt;/p&gt;
&lt;p&gt;Yes, everything works as we expect right now, but that&#39;s down to the NPM
workspace concept. We have our project, and the workspace-hosted reuse package,
which is accessible from the project. But what happens when we deploy that
project elsewhere? The workspace-based development is just that - for
development. So we need to ensure that our reuse package is brought in when
setting up the project elsewhere.&lt;/p&gt;
&lt;p&gt;Invoking:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; @qmacro/common&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;is all we need to do.&lt;/p&gt;
&lt;p&gt;This adds a reference to the package in the project&#39;s &lt;code&gt;dependencies&lt;/code&gt; property:&lt;/p&gt;
&lt;pre class=&quot;language-json&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;myproj&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;index.js&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;test&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;echo &#92;&quot;Error: no test specified&#92;&quot; &amp;amp;&amp;amp; exit 1&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;keywords&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;license&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ISC&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;dependencies&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;@qmacro/common&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;^1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;@sap/cds&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;^9.6.1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;express&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;^4.22.1&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;devDependencies&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;@cap-js/sqlite&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;^2.1.2&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;workspaces&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;packages/@qmacro/common&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;wrapping-up&quot;&gt;Wrapping up&lt;/h2&gt;
&lt;p&gt;At this point, we&#39;re all set, and we can continue to build out our project, and our reuse package, locally.&lt;/p&gt;
&lt;p&gt;In the next part we&#39;ll move beyond local development for the reuse package, and make it available publicly in the NPM registry within GitHub Packages.&lt;/p&gt;
&lt;p&gt;Thanks for reading!&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;schema.cds&lt;/code&gt; is also &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/&quot;&gt;one of the CDS roots&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;And &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/#active-vs-passive&quot;&gt;passive, rather than active&lt;/a&gt; - more on that another time.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In fact, for a package to be hosted in the NPM registry within GitHub Packages, the scope inevitably is required and comes from the corresponding user or org name on GitHub. My user name on GitHub is &lt;code&gt;qmacro&lt;/code&gt;. See &lt;a href=&quot;https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry&quot;&gt;Working with the npm registry&lt;/a&gt; for more details on this relationship.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If you&#39;re using the SAP Business Application Studio, or VS Code with the &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=SAPSE.vscode-cds&quot;&gt;SAP CDS Language Support&lt;/a&gt; extension, you&#39;ll have this already; if you want to set up Neovim to use the language server, see &lt;a href=&quot;https://qmacro.org/blog/posts/2025/06/10/a-modern-and-clean-neovim-setup-for-cap-node-js-configuration-and-diagnostics/&quot;&gt;A modern and clean Neovim setup for CAP Node.js - configuration and diagnostics&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>Why I use services.cds in simple CDS model examples</title>
    <link href="https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/" />
    <updated>2026-01-02T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/</id>
    <content type="html">&lt;p&gt;I&#39;m writing this short post so I can refer to it when I want to explain my use
of &lt;code&gt;services.cds&lt;/code&gt; when creating sample CDS models. I&#39;ve found myself explaining
multiple times across various blog posts&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; so I thought
it was time to fix that behaviour and write it once (more) and point to it.&lt;/p&gt;
&lt;p&gt;One of the axioms in CAP is &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/axioms/AXI003.md&quot;&gt;AXI003 Convention over
configuration&lt;/a&gt;.
And when we follow best practice &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES003.md&quot;&gt;BES003 Work in harmony with the
framework&lt;/a&gt;,
we exhert less effort, create fewer surprises for ourselves and others, and
things Just Work(tm).&lt;/p&gt;
&lt;p&gt;The &amp;quot;CDS roots&amp;quot; is one example of convention over configuration in action.
These roots are the pre-defined default locations that the CAP server will
search for CDS model definitions. You may know of the some of the roots
indirectly from the standard CAP Node.js directory structure scaffolded for you
with &lt;code&gt;cds init&lt;/code&gt; - the &lt;code&gt;app/&lt;/code&gt;, &lt;code&gt;srv/&lt;/code&gt; and &lt;code&gt;db/&lt;/code&gt; directories:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
├── README&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;md
├── app&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
├── db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;eslint.config.mjs&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
└── srv&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In addition to these three directories, there are a couple of files too that
are part of this pre-defined set: &lt;code&gt;schema.cds&lt;/code&gt; and
&lt;code&gt;services.cds&lt;/code&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/#footnotes&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We can ask to see these CDS roots like this:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;cds &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt; roots&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and we&#39;ll get&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/#footnotes&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;db/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;srv/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;app/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;schema&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;services&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So in a sample project, by putting my simple CDS model directly into a file
called &lt;code&gt;services.cds&lt;/code&gt; in the project root, everything will just work as I
expect, and I don&#39;t have to specify anything explicitly.&lt;/p&gt;
&lt;p&gt;This is also why my micro starter script
&lt;a href=&quot;https://github.com/qmacro/dotfiles/blob/main/scripts/cdsnano&quot;&gt;cdsnano&lt;/a&gt; and
&lt;a href=&quot;https://github.com/qmacro/dotfiles/tree/main/scripts/cdsnano-template&quot;&gt;corresponding
template&lt;/a&gt;
uses &lt;code&gt;services.cds&lt;/code&gt; with the simplest of meaningful service definitions in that
single file:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; Bookshop {
  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Books {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID    : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        title : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
        stock : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This follows the &lt;a href=&quot;https://creators.spotify.com/pod/profile/tech-aloud/episodes/The-Simplest-Thing-that-Could-Possibly-Work--A-conversation-with-Ward-Cunningham--Part-V---Bill-Venners-e5dpts&quot;&gt;simplest thing that could possibly
work&lt;/a&gt;
philosophy.&lt;/p&gt;
&lt;h2 id=&quot;see-also&quot;&gt;See also&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2025/05/01/fp-function-chains-and-cap-model-loading/&quot;&gt;FP, function chains and CAP model loading&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;In &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/02/why-i-use-services-cds-in-simple-cds-model-examples/blog/posts/2025/05/01/fp-function-chains-and-cap-model-loading/#footnotes&quot;&gt;the footnotes to FP, function chains and CAP model
loading&lt;/a&gt;,
in the &lt;a href=&quot;https://qmacro.org/blog/posts/2024/03/12/iso-content-for-common-cap-types/#basic-output-from-cds-watch&quot;&gt;Basic output from cds watch section of ISO content for common CAP
types&lt;/a&gt;,
in the &lt;a href=&quot;https://qmacro.org/blog/posts/2025/12/08/a-simple-exploration-of-status-transition-flows-in-cap/#footnotes&quot;&gt;footnotes to A simple exploration of status transition flows in
CAP&lt;/a&gt;
and likely other places too.&lt;/li&gt;
&lt;li&gt;Technically the names of the files are &lt;code&gt;schema&lt;/code&gt; and &lt;code&gt;services&lt;/code&gt; without the
&lt;code&gt;.cds&lt;/code&gt; extension, owing to another default behaviour which is to look for
CDS model files ending in any form, i.e. &lt;code&gt;.cds&lt;/code&gt;, &lt;code&gt;.csn&lt;/code&gt; or &lt;code&gt;.json&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Actually there&#39;s now a further default CDS root entry which is &lt;code&gt;app/*&lt;/code&gt;; this
variation was &lt;a href=&quot;https://cap.cloud.sap/docs/releases/dec25#loading-from-app-subfolders&quot;&gt;introduced in the Dec 2025
release&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>Modules, modularity &amp; reuse in CDS models</title>
    <link href="https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/" />
    <updated>2026-01-01T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/</id>
    <content type="html">&lt;ul&gt;
&lt;li&gt;01 Jan 2026 Part 1 &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/&quot;&gt;An introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;07 Jan 2026 Part 2 &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/&quot;&gt;Creating a simple reuse package&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;14 Jan 2026 Part 3 &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/14/modules-modularity-and-reuse-in-cds-models-part-3-publishing-the-simple-reuse-package/&quot;&gt;Publishing the simple reuse package&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;21 Jan 2026 Part 4 &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/21/modules-modularity-and-reuse-in-cds-models-part-4-from-passive-to-active-with-capire-common/&quot;&gt;From passive to active with @capire/common&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;28 Jan 2026 Part 5 Digging into @capire/common&lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  <entry>
    <title>Modules, modularity &amp; reuse in CDS models - part 1 - an introduction</title>
    <link href="https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/" />
    <updated>2026-01-01T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/</id>
    <content type="html">&lt;p&gt;(Get to all the parts in this series via the &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models/&quot;&gt;series post&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;You know the drill: instead of inventing your own versions of core model
building blocks over and over again, use &lt;a href=&quot;https://cap.cloud.sap/docs/cds/common&quot;&gt;common types and
aspects&lt;/a&gt; for reuse, like this:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; {
  managed,
  cuid,
  Currency
} &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@sap/cds/common&#39;;

&lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; qmacro;

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Books : managed, cuid {
  title    : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
  price    : &lt;span class=&quot;token type builtin&quot;&gt;Decimal&lt;/span&gt;;
  currency : Currency;
  ...
}&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;There are &lt;a href=&quot;https://cap.cloud.sap/docs/cds/common#why-use-sap-cds-common&quot;&gt;plenty more great
reasons&lt;/a&gt; to use
&lt;code&gt;@sap/cds/common&lt;/code&gt;, by the way.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;But how does that &lt;code&gt;using ... from&lt;/code&gt; actually work, what is going on with what
looks like some sort of NPM module reference, i.e. &lt;code&gt;@sap/cds/common&lt;/code&gt;?&lt;/p&gt;
&lt;h2 id=&quot;imports-and-model-resolution&quot;&gt;Imports and model resolution&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#model-imports&quot;&gt;Model Imports&lt;/a&gt; section
of the CDL topic in Capire explains it. Basically, model definitions, most
commonly in &lt;code&gt;.cds&lt;/code&gt; files, can be imported from relative or absolute paths, or
from NPM modules. Either way, the reference will result in a file specification
or a directory specification; if it&#39;s a directory, then an &lt;code&gt;index.cds&lt;/code&gt; will be
loaded from within.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In addition to &lt;code&gt;.cds&lt;/code&gt;, file extensions &lt;code&gt;.csn&lt;/code&gt; and &lt;code&gt;.json&lt;/code&gt; are also supported.
In fact it&#39;s good practice to omit the extension when
specifying an import source, to allow these possibilities to be automatically
enumerated.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Of course, for an NPM module source to be used, it has to be present, i.e.
added to the project (thus the resolved path will be within the project&#39;s
&lt;code&gt;node_modules/&lt;/code&gt; directory).&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;@sap/cds/common&lt;/code&gt; reference, shown in the code snippet above, is a special
case, in more ways than one:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;As &lt;code&gt;@sap/cds&lt;/code&gt; is fundamental to any CAP Node.js project, it&#39;s always going
to be available&lt;/li&gt;
&lt;li&gt;Even if it&#39;s not there locally, i.e. if an initial project &lt;code&gt;npm install&lt;/code&gt;
hasn&#39;t been executed, it&#39;s still available from the global CAP Node.js runtime&lt;/li&gt;
&lt;li&gt;It&#39;s a reference to a location &lt;em&gt;within&lt;/em&gt; the &lt;code&gt;@sap/cds&lt;/code&gt; module, i.e. to
&lt;code&gt;common&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;That reference also follows the good practice of not using an extension;
&lt;code&gt;common&lt;/code&gt; here translates into the file &lt;code&gt;common.cds&lt;/code&gt; within &lt;code&gt;@sap/cds&lt;/code&gt; in the
project&#39;s &lt;code&gt;node_modules/&lt;/code&gt; directory (or the global one in special case #2).&lt;/p&gt;
&lt;p&gt;So NPM module based sources, including &lt;code&gt;@&lt;/code&gt;-prefixed ones, work pretty much
exactly the same way as plain file or directory references, such as this
classic:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; {sap.capire.bookshop &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; my} &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;../db/schema&#39;;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;modules-in-the-capire-namespace&quot;&gt;Modules in the capire namespace&lt;/h2&gt;
&lt;p&gt;In the &lt;a href=&quot;https://cap.cloud.sap/docs/releases/aug25&quot;&gt;August 2025 release&lt;/a&gt; of CAP,
which I covered in detail in &lt;a href=&quot;https://youtu.be/Gbz0-cAlxH0&quot;&gt;this SAP Developer News
episode&lt;/a&gt;, the new &lt;a href=&quot;https://github.com/capire&quot;&gt;capire org on
GitHub&lt;/a&gt; was announced, as the home of docs
and samples for CAP.&lt;/p&gt;
&lt;p&gt;In this org there are already plenty of CAP project repos, including those
originally contained in the (now archived)
&lt;a href=&quot;https://github.com/SAP-samples/cloud-cap-samples&quot;&gt;sap-samples/cloud-cap-samples&lt;/a&gt;
repo. In their new home, though, there are some intriguing differences.&lt;/p&gt;
&lt;h3 id=&quot;module-capire-bookshop&quot;&gt;Module capire/bookshop&lt;/h3&gt;
&lt;p&gt;Take &lt;a href=&quot;https://github.com/capire/bookshop&quot;&gt;capire/bookshop&lt;/a&gt; for example.&lt;/p&gt;
&lt;p&gt;First, it&#39;s on its own, in fact all the CAP projects from within the
&lt;code&gt;sap-samples/cloud-cap-samples&lt;/code&gt; monorepo have been &amp;quot;exploded&amp;quot; out into
individual repos. Why? The clue is &amp;quot;reuse&amp;quot;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;See &lt;a href=&quot;https://github.com/qmacro/capref/blob/main/bestpractices/BES006.md&quot;&gt;BES006 Compose with reuse in
mind&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Augmenting that one-word clue is the fact that there&#39;s also an NPM
&lt;a href=&quot;https://github.com/capire/bookshop/pkgs/npm/bookshop&quot;&gt;package&lt;/a&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/01/modules-modularity-and-reuse-in-cds-models-part-1-an-introduction/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2025/10/capire-bookshop-package.png&quot; alt=&quot;The package page for capire/bookshop on
GitHub&quot;&gt;&lt;/p&gt;
&lt;p&gt;Where is this thing? What&#39;s it for? How would one use it? How does it work? How
do I create my own? I aim to answer these questions, and more, over the course
of the subsequent posts in this series.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Regarding the &amp;quot;how would one use it?&amp;quot; question, I have already covered the
&lt;em&gt;mechanics&lt;/em&gt; of retrieving a module from the NPM registry within GitHub Packages
in &lt;a href=&quot;https://qmacro.org/blog/posts/2025/10/12/using-capire-modules-from-github-packages/&quot;&gt;Using @capire modules from GitHub
Packages&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;To whet our appetite, let&#39;s round this blog post off with a quick look at
another module in the &lt;code&gt;capire&lt;/code&gt; namespace.&lt;/p&gt;
&lt;h3 id=&quot;module-capire-common&quot;&gt;Module capire/common&lt;/h3&gt;
&lt;p&gt;Alongside &lt;a href=&quot;https://github.com/capire/bookshop&quot;&gt;capire/bookshop&lt;/a&gt; in the &lt;a href=&quot;https://github.com/orgs/capire/repositories&quot;&gt;list of
repositories in the capire org&lt;/a&gt;
there&#39;s &lt;a href=&quot;https://github.com/orgs/capire/repositories&quot;&gt;capire/common&lt;/a&gt;,
explicitly denoted as &amp;quot;a reuse content package&amp;quot;.&lt;/p&gt;
&lt;p&gt;Its &lt;a href=&quot;https://github.com/capire/common/blob/main/readme.md&quot;&gt;README&lt;/a&gt; tells us
that it&#39;s a plugin that extends &lt;code&gt;@sap/cds/common&lt;/code&gt; while also providing
enhanced reuse data.&lt;/p&gt;
&lt;p&gt;Looking at the entire structure of the module, we see:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
├── LICENSE
├── &lt;span class=&quot;token domain constant&quot;&gt;cds-plugin.js&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;currencies.cds&lt;/span&gt;
├── data
│   ├── sap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Countries&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
│   ├── sap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Countries_texts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
│   ├── sap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Currencies&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
│   ├── sap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Currencies_texts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
│   ├── sap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Languages&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
│   └── sap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;common&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Languages_texts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;csv
├── &lt;span class=&quot;token domain constant&quot;&gt;index.cds&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;package.json&lt;/span&gt;
├── &lt;span class=&quot;token domain constant&quot;&gt;readme.md&lt;/span&gt;
└── &lt;span class=&quot;token domain constant&quot;&gt;regions.cds&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Most of the files contain data in CSV form, and there are a couple
of CDS files brought together via an &lt;code&gt;index.cds&lt;/code&gt; file:&lt;/p&gt;
&lt;pre class=&quot;language-text&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;        index
          |
    +-----+-----+
    |           |
currencies   regions&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(more on that index file mechanism later in this series).&lt;/p&gt;
&lt;p&gt;There&#39;s also a &lt;code&gt;cds-plugin.js&lt;/code&gt; file (see the &lt;a href=&quot;https://qmacro.org/blog/posts/2024/12/30/cap-node-js-plugins/&quot;&gt;CAP Node.js
Plugins&lt;/a&gt; series post for links to
videos and blog posts on how plugins are constructed) as this is built to function
as a plugin.&lt;/p&gt;
&lt;p&gt;There&#39;s not much to this module, but it certainly packs a punch! Using it will
cause all sorts of goodness to be brought into play in your CAP project.&lt;/p&gt;
&lt;h4 id=&quot;active-vs-passive&quot;&gt;Active vs passive&lt;/h4&gt;
&lt;p&gt;Later on in this series I&#39;ll come to use the term &amp;quot;active&amp;quot; for this sort of
plugin-based reuse module, as opposed to &amp;quot;passive&amp;quot; for a reuse module that
isn&#39;t a plugin.&lt;/p&gt;
&lt;h2 id=&quot;wrapping-up&quot;&gt;Wrapping up&lt;/h2&gt;
&lt;p&gt;In an upcoming post in this series, we&#39;ll set up a simple CAP Node.js project and
then introduce this &lt;code&gt;@capire/common&lt;/code&gt; reuse module and observe what happens. Not only
that, but we&#39;ll endeavour to understand why and how things happen as they do.&lt;/p&gt;
&lt;p&gt;But we want to walk before we can run, so before that, we&#39;ll look at creating
our own basic reuse module, to understand the &lt;a href=&quot;https://creators.spotify.com/pod/show/tech-aloud/episodes/The-Simplest-Thing-that-Could-Possibly-Work--A-conversation-with-Ward-Cunningham--Part-V---Bill-Venners-e5dpts&quot;&gt;simplest thing that could
possibly
work&lt;/a&gt;,
and learn along the way not only how to develop and test that module locally,
but also how to then add it to the NPM registry on GitHub Packages.&lt;/p&gt;
&lt;p&gt;Until next time, happy reuse!&lt;/p&gt;
&lt;p&gt;Next in this series: &lt;a href=&quot;https://qmacro.org/blog/posts/2026/01/07/modules-modularity-and-reuse-in-cds-models-part-2-creating-a-simple-reuse-package/&quot;&gt;Creating a simple reuse
package&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;The terms &amp;quot;package&amp;quot; and &amp;quot;module&amp;quot;, in the context of NPM, can be used
interchangeably. I chose &amp;quot;module&amp;quot; here as it feels more appropriate in how they
are to be used to construct the overall CDS model, and also because it helps me
put some alliteration into the title of this post :)&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>A new Hands-on SAP Dev mini-series on the core expression language in CDS</title>
    <link href="https://qmacro.org/blog/posts/2025/12/09/a-new-hands-on-sap-dev-mini-series-on-the-core-expression-language-in-cds/" />
    <updated>2025-12-09T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2025/12/09/a-new-hands-on-sap-dev-mini-series-on-the-core-expression-language-in-cds/</id>
    <content type="html">&lt;p&gt;After Devtoberfest comes TechEd and the long tail of conferences that lead into
the holiday season. Then comes the new year, and a restart of our &lt;a href=&quot;https://community.sap.com/t5/technology-blog-posts-by-sap/hands-on-sap-dev-with-qmacro-new-live-stream-series/ba-p/13393464&quot;&gt;long
running&lt;/a&gt;
live stream show &amp;quot;Hands-on SAP Dev&amp;quot; on the &lt;a href=&quot;https://www.youtube.com/@sapdevs&quot;&gt;SAP Developers YouTube
channel&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We&#39;re starting 2026 off with an under-the-hood style mini-series exploring
expressions in CDS.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;16 Jan 2026 Part 1 - &lt;a href=&quot;https://www.youtube.com/watch?v=aiE20i5BP70&quot;&gt;Introduction and overview&lt;/a&gt; (replay)&lt;/li&gt;
&lt;li&gt;23 Jan 2026 Part 2 - &lt;a href=&quot;https://www.youtube.com/watch?v=s4IZR1LBRrA&quot;&gt;First CXL example expressions&lt;/a&gt; (upcoming)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It&#39;s all about CXL - the Core Expression Language. What&#39;s that? One of the mini
languages&lt;a href=&quot;https://qmacro.org/blog/posts/2025/12/09/a-new-hands-on-sap-dev-mini-series-on-the-core-expression-language-in-cds/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; in the CDS language family that is all
about expressions. Expressions are everywhere - they&#39;re used in queries, in
calculated elements and in annotations. They are fundamental to many of the
underlying design philosophies in CAP and convey power wrapped in simplicity
that is the hallmark of CDS.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=aiE20i5BP70&amp;amp;list=PL6RpkC85SLQABOpzhd7WI-hMpy99PxUo0&amp;amp;index=1&quot;&gt;&lt;img src=&quot;https://qmacro.org/images/2025/12/cxl-thumbnail.png&quot; alt=&quot;the new series thumbnail with me and
Patrice&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Also known as a &lt;a href=&quot;https://en.wikipedia.org/wiki/Domain-specific_language&quot;&gt;Domain Specific
Language&lt;/a&gt; (DSL).&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>A simple exploration of status transition flows in CAP</title>
    <link href="https://qmacro.org/blog/posts/2025/12/08/a-simple-exploration-of-status-transition-flows-in-cap/" />
    <updated>2025-12-08T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2025/12/08/a-simple-exploration-of-status-transition-flows-in-cap/</id>
    <content type="html">&lt;p&gt;The &lt;a href=&quot;https://cap.cloud.sap/docs/releases/nov25&quot;&gt;November 2025 release&lt;/a&gt; of CAP heralded &lt;a href=&quot;https://cap.cloud.sap/docs/releases/nov25#status-transition-flows&quot;&gt;a beta version of Status-Transition Flows&lt;/a&gt;, moving us up yet another gear in the journey towards declarative nirvana.&lt;/p&gt;
&lt;h2 id=&quot;background&quot;&gt;Background&lt;/h2&gt;
&lt;p&gt;I wanted to try out this new significant feature, one which embodies and celebrates one of the key reasons to use CAP - &lt;a href=&quot;https://qmacro.org/blog/posts/2024/11/07/five-reasons-to-use-cap/#1-the-code-is-in-the-framework-not-outside-of-it&quot;&gt;the code is in the framework, not outside of it&lt;/a&gt;. In the November release notes there&#39;s a brief glimpse of what this declarative approach looks like:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;annotate Travels with &lt;span class=&quot;token annotation important&quot;&gt;@flow.status:&lt;/span&gt; Status &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
  rejectTravel    @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Open  &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Canceled;
  acceptTravel    @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Open  &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Accepted;
  deductDiscount  @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Open;
};&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Of course, this is only part of how things are set up; following the link at the end of this section of the release notes leads us to &lt;a href=&quot;https://cap.cloud.sap/docs/guides/providing-services#status-transition-flows&quot;&gt;the relevant Capire section within the Providing Services topic&lt;/a&gt;, where we can see some of the rest of the CDS model (domain model and service definition specifically) that goes to make up the sample.&lt;/p&gt;
&lt;p&gt;I wanted to write my own example, complete but also as simple as possible, so I could then &lt;a href=&quot;https://qmacro.org/blog/posts/2017/02/19/the-beauty-of-recursion-and-list-machinery/#initial-recognition&quot;&gt;stare at it&lt;/a&gt; for a while to let things sink in. Here&#39;s what I came up with.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2025/12/double-toggle-switch.jpg&quot; alt=&quot;double toggle switch&quot;&gt;
(&lt;a href=&quot;https://commons.wikimedia.org/wiki/File:A_double_toggle_light_switch.jpg&quot;&gt;Image courtesy of Wikimedia Commons&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&quot;modelling-an-on-off-switch&quot;&gt;Modelling an on/off switch&lt;/h2&gt;
&lt;p&gt;After initialising a new CAP project (with &lt;code&gt;cds init&lt;/code&gt;), I just created a &lt;code&gt;services.cds&lt;/code&gt; file&lt;a href=&quot;https://qmacro.org/blog/posts/2025/12/08/a-simple-exploration-of-status-transition-flows-in-cap/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; with the following content:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;context&lt;/span&gt; qmacro {

  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; Status : &lt;span class=&quot;token type builtin&quot;&gt;String &lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;enum&lt;/span&gt; {
    Up;
    Down;
  }

  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Switches {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID     : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;
        status : Status &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;default&lt;/span&gt; #Down;
  }
}

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; SwitchService {

  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Switches &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;on&lt;/span&gt; qmacro.Switches

    &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
      &lt;span class=&quot;token keyword&quot;&gt;action&lt;/span&gt; flipUp();
      &lt;span class=&quot;token keyword&quot;&gt;action&lt;/span&gt; flipDown();
    };


  annotate Switches with &lt;span class=&quot;token annotation important&quot;&gt;@flow.status:&lt;/span&gt; status &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
    flipUp               @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;       : #Down  &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Up;
    flipDown             @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;       : #Up    &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Down;
  };
}&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;understanding-the-definitions&quot;&gt;Understanding the definitions&lt;/h2&gt;
&lt;p&gt;Recently I&#39;ve been looking more closely at CDS modelling in general and CDL in particular, partly in the context of creating the exercise content for the &lt;a href=&quot;https://github.com/SAP-samples/cap-cds-hands-on/&quot;&gt;Hands-on with CAP CDS&lt;/a&gt; workshop which I gave &lt;a href=&quot;https://qmacro.org/blog/posts/2025/09/10/upcoming-talks-in-autumn-2025/#ukisug-connect&quot;&gt;at UKISUG Connect&lt;/a&gt; at the start of this month. And I have come to value taking my time to understand the nuances of how models are expressed. Here are a few points of interest relating to the declarations here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I want to have everything in a single file to keep things as simple as possible&lt;/li&gt;
&lt;li&gt;This includes my data model, my service definition and my annotations&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With regards to the data model:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I&#39;m using the &lt;code&gt;context&lt;/code&gt; keyword to enclose my data model, which consists of a custom named type &lt;code&gt;Status&lt;/code&gt; and the entity &lt;code&gt;Switches&lt;/code&gt;, with a scope name prefix (&lt;code&gt;qmacro&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;status&lt;/code&gt; element of &lt;code&gt;Switches&lt;/code&gt; is defined with the custom &lt;code&gt;Status&lt;/code&gt; type which has its possible values as a list of &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#enums&quot;&gt;enumeration values&lt;/a&gt; (&lt;code&gt;Up&lt;/code&gt; and &lt;code&gt;Down&lt;/code&gt;); as this is the element that&#39;s going to be used as the status element, I&#39;ve given it a default value (&lt;code&gt;Down&lt;/code&gt;) as it requires one (no initial state can be provided on creation as the element should be readonly from the client perspective)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With regards to the service definition:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There&#39;s a pass-through projection (i.e. it defaults to an &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#views-with-inferred-signatures&quot;&gt;inferred signature&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;The projection is for the &lt;code&gt;Switches&lt;/code&gt; entity, and there&#39;s also a couple of &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#bound-actions&quot;&gt;bound actions&lt;/a&gt; declared as part of the entity definition that starts with &lt;code&gt;entity Switches ...&lt;/code&gt; and finishes with the semicolon &lt;code&gt;;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;As actions semantically signal that side-effects are likely, they&#39;ll need to be invoked with HTTP POST&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally there&#39;s the annotation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It&#39;s separate to the annotation target, and arguably easier to read that way; moreover, it would likely (or at least possibly) be in a separate file if it weren&#39;t so deliberately simple (see &lt;a href=&quot;https://qmacro.org/blog/posts/2024/11/04/separating-concerns-and-focusing-on-the-important-stuff/&quot;&gt;Separating concerns and focusing on the important stuff&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;It has been written in accordance with the description in the &lt;a href=&quot;https://cap.cloud.sap/docs/guides/providing-services#modeling-flows&quot;&gt;Modelling Flows&lt;/a&gt; section of the &lt;a href=&quot;https://cap.cloud.sap/docs/guides/providing-services&quot;&gt;Providing Services&lt;/a&gt; topic in Capire&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;digging-in-to-the-annotation&quot;&gt;Digging in to the annotation&lt;/h3&gt;
&lt;p&gt;The annotation is quite involved:&lt;/p&gt;
&lt;pre class=&quot;language-shell&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;annotate &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;target&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; with &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;annotation&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;info&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; actions &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and indeed the construction used is rather unusual:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;annotate &amp;lt;target&amp;gt; actions { ... }&lt;/code&gt; is &lt;a href=&quot;https://github.com/search?q=org%3Acapire+OR+org%3ASAP-samples+%2Fannotate+.%2B+actions%2F+path%3A*.cds&amp;amp;type=code&quot;&gt;reasonably common&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;but &lt;em&gt;two&lt;/em&gt; effective targets in a single annotation declaration context is &lt;a href=&quot;https://github.com/search?q=org%3Acapire+OR+org%3ASAP-samples+%2Fannotate+.%2B+with+%40.%2B+actions%2F+path%3A*.cds&amp;amp;type=code&quot;&gt;extremely rare&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What we have here is a sequence of two annotations in one. The single annotation expression above could just as readily be expressed like this&lt;a href=&quot;https://qmacro.org/blog/posts/2025/12/08/a-simple-exploration-of-status-transition-flows-in-cap/#footnotes&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;annotate Switches with &lt;span class=&quot;token annotation important&quot;&gt;@flow.status:&lt;/span&gt; status;

annotate Switches &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
  flipUp    @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Down  &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Up;
  flipDown  @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Up    &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Down;
};&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Separating these out like this makes it a bit easier for me to grok what&#39;s going on.&lt;/p&gt;
&lt;p&gt;First, we&#39;re blessing the &lt;code&gt;Switches&lt;/code&gt; entity with the Status-Transition Flows ability; at this level, we must specify the element to be used for the status. It&#39;s the &lt;code&gt;status&lt;/code&gt; element that&#39;s important, and we do that here by targeting the entire entity with the annotation and then specifying the element as a secondary piece of information. We could have annotated the element directly, like this:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;context&lt;/span&gt; qmacro {

  &lt;span class=&quot;token single-line-comment comment&quot;&gt;// ...&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Switches {
    &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID     : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;

        &lt;span class=&quot;token annotation important&quot;&gt;@flow.status&lt;/span&gt;
        status : Status &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;default&lt;/span&gt; #Down;
  }
}

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; SwitchService {

  &lt;span class=&quot;token single-line-comment comment&quot;&gt;// ...&lt;/span&gt;

  annotate Switches &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
    flipUp    @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Down  &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Up;
    flipDown  @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Up    &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Down;
  };

}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but, we&#39;d have needed to additionally, explicitly and manually specify the &lt;code&gt;@readonly&lt;/code&gt; annotation &lt;a href=&quot;https://cap.cloud.sap/docs/guides/providing-services#declare-flow-using-flow-status&quot;&gt;as directed&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Switches {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID     : &lt;span class=&quot;token type builtin&quot;&gt;Integer&lt;/span&gt;;

      &lt;span class=&quot;token annotation important&quot;&gt;@readonly&lt;/span&gt;
      &lt;span class=&quot;token annotation important&quot;&gt;@flow.status&lt;/span&gt;
      status : Status &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;default&lt;/span&gt; #Down;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the current state of how we make these declarations, specifying the flow status annotation at the entity level, and in the service layer, nearer to the related actions, makes more sense to me.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In case you&#39;re wondering, the original entity level &lt;code&gt;@flow.status&lt;/code&gt; annotation does indeed also cause a &lt;code&gt;@readonly&lt;/code&gt; annotation to be added; here&#39;s the relevant section of the CSN that&#39;s generated:&lt;/p&gt;
&lt;pre class=&quot;language-yaml&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;definitions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;SwitchService.Switches&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; entity
    &lt;span class=&quot;token key atrule&quot;&gt;&quot;@flow.status&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;&quot;=&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; status &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;projection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;ref&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;qmacro.Switches&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.Integer &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; qmacro.Status
        &lt;span class=&quot;token key atrule&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;&quot;#&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Down&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Down &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;&quot;@flow.status&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;&quot;@readonly&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;And, what of the actions themselves?&lt;/p&gt;
&lt;h3 id=&quot;looking-at-the-implementation-for-the-actions&quot;&gt;Looking at the implementation for the actions&lt;/h3&gt;
&lt;p&gt;We are used to having the CAP server provide a complete out-of-the-box CRUD handler experience for our services, on an entity by entity basis. We are also used to having to write our own handlers for custom &amp;quot;orthogonal&amp;quot; offerings such as actions and functions, as, almost by definition, they could be anything and are unguessable.&lt;/p&gt;
&lt;p&gt;And so here we are now with a couple of actions we&#39;ve declared:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token single-line-comment comment&quot;&gt;// ...&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;service&lt;/span&gt; SwitchService {

  &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Switches &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token cdl-keyword keyword&quot;&gt;projection&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;on&lt;/span&gt; qmacro.Switches

    &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
      &lt;span class=&quot;token keyword&quot;&gt;action&lt;/span&gt; flipUp();
      &lt;span class=&quot;token keyword&quot;&gt;action&lt;/span&gt; flipDown();
    };

    &lt;span class=&quot;token single-line-comment comment&quot;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and annotated:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;  &lt;span class=&quot;token single-line-comment comment&quot;&gt;// ...&lt;/span&gt;

  annotate Switches &lt;span class=&quot;token keyword&quot;&gt;actions&lt;/span&gt; {
    flipUp    @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Down  &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Up;
    flipDown  @&lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt;: #Up    &lt;span class=&quot;token annotation important&quot;&gt;@to:&lt;/span&gt; #Down;
  };
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here&#39;s what the implementation looks like, say in a corresponding &lt;code&gt;services.js&lt;/code&gt; file:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Yep, that&#39;s right. There is no implementation required, and no corresponding implementation file needed - that&#39;s sort of the whole point!&lt;/p&gt;
&lt;p&gt;With the declarative Status-Transition Flows approach, we&#39;ve declared everything we need with the annotations, describing what each action should do with respect to the status; what starting status requirements there are and what target statuses there can be. Here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;flipUp&lt;/code&gt;, which will transition the status to &lt;code&gt;Up&lt;/code&gt;, can only be invoked if the status is currently &lt;code&gt;Down&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;flipDown&lt;/code&gt;, which will transition the status to &lt;code&gt;Down&lt;/code&gt;, can only be invoked if the status is currently &lt;code&gt;Up&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Of course, there are far more flexible and involved possibilities here, which are nicely described &lt;a href=&quot;https://cap.cloud.sap/docs/guides/providing-services#status-transition-flows&quot;&gt;in the appropriate section&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;kicking-the-tyres&quot;&gt;Kicking the tyres&lt;/h2&gt;
&lt;p&gt;Now I have my model and service definition, and the appropriate annotations, what does it feel like, how does one interact with and experience it?&lt;/p&gt;
&lt;p&gt;Simply from an HTTP level, I&#39;ll give it a go. One can imagine how this then translates to calls being made from a frontend somewhere too, with buttons and other widgets in the UI enabled or disabled (or even hidden) according to the current status.&lt;/p&gt;
&lt;p&gt;I&#39;ll start the server with &lt;code&gt;cds watch&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;creating-my-first-switch&quot;&gt;Creating my first switch&lt;/h3&gt;
&lt;p&gt;OK, are there any existing switch entities?&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--silent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--url&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;localhost:4004/odata/v4/switch/Switches&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; jq
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;@odata.context&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$metadata&lt;/span&gt;#Switches&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No. So I&#39;ll create one:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--header&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Content-Type: application/json&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;{&quot;ID&quot;:1}&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--silent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--url&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;localhost:4004/odata/v4/switch/Switches&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; jq
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;@odata.context&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$metadata&lt;/span&gt;#Switches/&lt;span class=&quot;token variable&quot;&gt;$entity&lt;/span&gt;&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;ID&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;status&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Down&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It has the default status of &lt;code&gt;Down&lt;/code&gt;, as expected.&lt;/p&gt;
&lt;h3 id=&quot;trying-to-flip-the-switch-the-wrong-way&quot;&gt;Trying to flip the switch the wrong way&lt;/h3&gt;
&lt;p&gt;The switch is down, so I want to see if I can invoke the &lt;code&gt;flipDown&lt;/code&gt; action&lt;a href=&quot;https://qmacro.org/blog/posts/2025/12/08/a-simple-exploration-of-status-transition-flows-in-cap/#footnotes&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--request&lt;/span&gt; POST &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--include&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--url&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;localhost:4004/odata/v4/switch/Switches/1/flipDown&#39;&lt;/span&gt;
HTTP/1.1 &lt;span class=&quot;token number&quot;&gt;409&lt;/span&gt; Conflict
X-Powered-By: Express
OData-Version: &lt;span class=&quot;token number&quot;&gt;4.0&lt;/span&gt;
Content-Type: application/json&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;utf-8
Content-Length: &lt;span class=&quot;token number&quot;&gt;151&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;error&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Action &lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt;flipDown&lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt; requires &lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt;status&lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt; to be &lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt;[&lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt;Up&lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt;]&lt;span class=&quot;token entity&quot; title=&quot;&#92;&amp;quot;&quot;&gt;&#92;&quot;&lt;/span&gt;.&quot;&lt;/span&gt;,
    &lt;span class=&quot;token string&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INVALID_FLOW_TRANSITION_SINGLE&quot;&lt;/span&gt;,
    &lt;span class=&quot;token string&quot;&gt;&quot;@Common.numericSeverity&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nope! Plus, the HTTP status code 409 is &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/409&quot;&gt;nicely appropriate&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;flipping-the-switch-the-right-way&quot;&gt;Flipping the switch the right way&lt;/h3&gt;
&lt;p&gt;So how about flipping the switch from down to up?&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--request&lt;/span&gt; POST &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--include&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--url&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;localhost:4004/odata/v4/switch/Switches/1/flipUp&#39;&lt;/span&gt;
HTTP/1.1 &lt;span class=&quot;token number&quot;&gt;204&lt;/span&gt; No Content
X-Powered-By: Express
OData-Version: &lt;span class=&quot;token number&quot;&gt;4.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That seemed to work, but I&#39;ll check anyway:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--silent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token parameter variable&quot;&gt;--url&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;localhost:4004/odata/v4/switch/Switches/1&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#92;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; jq
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;@odata.context&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$metadata&lt;/span&gt;#Switches/&lt;span class=&quot;token variable&quot;&gt;$entity&lt;/span&gt;&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;ID&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;status&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Up&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Excellent!&lt;/p&gt;
&lt;h2 id=&quot;wrapping-up&quot;&gt;Wrapping up&lt;/h2&gt;
&lt;p&gt;Of course, there&#39;s a lot more that this new Status-Transition Flows feature offers, but for now, I&#39;m glad I took a first look with this simple example.&lt;/p&gt;
&lt;p&gt;For further explorations and explanations, see Simon Engel&#39;s great session &lt;a href=&quot;https://www.youtube.com/watch?v=1XolXCjN5IQ&quot;&gt;Status Transition Flows in CAP&lt;/a&gt; from Devtoberfest earlier this year, as well as the &lt;a href=&quot;https://cap.cloud.sap/docs/guides/providing-services#status-transition-flows&quot;&gt;coverage in Capire&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;And remember, this is a beta feature right now, so a great time to try it out for yourself.&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;The name of this file is significant, it&#39;s one of the two file items (the rest are directory items) in the &amp;quot;CDS roots&amp;quot;, as illustrated:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; cds &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt; roots
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;db/&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;srv/&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;app/&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;schema&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;services&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This means that it&#39;s a default (&amp;quot;well-known&amp;quot;) location for CDS model definitions.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;What&#39;s really going to blow your mind is that &lt;code&gt;annotate&lt;/code&gt; is really &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#the-annotate-directive&quot;&gt;just a shortcut variant&lt;/a&gt; of &lt;code&gt;extend&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;I use &lt;code&gt;--include&lt;/code&gt; to have the response headers emitted, but have only included some of them in the output here, to keep things brief.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>Some ramblings on simple CDS modelling with CDL</title>
    <link href="https://qmacro.org/blog/posts/2025/11/12/some-ramblings-on-simple-cds-modelling-with-cdl/" />
    <updated>2025-11-12T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2025/11/12/some-ramblings-on-simple-cds-modelling-with-cdl/</id>
    <content type="html">&lt;p&gt;I&#39;m taking some time to peruse the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl&quot;&gt;Conceptual Definition Language (CDL)&lt;/a&gt; topic of the CAP documentation, and stopped at the first example in the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#keywords-identifiers&quot;&gt;Keywords &amp;amp; Identifiers&lt;/a&gt; section, which piqued my interest. Let&#39;s put this in a file called &lt;code&gt;db/keywords-and-identifiers.cds&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; capire.bookshop;
&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; { managed, cuid } &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@sap/cds/common&#39;;
&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary : managed, cuid {}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Books : primary {
  title  : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
  author : &lt;span class=&quot;token association-composition keyword&quot;&gt;Association to Authors&lt;/span&gt;;
}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors : primary {
  name   : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;I have &lt;a href=&quot;https://github.com/capire/docs/commit/2c42b724a9d6c1efadecfe400c478bbe739365d2&quot;&gt;been involved in tweaking&lt;/a&gt; this section, just so you know.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;two-level-mixin&quot;&gt;Two-level mixin&lt;/h2&gt;
&lt;p&gt;The two-level mixin here made me pause for &lt;a href=&quot;https://qmacro.org/blog/posts/2017/02/19/the-beauty-of-recursion-and-list-machinery/#initial-recognition&quot;&gt;a stare&lt;/a&gt;, and also made me think what this definition looks like once compiled into &lt;a href=&quot;https://cap.cloud.sap/docs/cds/csn&quot;&gt;Core Schema Notation (CSN)&lt;/a&gt;. Let me simplify the above example as much as possible, to reduce any unnecessary noise:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token using keyword&quot;&gt;using&lt;/span&gt; cuid &lt;span class=&quot;token from keyword&quot;&gt;from&lt;/span&gt; &#39;@sap/cds/common&#39;;
&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary : cuid {}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors : primary {
  name   : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What do we have here?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the import of &lt;code&gt;cuid&lt;/code&gt; on its own (removing the need for the &lt;code&gt;{ ... }&lt;/code&gt; brace construct, by the way); &lt;code&gt;cuid&lt;/code&gt; is an aspect, defined (in &lt;code&gt;@sap/cds/common&lt;/code&gt;) like this: &lt;code&gt;aspect cuid { key ID : UUID; }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;the definition of another (empty) aspect &lt;code&gt;primary&lt;/code&gt;, which, via the &lt;code&gt;:&lt;/code&gt; &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#includes&quot;&gt;shortcut syntax&lt;/a&gt;, is extended with the &lt;code&gt;cuid&lt;/code&gt; aspect&lt;/li&gt;
&lt;li&gt;the definition of an entity with a single non-key element (&lt;code&gt;name&lt;/code&gt;); this entity is extended with the &lt;code&gt;primary&lt;/code&gt; aspect&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;surfacing-the-common-aspect&quot;&gt;Surfacing the common aspect&lt;/h2&gt;
&lt;p&gt;In order to reduce the noise further (especially when we start to look at what this CDS model compiles to), let&#39;s surface the &lt;code&gt;cuid&lt;/code&gt; aspect from &lt;code&gt;@sap/cds/common&lt;/code&gt; so we won&#39;t be inundated with the rest of &lt;code&gt;@sap/cds/common&lt;/code&gt; in what the compiler produces:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; cuid {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;UUID&lt;/span&gt;;
}

&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary : cuid {}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors : primary {
  name   : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Through the &amp;quot;two generation mixin ancestry&amp;quot;:&lt;/p&gt;
&lt;pre class=&quot;language-text&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;cuid
  |
  V
primary
  |
  V
Authors&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the &lt;code&gt;Authors&lt;/code&gt; entity has a primary key &lt;code&gt;ID&lt;/code&gt; as well as the &lt;code&gt;name&lt;/code&gt; element.&lt;/p&gt;
&lt;h2 id=&quot;examining-the-csn&quot;&gt;Examining the CSN&lt;/h2&gt;
&lt;p&gt;What does this look like when compiled to CSN? We&#39;ll take the YAML representation as that is a little less verbose and (arguably) easier to read than the JSON equivalent. Using:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;cds compile &lt;span class=&quot;token parameter variable&quot;&gt;--to&lt;/span&gt; yaml db/keywords-and-identifiers.cds&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we get:&lt;/p&gt;
&lt;pre class=&quot;language-yaml&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;definitions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;cuid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;primary&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cuid&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;Authors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; entity
    &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;primary&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;meta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;creator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CDS Compiler v6.4.6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;flavor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inferred&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;imperative-vs-declarative&quot;&gt;Imperative vs declarative&lt;/h2&gt;
&lt;p&gt;CDS modelling is predominantly achieved in a declarative fashion, with one of the Domain Specific Languages (DSLs) &lt;a href=&quot;https://cap.cloud.sap/docs/cds/&quot;&gt;available to us&lt;/a&gt;: CDL. But within CDL there are a small number of keywords that are, philosophically, more imperative than declarative - &lt;code&gt;extend&lt;/code&gt; being one of them (&lt;code&gt;annotate&lt;/code&gt;&lt;a href=&quot;https://qmacro.org/blog/posts/2025/11/12/some-ramblings-on-simple-cds-modelling-with-cdl/#footnotes&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; and &lt;code&gt;define&lt;/code&gt; are imperative too).&lt;/p&gt;
&lt;p&gt;Adding the &lt;code&gt;ID&lt;/code&gt; key field to the &lt;code&gt;Authors&lt;/code&gt; entity via these aspects has been done declaratively, using the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#includes&quot;&gt;shortcut syntax&lt;/a&gt; we examined earlier, i.e. with the &lt;code&gt;:&lt;/code&gt; symbol:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary : cuid {}
&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors : primary { ... }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But in fact we can achieve the same outcome using this more imperative form of extension syntax, with the &lt;code&gt;extend&lt;/code&gt; keyword:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary {}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors {
  name : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}

&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary with cuid;
&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors with primary;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This results in the same logical &lt;code&gt;Authors&lt;/code&gt; entity; I say &amp;quot;logical&amp;quot; as the compiler produces the definition with the elements in the order directly reflected in the top-to-bottom flow of the CDL, in other words, &lt;code&gt;name&lt;/code&gt; followed by &lt;code&gt;ID&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-yaml&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;Authors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; entity
  &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;primary&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;aspects-and-types&quot;&gt;Aspects and types&lt;/h2&gt;
&lt;p&gt;So far in this simple model there are aspects and an entity. The aspects we&#39;ve seen here are &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#named-aspects&quot;&gt;named&lt;/a&gt;, which allows us to think of them as first class citizens in our model, define them ahead of time, and use them to extend multiple targets. This section is in that context of &amp;quot;named aspects&amp;quot;, rather than anonymous ones, which is perhaps a topic for another time.&lt;/p&gt;
&lt;p&gt;Both aspects and entities represent structures (of elements), but entities differ from aspects in that they are normally manifested at the persistence layer, whereas aspects are not.&lt;/p&gt;
&lt;p&gt;There is another construct available to us in CDL, and that is the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#type-definitions&quot;&gt;type definition&lt;/a&gt;. While aspects are possibly less familiar to developers who have not been enlightened by &lt;a href=&quot;https://en.wikipedia.org/wiki/Aspect-oriented_programming&quot;&gt;Aspect-oriented programming&lt;/a&gt;, types are what you expect them to be: custom, sometimes composite, definitions of element/type pairs.&lt;/p&gt;
&lt;p&gt;The example in Capire&#39;s &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#type-definitions&quot;&gt;Type Definitions&lt;/a&gt; section has some nice examples:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; User : &lt;span class=&quot;token type builtin&quot;&gt;String(111)&lt;/span&gt;;
&lt;span class=&quot;token keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; Amount {
  value : &lt;span class=&quot;token type builtin&quot;&gt;Decimal(10,3)&lt;/span&gt;;
  currency : Currency;
}
&lt;span class=&quot;token keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; Currency : &lt;span class=&quot;token association-composition keyword&quot;&gt;Association to Currencies&lt;/span&gt;;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Given that types can be structures, just like aspects, can they be used to extend? The answer is a qualified &amp;quot;yes&amp;quot;.&lt;/p&gt;
&lt;p&gt;Let&#39;s say we wanted to add some origin info to our authors. How about the use of a new &lt;code&gt;origin&lt;/code&gt; aspect:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; cuid {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;UUID
&lt;/span&gt;};

&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; origin {
  countryOfBirth : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}

&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary : cuid, origin {}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors : primary {
  name : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This conveys the new &lt;code&gt;countryOfBirth&lt;/code&gt; element to the &lt;code&gt;Authors&lt;/code&gt; entity, via the two-level mixin, as expected:&lt;/p&gt;
&lt;pre class=&quot;language-yaml&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;definitions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;cuid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;countryOfBirth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;primary&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect
    &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cuid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; origin&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;countryOfBirth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;Authors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; entity
    &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;primary&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;countryOfBirth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;meta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;creator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CDS Compiler v6.4.6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;flavor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inferred&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What if we were to re-specify &lt;code&gt;origin&lt;/code&gt; as a type?&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; cuid {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; ID : &lt;span class=&quot;token type builtin&quot;&gt;UUID
&lt;/span&gt;};

&lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; origin {
  countryOfBirth : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}

&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; primary : cuid, origin {}

&lt;span class=&quot;token keyword&quot;&gt;entity&lt;/span&gt; Authors : primary {
  name : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;While the intermediate definitions do reflect the &lt;code&gt;origin&lt;/code&gt;&#39;s &amp;quot;kind&amp;quot;, the end result in the entity is the same:&lt;/p&gt;
&lt;pre class=&quot;language-yaml&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;definitions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;cuid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;origin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;countryOfBirth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;primary&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aspect
    &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;cuid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; origin&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;countryOfBirth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;Authors&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; entity
    &lt;span class=&quot;token key atrule&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;primary&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;elements&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.UUID&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;countryOfBirth&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cds.String&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;meta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token key atrule&quot;&gt;creator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CDS Compiler v6.4.6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;flavor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inferred&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;$version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This surprised me at first, but after all, CDL is an eminently flexible language with beauty in its simplicity and flexibility.&lt;/p&gt;
&lt;h2 id=&quot;no-keys-in-types&quot;&gt;No keys in types&lt;/h2&gt;
&lt;p&gt;One interesting difference between types and aspects in this regard is the conveyance of key elements. If we were to decide (for the sake of illustration) that &lt;code&gt;countryOfBirth&lt;/code&gt; were to be a key element, in the aspect variation:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;aspect&lt;/span&gt; origin {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; countryOfBirth : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;that would be fine and all would be well.&lt;/p&gt;
&lt;p&gt;If we tried this in the type variation:&lt;/p&gt;
&lt;pre class=&quot;language-cds&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-cds&quot;&gt;&lt;span class=&quot;token cqlkeywords keyword&quot;&gt;type&lt;/span&gt; origin {
  &lt;span class=&quot;token cqlkeywords keyword&quot;&gt;key&lt;/span&gt; countryOfBirth : &lt;span class=&quot;token type builtin&quot;&gt;String&lt;/span&gt;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;then we&#39;d get a compiler warning&lt;a href=&quot;https://qmacro.org/blog/posts/2025/11/12/some-ramblings-on-simple-cds-modelling-with-cdl/#footnotes&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-log&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token level warning important&quot;&gt;WARNING&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; db&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;keywords&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;and&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;identifiers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cds&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
  ‘key’ is only supported for elements in an entity or an aspect
  &lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;in type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;“humanID”&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;element&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;“employeeNr”&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This warning message ID is &lt;code&gt;def-unsupported-key&lt;/code&gt;; you may wish to peruse the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/compiler/messages&quot;&gt;Compiler Messages&lt;/a&gt; topic of Capire for more fascinating insights (this particular warning is not yet listed).&lt;/p&gt;
&lt;p&gt;This is only a warning, and the compiler will still (currently) honour the key element in the entity, but it doesn&#39;t feel right to use a type like this, hence the &amp;quot;qualified yes&amp;quot;.&lt;/p&gt;
&lt;p&gt;Stopping to think about this a little, I am minded to reflect that the flexibility and simplicity of CDL is augmented by the intent conveyed by the semantics of the keywords themselves. I could imagine a version of CDL where both the &lt;code&gt;aspect&lt;/code&gt; and &lt;code&gt;type&lt;/code&gt; keywords were absent, replaced with a single &lt;code&gt;struct&lt;/code&gt; keyword&lt;a href=&quot;https://qmacro.org/blog/posts/2025/11/12/some-ramblings-on-simple-cds-modelling-with-cdl/#footnotes&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;.
But that would, for me at least, make the language less approachable, less rich in expressiveness and the ability to show intent.&lt;/p&gt;
&lt;p&gt;And while one ultimate target of CDL is the machine readable equivalent (CSN), another ultimate target ... is us humans, in our endeavour to model business domains together.&lt;/p&gt;
&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;It may interest you to know that &lt;code&gt;annotate&lt;/code&gt; &lt;a href=&quot;https://cap.cloud.sap/docs/cds/cdl#the-annotate-directive&quot;&gt;is a shortcut for&lt;/a&gt; &lt;code&gt;extend&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;I also get a warning in my editor thanks to CAP&#39;s language server for CDS.&lt;/li&gt;
&lt;li&gt;On that note, it may interest you to read the &lt;a href=&quot;https://cap.cloud.sap/docs/cds/csn#structured-types&quot;&gt;Structured Types&lt;/a&gt; section of Capire&#39;s CSN topic, where it says that &amp;quot;&lt;em&gt;structured types are signified by the presence of an &lt;code&gt;elements&lt;/code&gt; property&lt;/em&gt;&amp;quot;. Did you notice that each definition in the final YAML representation of the compiled model -- whether entity, aspect or type -- has an &lt;code&gt;elements&lt;/code&gt; property?&lt;/li&gt;
&lt;/ol&gt;
</content>
  </entry>
  <entry>
    <title>Hands-on domain modelling with CAP&#39;s CDS at UKISUG Connect</title>
    <link href="https://qmacro.org/blog/posts/2025/11/11/hands-on-domain-modelling-with-caps-cds-at-ukisug-connect/" />
    <updated>2025-11-11T00:00:00Z</updated>
    <id>https://qmacro.org/blog/posts/2025/11/11/hands-on-domain-modelling-with-caps-cds-at-ukisug-connect/</id>
    <content type="html">&lt;p&gt;As I mentioned in my &lt;a href=&quot;https://qmacro.org/blog/posts/2025/09/10/upcoming-talks-in-autumn-2025/&quot;&gt;Upcoming talks in autumn 2025&lt;/a&gt; post recently, I&#39;ll be attending and speaking at &lt;a href=&quot;https://www.ukisugconnect.co.uk/&quot;&gt;UKISUG Connect&lt;/a&gt;. I have a couple of sessions, a hands-on workshop on the &lt;a href=&quot;https://virtual.oxfordabstracts.com/event/75555/program?date=%222025-11-30%22&quot;&gt;Sunday&lt;/a&gt; and a technical track talk on the &lt;a href=&quot;https://virtual.oxfordabstracts.com/event/75555/program?date=%222025-12-1%22&quot;&gt;Monday&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this post I want to describe the hands-on workshop, what to expect, and (if you intend to participate in the actual hands-on part) what you need.&lt;/p&gt;
&lt;p&gt;First, from the &lt;a href=&quot;https://virtual.oxfordabstracts.com/event/75555/submission/101&quot;&gt;session page&lt;/a&gt;, here&#39;s the synopsis:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Become acquainted with CAP&#39;s CDS, the common language that binds domain experts, with their key business &amp;amp; process knowledge, to developers. A hands-on-optional session where we&#39;ll explore the language &amp;amp; concepts together and get comfortable with it.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There are also the full session details:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;What happened to systems analysts, module specialists?&lt;/p&gt;
&lt;p&gt;Nothing - they&#39;re still here, and called &amp;quot;domain experts&amp;quot;. What&#39;s more, there&#39;s a common language that binds them, with their key business &amp;amp; process knowledge, to developers, with their knowledge of best practices &amp;amp; developer tools.&lt;/p&gt;
&lt;p&gt;That common language is CDS - a succinct, powerful and flexible way to describe the domain model and associated functionality for a given solution.&lt;/p&gt;
&lt;p&gt;We&#39;ll learn by doing, collaboratively exploring how to model entities, relationships, functions and more to build the domain model definition to be at the heart of the solution.&lt;/p&gt;
&lt;p&gt;Bring and work on your own laptop (setup instructions provided) or just take part in the Q&amp;amp;A style conversation led by the instructor.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;That last sentence is important, and worth explaining. I would like to make the session as welcoming and open as possible, even to those with no prior experience of CAP or CDS, and to non-developers.&lt;/p&gt;
&lt;p&gt;Additionally, I know that some folks simply may not have their laptops with them, or not want to set things up to participate in the exercises. That is absolutely fine.&lt;/p&gt;
&lt;p&gt;You can participate:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;either on your laptop, working through the exercises with me and the rest of your fellow hands-on enthusiasts&lt;/li&gt;
&lt;li&gt;or listen &amp;amp; watch, and take part in the conversation we&#39;ll have throughout the 2 hours, as I work through the exercises myself too, on the big screen, for all to see&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first option will require you to set up (or already have) a trial account on the SAP Business Technology Platform (BTP) - more on that in the &lt;a href=&quot;https://qmacro.org/blog/posts/2025/11/11/hands-on-domain-modelling-with-caps-cds-at-ukisug-connect/#preparation-for-doing-the-exercises&quot;&gt;Preparation for doing the exercises&lt;/a&gt; section below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://qmacro.org/images/2025/11/hands-on-session-2024.jpg&quot; alt=&quot;A photo of a hands-on workshop I ran last year at the event&quot;&gt;&lt;/p&gt;
&lt;p&gt;The second option is just as valid and the more questions and back and forth we generate between us the better for all! And there&#39;s no preparation required, except perhaps to pack your curiosity and bring it with you.&lt;/p&gt;
&lt;h2 id=&quot;preparation-for-doing-the-exercises&quot;&gt;Preparation for doing the exercises&lt;/h2&gt;
&lt;p&gt;If you do want to take the first option, and work through the exercises on your laptop as I lead the session working through them myself, then arguably the easiest option for you is to use the SAP Business Application Studio, the online IDE available for free in an BTP trial account.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;To get a trial account, follow the tutorial &lt;a href=&quot;https://developers.sap.com/tutorials/hcp-create-trial-account.html&quot;&gt;Get an Account on SAP BTP Trial&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Once you&#39;ve done that, follow the tutorial &lt;a href=&quot;https://developers.sap.com/tutorials/appstudio-onboarding.html&quot;&gt;Set Up SAP Business Application Studio for Development&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then you&#39;re all set.&lt;/p&gt;
&lt;p&gt;Either way, I encourage you to pop down to the hands-on workshop rooms on Sunday afternoon and join me!&lt;/p&gt;
</content>
  </entry>
</feed>