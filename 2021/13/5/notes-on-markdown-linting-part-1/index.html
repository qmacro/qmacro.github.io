<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes on Markdown linting - part 1</title>
    <meta name="description" content="Reserving the right to be wrong.">
    <link rel="stylesheet" href="/blog/css/index.css">
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
    <link rel="alternate" href="/blog/feed/feed.json" type="application/json" title="DJ Adams">
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/blog/">DJ Adams</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/blog/">Home</a></li>
        <li class="nav-item"><a href="/blog/about/">About</a></li>
        <li class="nav-item"><a href="/blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/blog/tags/">Tags</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Notes on Markdown linting - part 1</h1>

<time datetime="2021-05-13">13 May 2021</time><a href="/blog/tags/markdown/" class="post-tag">markdown</a><a href="/blog/tags/linting/" class="post-tag">linting</a>

<p><em>Here's what I found out when I started to look into linting Markdown content.</em></p>
<p>Thanks to some great direction and enlightenment from my colleague <a href="https://github.com/shegox">Tobias</a>, I found myself getting my brain around Markdown linting. Of course, not what it is, but what the current possibilities are and how they might apply to my situation. I thought I'd write some notes on what I found (mostly for my future self).</p>
<p>(See also <a href="https://qmacro.org/2021/05/14/notes-on-markdown-linting-part-2/">Notes on Markdown linting - part 2</a> where I learn how to get Markdown linting working in GitHub Actions).</p>
<h2 id="which-linter" tabindex="-1">Which linter? <a class="direct-link" href="#which-linter" aria-hidden="true">#</a></h2>
<p>The Node.js-based <a href="https://github.com/DavidAnson/markdownlint">DavidAnson/markdownlint</a> is the linter of choice. I'll refer to it as <code>markdownlint</code> in this post.</p>
<p>There's a related project <a href="https://github.com/markdownlint/markdownlint">markdownlint/markdownlint</a> which seems to be another, very similar linter written in Ruby. I'll refer to this as <code>mdl</code> as that's what the executable is called.</p>
<p>They both seem to share the same <a href="https://github.com/DavidAnson/markdownlint/blob/main/doc/Rules.md">rule</a> <a href="https://github.com/markdownlint/markdownlint/blob/master/docs/RULES.md">definitions</a> which is good; although <code>mdl</code> seems to have rules that have been deprecated in <code>markdownlint</code>.</p>
<p>I went for <code>markdownlint</code> for a number of reasons:</p>
<ul>
<li>it had more watchers, stargazers and forks on GitHub</li>
<li>I could install it on my macOS daily driver with <code>brew</code> (see later)</li>
<li>installing <code>mdl</code> involved RubyGems which I've never got on with</li>
<li>there was explicit information about using <code>markdownlint</code> in various editors (including in Vim)</li>
<li>Tobias had wanted to use a specific custom linting rule, something that <code>markdownlint</code> supports</li>
</ul>
<h2 id="installing-markdownlint" tabindex="-1">Installing markdownlint <a class="direct-link" href="#installing-markdownlint" aria-hidden="true">#</a></h2>
<p>Markdownlint can be installed via <code>npm install</code> or via <code>brew</code>. The <code>brew</code> option is actually via a connected project <a href="https://github.com/igorshubovych/markdownlint-cli">igorshubovych/markdownlint-cli</a>. I ran the <code>brew install markdownlint-cli</code> command and was up and running pretty much immediately:</p>
<pre class="language-shell"><code class="language-shell"><span class="token comment"># ~/Projects/gh/github.com/qmacro/qmacro.github.io (markdownlint-post *=)</span><br><span class="token punctuation">;</span> markdownlint<br>Usage: markdownlint <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>files<span class="token operator">|</span>directories<span class="token operator">|</span>globs<span class="token operator">></span><br><br>MarkdownLint Command Line Interface<br><br>Options:<br> -V, --version                               output the version number<br> -c, --config <span class="token punctuation">[</span>configFile<span class="token punctuation">]</span>                   configuration <span class="token function">file</span> <span class="token punctuation">(</span>JSON, JSONC, JS, or YAML<span class="token punctuation">)</span><br> -d, --dot                                   include files/folders with a dot <span class="token punctuation">(</span>for example <span class="token variable"><span class="token variable">`</span>.github<span class="token variable">`</span></span><span class="token punctuation">)</span><br> -f, --fix                                   fix basic errors <span class="token punctuation">(</span>does not work with STDIN<span class="token punctuation">)</span><br> -i, --ignore <span class="token punctuation">[</span>file<span class="token operator">|</span>directory<span class="token operator">|</span>glob<span class="token punctuation">]</span>          file<span class="token punctuation">(</span>s<span class="token punctuation">)</span> to ignore/exclude <span class="token punctuation">(</span>default: <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br> -o, --output <span class="token punctuation">[</span>outputFile<span class="token punctuation">]</span>                   <span class="token function">write</span> issues to <span class="token function">file</span> <span class="token punctuation">(</span>no console<span class="token punctuation">)</span><br> -p, --ignore-path <span class="token punctuation">[</span>file<span class="token punctuation">]</span>                    path to <span class="token function">file</span> with ignore pattern<span class="token punctuation">(</span>s<span class="token punctuation">)</span><br> -r, --rules  <span class="token punctuation">[</span>file<span class="token operator">|</span>directory<span class="token operator">|</span>glob<span class="token operator">|</span>package<span class="token punctuation">]</span>  custom rule files <span class="token punctuation">(</span>default: <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br> -s, --stdin                                 <span class="token builtin class-name">read</span> from STDIN <span class="token punctuation">(</span>does not work with files<span class="token punctuation">)</span><br> -h, --help                                  display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span><br></code></pre>
<p>From the options we can see that it works in the way we'd expect - point it at one or more files, optionally give it some configuration, and go.</p>
<p>But we can also see that it allows the use of custom rules. The custom rule that Tobias wanted to use was one that checks for title case (and I still went ahead, despite the fact that I dislike title case intensely :-)). The custom rules can be supplied in different forms as we can see from what can be specified with the <code>--rules</code> option; this particular one was of the exotic variety, i.e. an NPM package: <a href="https://www.npmjs.com/package/markdownlint-rule-titlecase">markdownlint-rule-titlecase</a>. In fact, there's a grouping of NPM packages that are custom rules for <code>markdownlint</code>, organised via the <a href="https://www.npmjs.com/search?q=keywords:markdownlint-rule">markdownlint-rule keyword</a>.</p>
<h2 id="using-markdownlint-with-vim" tabindex="-1">Using markdownlint with Vim <a class="direct-link" href="#using-markdownlint-with-vim" aria-hidden="true">#</a></h2>
<p>As I mentioned earlier, there is a <a href="https://github.com/DavidAnson/markdownlint#related">list of references</a> to mechanisms where you can use <code>markdownlint</code> from the comfort of your editor. This list pointed to <a href="https://github.com/fannheyward/coc-markdownlint">fannheyward/coc-markdownlint</a> for Vim.</p>
<p>I don't use <a href="https://github.com/neoclide/coc.nvim">Conqueror of Completion (coc)</a> - but I do use the <a href="https://github.com/dense-analysis/ale">Asynchronous Linting Engine (ALE)</a>, which has <a href="https://github.com/dense-analysis/ale/blob/master/ale_linters/markdown/markdownlint.vim">built-in support</a> for <code>markdownlint</code>. Within 5 minutes and a <a href="https://github.com/qmacro/dotfiles/commit/1281d8f908d51e43d280619668ac1d32bc3811a9">few tweaks to my ALE related Vim configuration</a> I was up and running. I have to tweak the rule configuration to my liking, as right now, even as I write this post, I'm being given grief by <code>markdownlint</code> about <a href="https://github.com/DavidAnson/markdownlint/blob/main/doc/Rules.md#md013">overly long lines</a>.</p>
<p><img src="/blog/img/2021/05/long-lines-warnings.png" alt="long lines warnings"></p>
<h2 id="configuring-markdownlint" tabindex="-1">Configuring markdownlint <a class="direct-link" href="#configuring-markdownlint" aria-hidden="true">#</a></h2>
<p>Configuration for <code>markdownlint</code> can be supplied with the <code>--config</code> option, or by configuration files in the right place - either in the current directory or in one's home directory.</p>
<p>I added the following to <code>~/.markdownlintrc</code>, and the grief about line length went away:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"line-length"</span><span class="token operator">:</span> <span class="token boolean">false</span><br><span class="token punctuation">}</span></code></pre>
<h2 id="trying-a-custom-rule" tabindex="-1">Trying a custom rule <a class="direct-link" href="#trying-a-custom-rule" aria-hidden="true">#</a></h2>
<p>I then wanted to see if I could get the custom linting rule working, at least in a basic way. On the <a href="https://www.npmjs.com/package/markdownlint-rule-titlecase">NPM page for markdownlint-rule-titlecase</a> it says:</p>
<p><em>Once installed using npm install markdownlint-rule-titlecase, run markdownlint with --rules &quot;markdownlint-rule-titlecase&quot;.</em></p>
<p>Sounds fair, although a little worrying for me as I'm not going to be working with Markdown content in the context of a Node.js project any time soon. However, it turns out that I can still install the package and use it, even in a non-Node.js project directory:</p>
<pre class="language-shell"><code class="language-shell"><span class="token comment"># ~/Projects/gh/github.com/qmacro/qmacro.github.io (markdownlint-post *=)</span><br><span class="token punctuation">;</span> <span class="token function">npm</span> i --no-package-lock markdownlint-rule-titlecase<br><span class="token function">npm</span> WARN saveError ENOENT: no such <span class="token function">file</span> or directory, <span class="token function">open</span> <span class="token string">'/Users/dj/Projects/gh/github.com/qmacro/qmacro.github.io/package.json'</span><br><span class="token function">npm</span> WARN enoent ENOENT: no such <span class="token function">file</span> or directory, <span class="token function">open</span> <span class="token string">'/Users/dj/Projects/gh/github.com/qmacro/qmacro.github.io/package.json'</span><br><span class="token function">npm</span> WARN qmacro.github.io No description<br><span class="token function">npm</span> WARN qmacro.github.io No repository field.<br><span class="token function">npm</span> WARN qmacro.github.io No README data<br><span class="token function">npm</span> WARN qmacro.github.io No license field.<br><br>+ markdownlint-rule-titlecase@0.1.0<br>added <span class="token number">4</span> packages from <span class="token number">4</span> contributors and audited <span class="token number">4</span> packages <span class="token keyword">in</span> <span class="token number">0</span>.838s<br>found <span class="token number">0</span> vulnerabilities</code></pre>
<p>The warnings are fair - there isn't a <code>package.json</code> file of course, why would there be?</p>
<p>I do now have a smallish <code>node_modules/</code> directory, though - containing the custom rule package:</p>
<pre><code># ~/Projects/gh/github.com/qmacro/qmacro.github.io (markdownlint-post *%=)
; tree -d node_modules/
node_modules/
├── markdownlint-rule-helpers
├── markdownlint-rule-titlecase
├── title-case
│   ├── dist
│   └── dist.es2015
└── tslib
    └── modules

7 directories
</code></pre>
<p>Oh well, I guess I could delete it when I'm done. In the meantime, can I take this new custom rule for a spin?</p>
<pre><code># ~/Projects/gh/github.com/qmacro/qmacro.github.io (markdownlint-post *%=)
; markdownlint --rules markdownlint-rule-titlecase _posts/2021-05-13-notes-on-markdown-linting.markdown
_posts/2021-05-13-notes-on-markdown-linting.markdown:11:1 titlecase-rule Titlecase rule [Title Case: 'Expected ## Which Linter?, found ## Which linter?']
_posts/2021-05-13-notes-on-markdown-linting.markdown:27:1 titlecase-rule Titlecase rule [Title Case: 'Expected ## Installing Markdownlint, found ## Installing markdownlint']
_posts/2021-05-13-notes-on-markdown-linting.markdown:55:1 titlecase-rule Titlecase rule [Title Case: 'Expected ## Using Markdownlint with Vim, found ## Using markdownlint with Vim']
_posts/2021-05-13-notes-on-markdown-linting.markdown:63:1 titlecase-rule Titlecase rule [Title Case: 'Expected ## Configuring Markdownlint, found ## Configuring markdownlint']
_posts/2021-05-13-notes-on-markdown-linting.markdown:75:1 titlecase-rule Titlecase rule [Title Case: 'Expected ## Trying a Custom Rule, found ## Trying a custom rule']
</code></pre>
<p>Yes! Works nicely. Although like I say, I'm not sure why anyone would <em>want</em> to use such a rule ... I may write one that complains if you <em>do</em> use title case. But I digress.</p>
<p>I think I'd like to be able to run these custom rules in Vim too, but I'll leave that for another time. I'm satisfied at least at this stage to be able to lint my Markdown files at all. And the next thing is actually to be able to use <code>markdownlint</code> in a GitHub Actions workflow.</p>
<p>Update: <a href="https://qmacro.org/2021/05/14/notes-on-markdown-linting-part-2/">I've written that up in part 2</a>.</p>

<hr>
<ul><li>Next: <a href="/blog/2021/14/5/notes-on-markdown-linting-part-2/">Notes on Markdown linting - part 2</a></li><li>Previous: <a href="/blog/2021/10/5/solving-mysterious-unrendered-markdown-headings/">Solving mysterious unrendered markdown headings</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /blog/2021/13/5/notes-on-markdown-linting-part-1/ -->
  </body>
</html>
