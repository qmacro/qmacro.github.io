<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webhooks postbin example for Coffeeshop</title>
    <meta name="description" content="Reserving the right to be wrong.">
    <link rel="stylesheet" href="/blog/css/index.css">
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
    <link rel="alternate" href="/blog/feed/feed.json" type="application/json" title="DJ Adams">
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/blog/">DJ Adams</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/blog/">Home</a></li>
        <li class="nav-item"><a href="/blog/about/">About</a></li>
        <li class="nav-item"><a href="/blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/blog/tags/">Tags</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Webhooks postbin example for Coffeeshop</h1>

<time datetime="2009-08-05">05 Aug 2009</time><a href="/blog/tags/coffeeshop/" class="post-tag">coffeeshop</a><a href="/blog/tags/http/" class="post-tag">http</a><a href="/blog/tags/postbin/" class="post-tag">postbin</a><a href="/blog/tags/pubsub/" class="post-tag">pubsub</a><a href="/blog/tags/rest/" class="post-tag">rest</a><a href="/blog/tags/watercoolr/" class="post-tag">watercoolr</a><a href="/blog/tags/webhooks/" class="post-tag">webhooks</a>

<p>There’s an interesting article “<a href="http://www.igvita.com/2009/06/29/http-pubsub-webhooks-pubsubhubbub/">HTTP PubSub: Webhooks and PubSubHubBub</a>” that covers working with webhooks and points to a great HTTP / webhook developer utility “<a href="http://www.postbin.org">PostBin</a>“, which:</p>
<blockquote>
<p>“lets you debug web lets you debug web hooks by capturing and logging the asynchronous requests made when events happen. Make a PostBin and register the URL with a web hook provider. All POST requests to the URL are logged for you to see when you browse to that URL.”</p>
</blockquote>
<p>The article also shows a very simple pubsub “Hello, World” script, <em>postbin.rb</em>, that nicely demonstrates the basic features of <a href="http://watercoolr.nuklei.com/">Watercoolr</a> — another HTTP-based pubsub mechanism.</p>
<p>So I thought I’d write the equivalent to <em>postbin.rb</em>, this time demonstrating the same features in <a href="http://wiki.github.com/qmacro/coffeeshop">Coffeeshop</a>. This way, we can see how things compare. It’s in Python, but that’s neither here nor there.</p>
<p>import httplib, urllib, sys</p>
<p>hubconn = httplib.HTTPConnection('localhost:8888')</p>
<p>hubconn.request(&quot;POST&quot;, &quot;/channel/&quot;) channel = hubconn.getresponse().getheader('Location') print &quot;Created channel %s&quot; % channel</p>
<p>hubconn.request(&quot;POST&quot;, channel + &quot;subscriber/&quot;,  urllib.urlencode({'resource': sys.argv[1]})) subscriber = hubconn.getresponse().getheader('Location') print &quot;Added subscriber %s&quot; % subscriber</p>
<p>while True:   print &quot;Post message:&quot;   msg = sys.stdin.readline()   hubconn.request(&quot;POST&quot;, channel, msg)   message = hubconn.getresponse().getheader('Location')   print &quot;Message published: %s&quot; % message</p>
<p>I’ve added some print statements to show what’s going on, and to highlight the HTTP resources created and utilised.</p>
<p>Here’s a sample execution:</p>
<blockquote>
<p><strong>python <a href="http://postbin.py">postbin.py</a> <a href="http://www.postbin.org/1a5m8w0">http://www.postbin.org/1a5m8w0</a></strong> Created channel /channel/1/ Added subscriber /channel/1/subscriber/2/ Post message: <strong>Hello, Webhooks World!</strong> Message published: /channel/1/message/ahFxbWFjcm8tY[...]RgDDA Post message:</p>
</blockquote>
<p>This message <a href="http://www.postbin.org/1a5m8w0">appears in the PostBin bucket</a> as expected. Nice!</p>
<p>As well as showing how useful PostBin is, I hope this demonstrates how the basic features of <a href="http://wiki.github.com/qmacro/coffeeshop">Coffeeshop</a> work, and perhaps more importantly, shows you that the REST-orientated approach is straightforward and works well.</p>

<hr>
<ul><li>Next: <a href="/blog/2009/9/8/google-wave-xmpp-and-complexity/">Google Wave, XMPP and complexity</a></li><li>Previous: <a href="/blog/2009/28/7/first-coffeeshop-demo-screencast/">First coffeeshop demo screencast</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /blog/2009/5/8/webhooks-postbin-example-for-coffeeshop/ -->
  </body>
</html>
