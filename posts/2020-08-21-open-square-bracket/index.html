<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/posts/2020-08-21-open-square-bracket/"><link href="/assets/main.7bd42185b92fd44f892e.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>The open square bracket [ is an executable | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="The open square bracket [ is an executable"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/posts/2020-08-21-open-square-bracket/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@qmacro"><meta name="description" content="The open square bracket [ is an executable 21 Aug 2020 | 2 min read In a shell script, the [ symbol is not syntax, it&#39;s an executable In my..."><meta property="og:description" content="The open square bracket [ is an executable 21 Aug 2020 | 2 min read In a shell script, the [ symbol is not syntax, it&#39;s an executable In my..."><meta name="description" content="The open square bracket [ is an executable 21 Aug 2020 | 2 min read In a shell script, the [ symbol is not syntax, it&#39;s an executable In my..."><meta property="og:image" content="https://qmacro.org/images/DJA-head.png"><meta name="twitter:image" content="https://qmacro.org/images/DJA-head.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/talks">Talks</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>The open square bracket [ is an executable</h1><div class="post__details"><time datetime="2020-08-21">21 Aug 2020 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p><em>In a shell script, the <code>[</code> symbol is not syntax, it's an executable</em></p><p>In my <a href="https://www.youtube.com/watch?v=Ct-uiu3RRZs">live stream episode</a> this morning I added to a function so that it looked like this:</p><pre class="language-shell"><code class="language-shell"><span class="token function-name function">getservicekey</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token builtin class-name">local</span> <span class="token assign-left variable">instance</span><span class="token operator">=</span><span class="token variable">${1}</span><br>  <span class="token builtin class-name">local</span> <span class="token assign-left variable">servicekey</span><span class="token operator">=</span><span class="token variable">${2}</span><br>  <span class="token builtin class-name">local</span> <span class="token function">file</span><br>  <span class="token assign-left variable">file</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${instance}</span>-<span class="token variable">${servicekey}</span>.json"</span><br>  <span class="token keyword">if</span> <span class="token punctuation">[</span> -r <span class="token string">"<span class="token variable">${file}</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span><br>    <span class="token function">cat</span> <span class="token string">"<span class="token variable">${file}</span>"</span><br>  <span class="token keyword">else</span><br>    cf service-key <span class="token string">"<span class="token variable">${instance}</span>"</span> <span class="token string">"<span class="token variable">${servicekey}</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'1,2d'</span><br>  <span class="token keyword">fi</span><br><span class="token punctuation">}</span></code></pre><p>Looking at that condition <code>if [ -r &quot;${file}&quot; ]</code> one would think that the <code>[ ... ]</code> part is just some shell syntax to glue things together (to contain the expression under evaluation), part of the family of symbols including double quotes, semicolons and others.</p><p>But no. In a wonderfully quirky way, <code>[</code> is actually a command, an executable. I remember seeing an odd character in my <code>/bin/</code> directory a while back:</p><pre><code>▶ ls /bin
[               dash            expr            ln              pwd             sync
bash            date            hostname        ls              rm              tcsh
cat             dd              kill            mkdir           rmdir           test
chmod           df              ksh             mv              sh              unlink
cp              echo            launchctl       pax             sleep           wait4path
csh             ed              link            ps              stty            zsh
</code></pre><p>Check out that <code>[</code> entry!</p><p>Turns out that <code>[</code> is a synonym for <code>test</code>. You can ask for the manual page for <code>[</code> and you get something that covers <code>[</code> and <code>test</code>:</p><pre class="language-shell"><code class="language-shell">▶ <span class="token function">man</span> <span class="token punctuation">[</span><br><br>NAME<br>     test, <span class="token punctuation">[</span> -- condition evaluation utility<br><br>SYNOPSIS<br>     <span class="token builtin class-name">test</span> expression<br>     <span class="token punctuation">[</span> expression <span class="token punctuation">]</span><br><br>DESCRIPTION<br>     The <span class="token builtin class-name">test</span> utility evaluates the expression and, <span class="token keyword">if</span> it evaluates to true, returns a zero<br>     <span class="token punctuation">(</span>true<span class="token punctuation">)</span> <span class="token builtin class-name">exit</span> status<span class="token punctuation">;</span> otherwise it returns <span class="token number">1</span> <span class="token punctuation">(</span>false<span class="token punctuation">)</span>.  If there is no expression, <span class="token builtin class-name">test</span> also<br>     returns <span class="token number">1</span> <span class="token punctuation">(</span>false<span class="token punctuation">)</span>.<br><br>     <span class="token punctuation">..</span>.</code></pre><p>Indeed, if you compare the two files <code>/bin/[</code> and <code>/bin/test</code>, they're the same.</p><p>The <code>if</code> statement above can be rewritten with the <code>test</code> synonym like this: <code>if test -r &quot;${file}&quot;</code>, but now I know that <code>[</code> is an actual executable, I'll take great delight in using it more.</p><p>Post Script: As well as being an executable, <code>[</code> is also built in to many shells these days, so incurs no performance penalty on use that an external command would otherwise do.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/autodidactics/">#autodidactics</a> <a href="/tags/unix/">#unix</a></div><nav class="post__pagination"><a href="/posts/2020-08-25-hostaliases/"><span>←</span> <span>You can mask sensitive hostnames with wildcards and host aliases</span> </a><a href="/posts/2020-08-16-usr-dir/"><span>Why we have /bin/ and /usr/bin/</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a href="https://twitter.com/qmacro" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>