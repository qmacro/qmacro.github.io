<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/posts/2016-10-04-f3c-part-7-recursion/"><link href="/assets/main.7bd42185b92fd44f892e.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>F3C Part 7 - Recursion | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="F3C Part 7 - Recursion"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/posts/2016-10-04-f3c-part-7-recursion/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@qmacro"><meta name="description" content="F3C Part 7 - Recursion 04 Oct 2016 | 2 min read FunFunFunction Video: Recursion - Part 7 of Functional Programming in JavaScript (This post..."><meta property="og:description" content="F3C Part 7 - Recursion 04 Oct 2016 | 2 min read FunFunFunction Video: Recursion - Part 7 of Functional Programming in JavaScript (This post..."><meta name="description" content="F3C Part 7 - Recursion 04 Oct 2016 | 2 min read FunFunFunction Video: Recursion - Part 7 of Functional Programming in JavaScript (This post..."><meta property="og:image" content="https://qmacro.org/images/DJA-head.png"><meta name="twitter:image" content="https://qmacro.org/images/DJA-head.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/talks">Talks</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>F3C Part 7 - Recursion</h1><div class="post__details"><time datetime="2016-10-04">04 Oct 2016 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p>FunFunFunction Video: <a href="https://www.youtube.com/watch?v=k7-N8R0-KY4&amp;list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84&amp;index=7">Recursion - Part 7 of Functional Programming in JavaScript</a></p><p>(This post is part of the <a href="/f3c/">F3C</a> series)</p><p>&quot;Recursion is when a function calls itself, until it doesn't&quot; -- MPJ</p><p>While superficially flippant, this definition is rather accurate and succinct. It's what I'm going to adopt when explaining it at a high level to someone new.</p><p>I think there are two levels to understanding recursion. The first is at the theory level. There has to be a way for the repeat calling to end, either a base case, as was shown in the countdown example, or a situation where the function runs out of data to process, as was shown in the animals hierarchy example.</p><p>The second is at the practice level. I've sometimes found it cognitively difficult to &quot;see&quot; the recursive pattern and how it might apply in a solution. It helps to visualise what's happening, and so that's what we'll do here with the animals hierarchy example.</p><p>The following is the same code that was shown in the video, but with some extra counting and logging:</p><pre class="language-javascript"><code class="language-javascript"><br><span class="token keyword">let</span> calls <span class="token operator">=</span> <span class="token number">0</span><br><span class="token keyword">let</span> <span class="token function-variable function">makeTree</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categories<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> level</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br><br>  calls<span class="token operator">++</span><br>  level<span class="token operator">++</span><br><br>  <span class="token keyword">let</span> node <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>  <span class="token keyword">let</span> children <span class="token operator">=</span> categories<br>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=></span> c<span class="token punctuation">.</span>parent <span class="token operator">===</span> parent<span class="token punctuation">)</span><br><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>    level<span class="token punctuation">,</span><br>    parent<span class="token punctuation">,</span> <span class="token string">'->'</span><span class="token punctuation">,</span><br>    children<span class="token punctuation">.</span>length<br>    <span class="token operator">?</span> children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=></span> c<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><br>    <span class="token operator">:</span> <span class="token string">"none"</span><span class="token punctuation">)</span><br><br>  children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=></span> node<span class="token punctuation">[</span>c<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">makeTree</span><span class="token punctuation">(</span>categories<span class="token punctuation">,</span> c<span class="token punctuation">.</span>id<span class="token punctuation">,</span> level<span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>  <span class="token keyword">return</span> node<br><span class="token punctuation">}</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token function">makeTree</span><span class="token punctuation">(</span>categories<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>calls<span class="token punctuation">,</span> <span class="token string">'calls'</span><span class="token punctuation">)</span></code></pre><p>The variable <code>calls</code> is used simply to count how many times the <code>makeTree</code> function is called. There's now a 3rd parameter <code>level</code> in the <code>makeTree</code> function signature which we seed with the value '0'; it's incremented each time the function calls itself, so we can count how deep the rabbit hole goes.</p><p>This is what the output looks like:</p><pre><code>1 null '-&gt;' 'animals'
2 'animals' '-&gt;' 'mammals'
3 'mammals' '-&gt;' 'cats, dogs'
4 'cats' '-&gt;' 'persian, siamese'
5 'persian' '-&gt;' 'none'
5 'siamese' '-&gt;' 'none'
4 'dogs' '-&gt;' 'chihuahua, labrador'
5 'chihuahua' '-&gt;' 'none'
5 'labrador' '-&gt;' 'none'
{
  &quot;animals&quot;: {
    &quot;mammals&quot;: {
      &quot;cats&quot;: {
        &quot;persian&quot;: {},
        &quot;siamese&quot;: {}
      },
      &quot;dogs&quot;: {
        &quot;chihuahua&quot;: {},
        &quot;labrador&quot;: {}
      }
    }
  }
}
9 'calls'
</code></pre><p>The main structure is the same. And clearly there are 9 calls. That makes sense, because there are 9 candidate parents (including <code>null</code>, from the initial call).</p><p>We can also see how many levels the recursion descends (5), and how it ascends too, from the last feline parent candidate 'siamese' at level 5, back up to the 'dogs' parent candidate at level 4.</p><p>This is what it looks like visually:</p><pre><code>1                   null
                     |
2                  animals
                     |
3                  mammals
                     |
            +--------+--------+
            |                 |
4         cats               dogs
            |                 |
       +---------+       +---------+
       |         |       |         |
5   persian  siamese  chihuahua labrador
       |         |       |         |
     (none)    (none)  (none)    (none)
</code></pre><p>(The fact that there are no children belonging to any of the candidate parent nodes at level 5 is represented by <code>(none)</code>).</p><p>And there you have it. Practice thinking about recursion, and how it applies to problems like this.</p><p>Oh yes, and there's also something I wanted to say about tail call optimisation, but there isn't space here to do any justice to it. Perhaps a subject for a later post. In the meantime, remember the immortal and recursive suggestion from <a href="http://scarfolk.blogspot.co.uk/">Scarfolk Council</a>: &quot;For more information, please reread&quot;.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/language-ramblings/">#language-ramblings</a></div><nav class="post__pagination"><a href="/posts/2016-10-16-f3c-part-8-promises/"><span>←</span> <span>F3C Part 8 - Promises</span> </a><a href="/posts/2016-10-03-f3c-part-6-currying/"><span>F3C Part 6 - Currying</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a href="https://twitter.com/qmacro" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>