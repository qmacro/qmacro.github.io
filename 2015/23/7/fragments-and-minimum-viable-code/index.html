<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fragments and Minimum Viable Code</title>
    <meta name="description" content="Reserving the right to be wrong.">
    <link rel="stylesheet" href="/blog/css/index.css">
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
    <link rel="alternate" href="/blog/feed/feed.json" type="application/json" title="DJ Adams">
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/blog/">DJ Adams</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/blog/">Home</a></li>
        <li class="nav-item"><a href="/blog/about/">About</a></li>
        <li class="nav-item"><a href="/blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/blog/tags/">Tags</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Fragments and Minimum Viable Code</h1>

<time datetime="2015-07-23">23 Jul 2015</time><a href="/blog/tags/fragment/" class="post-tag">fragment</a><a href="/blog/tags/mvc/" class="post-tag">mvc</a><a href="/blog/tags/openui5/" class="post-tag">openui5</a><a href="/blog/tags/xmlfragments/" class="post-tag">xmlfragments</a>

<p><strong><a href="/2015/07/04/30-days-of-ui5/">30 Days of UI5</a> — Day 20 by <a href="//qmacro.org/about/">DJ Adams</a></strong></p>
<p>In an earlier post in this series, <a href="/2015/07/21/mvc-model-view-controller-minimum-viable-code/">MVC – Model View Controller, Minimum Viable Code</a>, I showed how you could write a single-file UI5 app but still embrace and use the concepts of Model View Controller, having separate controller definitions and declarative XML Views. I also mentioned you could use XML Fragments in this way too, and <a href="https://twitter.com/Qualiture/status/623467858652200960">Robin van het Hof asked</a> if I could explain how. So here we go, thanks Robin!</p>
<p>If we take the code from the previous post and run it, we end up with a UI that looks like this:</p>
<p><img src="/blog/img/2018/02/Screen-Shot-2015-07-21-at-17.33.38-624x420.png" alt=""></p>
<p>Let’s add some behaviour to the Button so that it instantiates and opens a Dialog control. We’ll define this Dialog control in an XML Fragment.</p>
<p>In the same way that we defined the XML View, we’ll define the XML Fragment inside a script element, this time with a “ui5/xmlfragment” type, like this:</p>
<p><img src="/blog/img/2018/02/Screen-Shot-2015-07-21-at-17.43.19-624x277.png" alt=""></p>
<p>It’s a standard XML Fragment definition, and even though it only contains a single root control –the Dialog — I’m using the Fragment Definition wrapper explicitly anyway (as I think it’s good practice).</p>
<p>When we press the Button, we want this Dialog to appear, like this:</p>
<p><img src="/blog/img/2018/02/Screen-Shot-2015-07-21-at-17.39.49-624x422.png" alt=""></p>
<p>So let’s rewrite the handler “onPress” which is attached to the Button’s press event, so it now looks like this:</p>
<p><img src="/blog/img/2018/02/Screen-Shot-2015-07-21-at-17.42.59-624x488.png" alt=""></p>
<p>This is a common pattern for fragments, so let’s examine the code line by line:</p>
<p><strong>48</strong>: We’re going to be storing a reference to the Dialog fragment’s instance in a controller variable “_oDialogFragment” so we declare it explicitly, mostly to give those reading our code a clue as to our intentions.</p>
<p><strong>51-56</strong>: Ensuring we only instantiate the Dialog once, we use the sap.ui.xmlfragment call, with the fragmentContent property, passing the content of the fragment script with jQuery’s help (remember, the name of the fragment script is “dialog”). Once instantiated we <a href="http://stackoverflow.com/a/24640317/384366">add it as a dependent</a> to the current XML View.</p>
<p><strong>57</strong>: At this stage we know we have a Dialog ready, so we just open it up.</p>
<p><strong>60-62</strong>: The onClose function handles the press event of the “Close” Button in the Dialog’s buttons aggregation.</p>
<p>And that’s pretty much it. Use script elements to embed XML Views and Fragments, and use sap.ui.xmlview and sap.ui.xmlfragment to instantiate them, with jQuery to grab the actual content.</p>

<hr>
<ul><li>Next: <a href="/blog/2015/24/7/spreading-the-ui5-message/">Spreading the UI5 Message</a></li><li>Previous: <a href="/blog/2015/22/7/a-short-ui5-debugging-journey/">A Short UI5 Debugging Journey</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /blog/2015/23/7/fragments-and-minimum-viable-code/ -->
  </body>
</html>
