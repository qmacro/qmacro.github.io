<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2025/05/15/point-free-coding-and-function-composition/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.7884d8f8e9dd86c3b137.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Point free coding and function composition | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Point free coding and function composition"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2025/05/15/point-free-coding-and-function-composition/"><meta name="description" content="Point free coding and function composition 15 May 2025 | 10 min read In this post I explore and show examples of the concepts of point free..."><meta property="og:description" content="Point free coding and function composition 15 May 2025 | 10 min read In this post I explore and show examples of the concepts of point free..."><meta name="description" content="Point free coding and function composition 15 May 2025 | 10 min read In this post I explore and show examples of the concepts of point free..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Point free coding and function composition</h1><div class="post__details"><time datetime="2025-05-15">15 May 2025 </time><span>| </span><span>10 min read</span></div></header><main class="post__content"><p><em>In this post I explore and show examples of the concepts of point free coding, of chains of functions through which data flows, and of function composition.</em></p><p>While preparing for tomorrow's <a href="https://www.youtube.com/watch?v=8eKWxP3F6xc&amp;list=PL6RpkC85SLQB-0sK7KSRwCc2gdtlZDIkL&amp;index=5">fifth and final episode</a> in our current Hands-on SAP Dev series <a href="https://www.youtube.com/playlist?list=PL6RpkC85SLQB-0sK7KSRwCc2gdtlZDIkL">Let's explore functional programming</a> I was thinking about how point free coding and composition can be found in many places, not just in functional libraries and languages.</p><p>We've been learning about functional programming concepts mainly with JavaScript, sometimes making use of features from the excellent <a href="https://ramdajs.com">Ramda</a> library. For data, we've mostly used <a href="https://github.com/qmacro/northbreeze">Northbreeze</a>, a sort of &quot;reduced&quot; <a href="https://services.odata.org/V4/Northwind/Northwind.svc/">Northwind</a>. There's an instance of the OData V4 service <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze">available</a> for the time being, and I'll use that to explore in this post too, in particular the <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products">Products</a> entityset.</p><h2>The basic concepts</h2><p>With point free coding, also known as <a href="https://en.wikipedia.org/wiki/Tacit_programming">tacit programming</a>, data and behaviour are separate, a fundamental philosophy of the functional programming style. Behaviour is defined in the form of functions, building blocks that are used on their own or composed together.</p><p>In writing those function declarations, the data that they will operate on is not specified. Instead, when the time is right, data is passed through to the function(s), often in a flowing approach through a series of them which are chained together.</p><blockquote><p>There are more formal definitions and interpretations of point free coding, but at this level of exploration we can be comfortable thinking of the concepts as described here.</p></blockquote><h2>Exploring in jq</h2><p>It's no secret that I'm a <a href="/tags/jq/">fan</a> of <a href="https://jqlang.org">jq</a>, a fully formed programming language that exhibits a predominantly functional paradigm, as well as being a powerful way to manipulate JSON with ad hoc expressions.</p><p>There are <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products/$count">77</a> products in Northbreeze. Let's have a look at the first one with:</p><pre class="language-shell"><code class="language-shell">jq <span class="token string">'.value|first'</span> products.json</code></pre><p><a name="chai"></a> which emits:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"ProductID"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  <span class="token property">"ProductName"</span><span class="token operator">:</span> <span class="token string">"Chai"</span><span class="token punctuation">,</span><br>  <span class="token property">"QuantityPerUnit"</span><span class="token operator">:</span> <span class="token string">"10 boxes x 20 bags"</span><span class="token punctuation">,</span><br>  <span class="token property">"UnitPrice"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span><br>  <span class="token property">"Category_CategoryID"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  <span class="token property">"Supplier_SupplierID"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  <span class="token property">"UnitsInStock"</span><span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span><br>  <span class="token property">"UnitsOnOrder"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>  <span class="token property">"ReorderLevel"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span><br>  <span class="token property">"Discontinued"</span><span class="token operator">:</span> <span class="token boolean">false</span><br><span class="token punctuation">}</span></code></pre><blockquote><p>In the <code>jq</code> filter here (and elsewhere in this post) <code>.value</code> is an artifact of the OData V4 JSON representation of the data, not anything inherently required by <code>jq</code>.</p></blockquote><h3>Discontinued products</h3><p>Defining a function that discards anything that's not discontinued, and using that to map over the products, like this:</p><pre class="language-jq"><code class="language-jq"><span class="token keyword">def</span> <span class="token function">justDiscontinued</span><span class="token punctuation">:</span> <span class="token c-style-function function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Discontinued<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">.</span>value<br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span>justDiscontinued<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> <span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ProductName</code></pre><p>gives us:</p><pre class="language-text"><code class="language-text">"Chef Anton's Gumbo Mix"<br>"Mishi Kobe Niku"<br>"Alice Mutton"<br>"Guaraná Fantástica"<br>"Rössle Sauerkraut"<br>"Thüringer Rostbratwurst"<br>"Singaporean Hokkien Fried Mee"<br>"Perth Pasties"</code></pre><p>Already we can start to see how the product data is nowhere to be seen in this <code>jq</code> filter. It's implicit, and sent through the chain (by means of the <a href="https://jqlang.org/manual/#pipe">pipe operator</a>) when the expression is evaluated.</p><p>Even the definition of <code>justDiscontinued</code> exhibits the idea of tacitness, in that there's no indication of what this function, or its body, is to work on.</p><h3>Stock information</h3><p>Rather than that deliberately simple iterator and property expression at the end (<code>.[].ProductName</code>), let's add a further filter to the chain:</p><pre class="language-jq"><code class="language-jq"><span class="token keyword">def</span> <span class="token function">justDiscontinued</span><span class="token punctuation">:</span> <span class="token c-style-function function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Discontinued<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">def</span> <span class="token function">stockInfo</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">.</span>ProductName<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>UnitsInStock<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">.</span>value<br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span>justDiscontinued<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span>stockInfo<span class="token punctuation">)</span></code></pre><p>This produces:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Chef Anton's Gumbo Mix"</span><span class="token operator">:</span> <span class="token number">0</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Mishi Kobe Niku"</span><span class="token operator">:</span> <span class="token number">29</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Alice Mutton"</span><span class="token operator">:</span> <span class="token number">0</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Guaraná Fantástica"</span><span class="token operator">:</span> <span class="token number">20</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Rössle Sauerkraut"</span><span class="token operator">:</span> <span class="token number">26</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Thüringer Rostbratwurst"</span><span class="token operator">:</span> <span class="token number">0</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Singaporean Hokkien Fried Mee"</span><span class="token operator">:</span> <span class="token number">26</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    <span class="token property">"Perth Pasties"</span><span class="token operator">:</span> <span class="token number">0</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">]</span></code></pre><p>There are a couple of improvements we can make here. The first is to <a href="https://jqlang.org/manual/#add">add</a> the elements of the array together:</p><pre class="language-jq"><code class="language-jq"><span class="token keyword">def</span> <span class="token function">justDiscontinued</span><span class="token punctuation">:</span> <span class="token c-style-function function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Discontinued<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">def</span> <span class="token function">stockInfo</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">.</span>ProductName<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>UnitsInStock<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">.</span>value<br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span>justDiscontinued<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span>stockInfo<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> add</code></pre><p>which reshapes the output to look like this:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"Chef Anton's Gumbo Mix"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>  <span class="token property">"Mishi Kobe Niku"</span><span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span><br>  <span class="token property">"Alice Mutton"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>  <span class="token property">"Guaraná Fantástica"</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span><br>  <span class="token property">"Rössle Sauerkraut"</span><span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span><br>  <span class="token property">"Thüringer Rostbratwurst"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>  <span class="token property">"Singaporean Hokkien Fried Mee"</span><span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span><br>  <span class="token property">"Perth Pasties"</span><span class="token operator">:</span> <span class="token number">0</span><br><span class="token punctuation">}</span></code></pre><h3>An alternative way to chain mappings</h3><p>The second improvement is to think about how we have two chained <code>map</code> expressions; this is neat and pleasing on the eye, and helps us understand how data flows through, especially when it forces us to think about what <em>shape</em> that data is (an array of objects).</p><p>But we can just as easily (and more efficiently) write the chain like this:</p><pre class="language-jq"><code class="language-jq"><span class="token keyword">def</span> <span class="token function">justDiscontinued</span><span class="token punctuation">:</span> <span class="token c-style-function function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Discontinued<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">def</span> <span class="token function">stockInfo</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">.</span>ProductName<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>UnitsInStock<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">.</span>value<br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span>justDiscontinued<span class="token operator pipe">|</span>stockInfo<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> add</code></pre><p>which produces exactly the same result, and is possibly an even better visualisation of what tacit expressions look like.</p><h3>Average calculation</h3><p>In fact, talking of <code>add</code>, how about this succinct way of emitting the average unit price of all products:</p><pre class="language-jq"><code class="language-jq"><span class="token punctuation">.</span>value<br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token punctuation">.</span>UnitPrice<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> add <span class="token operator">/</span> length</code></pre><p>This produces the value <code>28.866363636363637</code>.</p><blockquote><p>Incidentally we can check and compare that to what Northbreeze tells us, using an OData V4 <a href="https://github.com/qmacro/odata-v4-and-cap/blob/main/slides.md#data-aggregation">data aggregation</a> feature that is supported out of the box with CAP (see the <a href="https://cap.cloud.sap/docs/advanced/odata#aggregation-methods">Aggregation Methods</a> section of the OData APIs topic in Capire); the resource at <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products?$apply=aggregate(UnitPrice%20with%20average%20as%20AvgPrice)">this URL</a>:</p><pre class="language-url"><code class="language-url"><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">developer-challenge.cfapps.eu10.hana.ondemand.com</span></span><br> /odata/v4/northbreeze/Products<br> <span class="token query"><span class="token query-delimiter">?</span></span><br> $apply=aggregate(UnitPrice with average as AvgPrice)</code></pre><p>is returned in a JSON representation, like this:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br> <span class="token property">"@odata.context"</span><span class="token operator">:</span> <span class="token string">"$metadata#Products(AvgPrice)"</span><span class="token punctuation">,</span><br> <span class="token property">"value"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>   <span class="token punctuation">{</span><br>     <span class="token property">"AvgPrice@odata.type"</span><span class="token operator">:</span> <span class="token string">"#Decimal"</span><span class="token punctuation">,</span><br>     <span class="token property">"AvgPrice"</span><span class="token operator">:</span> <span class="token number">28.8663636363636</span><span class="token punctuation">,</span><br>     <span class="token property">"@odata.id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><br>   <span class="token punctuation">}</span><br> <span class="token punctuation">]</span><br><span class="token punctuation">}</span></code></pre></blockquote><h3>Examining the data flow</h3><p>What's even more wonderful about this is how <code>jq</code> flows the data through the final pipe ... both into <code>add</code> <em>and also into <code>length</code></em>.</p><p>This is not just a thing of beauty, but also a great reason for us to stop and think for a moment what's happening here. I'll use just the first three products to visualise here, and temporarily remove the last part of the chain:</p><pre class="language-jq"><code class="language-jq"><span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token punctuation">.</span>UnitPrice<span class="token punctuation">)</span></code></pre><p>So <code>.value[0:3]</code> emits an array of the <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products?$top=3">first three products</a> with all their properties, which in turn is piped into <code>map(.UnitPrice)</code> which produces:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">[</span><br>  <span class="token number">18</span><span class="token punctuation">,</span><br>  <span class="token number">19</span><span class="token punctuation">,</span><br>  <span class="token number">10</span><br><span class="token punctuation">]</span></code></pre><p>Then with <code>| add / length</code> this array is then sent to both <code>add</code> and <code>length</code>, in parallel, and then the output of each is combined with the <code>/</code> divide operator:</p><pre class="language-text"><code class="language-text"><br>                 +-->  add   --> 47 --+<br>                 |                    |<br>[ 18, 19, 10 ] --+                    +--> / --> 15.6666666<br>                 |                    |<br>                 +--> length --> 3  --+</code></pre><h2>The shell</h2><p>Unix shells in general, and in particular <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">my favourite flavour</a>, exhibit similar point free and functional chain features.</p><p>Using the same data set, we can produce Unix shell friendly<a href="#footnote-1"><sup>1</sup></a> output like this:</p><pre class="language-shell"><code class="language-shell">jq <span class="token parameter variable">-r</span> <span class="token string">'.value[] | [.UnitPrice, .ProductName] | @tsv'</span> products.json</code></pre><p>This produces:</p><pre class="language-text"><code class="language-text">18     Chai<br>19     Chang<br>10     Aniseed Syrup<br>22     Chef Anton's Cajun Seasoning<br>21.35  Chef Anton's Gumbo Mix<br>25     Grandma's Boysenberry Spread<br>6      Konbu<br>23.25  Tofu<br>15.5   Genen Shouyu<br>...</code></pre><p>The shell's <a href="https://en.wikipedia.org/wiki/Standard_streams">standard streams</a> concept (STDIN / STDOUT etc), make it easy for us to use regular utilities in their natural environment, i.e. in a point free style, where no data is specified, but is implicit and supplied via STDIN.</p><p>How about working out the top three most expensive products?</p><pre class="language-shell"><code class="language-shell">jq <span class="token parameter variable">-r</span> <span class="token string">'.value[] | [.UnitPrice, .ProductName] | @tsv'</span> products.json <span class="token punctuation">\</span><br><span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-nr</span> <span class="token punctuation">\</span><br><span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-3</span></code></pre><p>Here we are:</p><pre class="language-text"><code class="language-text">263.5   Côte de Blaye<br>123.79  Thüringer Rostbratwurst<br>97      Mishi Kobe Niku</code></pre><p>Yup, <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products?$select=ProductName,UnitPrice&amp;$orderby=UnitPrice%20desc&amp;$top=3">that computes</a>.</p><p>We can even 'compose' these two 'functions' (<code>sort</code> and <code>head</code>) like this, again, with no data in sight:</p><pre class="language-shell"><code class="language-shell"><span class="token function-name function">topthree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">sort</span> <span class="token parameter variable">-nr</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-3</span> <span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre><p>and then use that higher level building block:</p><pre class="language-shell"><code class="language-shell">jq <span class="token parameter variable">-r</span> <span class="token string">'.value[] | [.UnitPrice, .ProductName] | @tsv'</span> products.json <span class="token punctuation">\</span><br><span class="token operator">|</span> topthree</code></pre><h2>To JavaScript and beyond</h2><p>Well, we've already started from &quot;beyond&quot; JavaScript, but I guess what I was trying to say with this section heading is that these concepts are to be found in many places. Not least JavaScript, as well as of course in languages more strongly focused on the functional programming paradigm.</p><p>Hopefully I've illustrated some general features of these two concepts to show how they allow, even encourage programming that favours:</p><ul><li>thinking about behaviours separately from data</li><li>building new functions from other functions</li><li>constructing generic blocks of code</li><li>coding at a high level</li></ul><blockquote><p>This last point has got me thinking that the combination of these concepts lends itself well to being an alternative to the current &quot;low code&quot; approaches. But that's perhaps a digression for another time.</p></blockquote><p>This type of approach to programming is facilitated by many of the features we've seen in the <a href="https://www.youtube.com/playlist?list=PL6RpkC85SLQB-0sK7KSRwCc2gdtlZDIkL">Let's explore functional programming</a> series, such as currying, partial application and higher order functions, key items in a programming toolset for using, combining and building new discrete and data-free functions.</p><p>Turning to a more mainstream programming language like JavaScript allows me to talk about an important aspect of functions in this context.</p><h3>Data last</h3><p>That important aspect is the order of arguments in function definitions. If we are to embrace all the features that we've seen in this series and expand our collection of building blocks even further, we need to be aware of where the data comes in the list of arguments (or &quot;points&quot;).</p><p>It comes <em>last</em>.</p><p>Take a look at any of the functions in Ramda that process data, specifically lists, for example. Take <a href="https://ramdajs.com/docs/#filter">filter</a>, <a href="https://ramdajs.com/docs/#head">head</a> or <a href="https://ramdajs.com/docs/#reduce">reduce</a>. Heck, take <a href="https://ramdajs.com/docs/#take">take</a> (sorry, couldn't resist).</p><p>Each one of them expects the data to be supplied via the last argument. Let's examine <a href="https://ramdajs.com/docs/#reduce">reduce</a> as representative of how this looks. First, the signature is:</p><pre class="language-text"><code class="language-text">((a, b) → a) → a → [b] → a</code></pre><p>So <code>reduce</code> expects, in this order:</p><ul><li><code>((a, b) → a</code> the reducer function</li><li><code>a</code> the starting value for the accumulator</li><li><code>[b]</code> the data (a list of values)</li></ul><p>and produces:</p><ul><li><code>a</code> some value</li></ul><blockquote><p>This is, by the way, brilliantly explained by Brian Lonsdorf in a now-classic talk - see the <a href="#further-material">Further material</a> section for a link.</p></blockquote><h3>A contrived example</h3><p>This &quot;data last&quot; approach, combined with <a href="https://en.wikipedia.org/wiki/Closure_(computer_programming)">closures</a>, makes currying and partial application not only possible, but powerful.</p><p>Let's examine what this means with another slightly contrived example, focusing on the <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Categories/7?$expand=Products">products in the Produce (dried fruit and bean curd) category</a>, this time in JavaScript. I'll use some functions from <a href="https://ramdajs.com">Ramda</a>, mostly to illustrate the mechanisms in a &quot;purer&quot; form than the equivalents in standard JavaScript where the equivalent functions are &quot;attached&quot; to the <code>Array</code> prototype.</p><p>Assuming the entire JSON representation of the <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products">Products entityset</a> is available in a file called <code>products.json</code>, let's start like this:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> prop <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ramda'</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./products.json'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value</code></pre><p>Ramda's <a href="https://ramdajs.com/docs/#prop">prop</a> is a convenient function for getting the value of a property.</p><blockquote><p>It's worth pausing here to think about how this <code>prop</code> function might look in its basic form, as it could help to further cement the concepts of currying and partial application (and closures, by the by). Given an object such as <a href="https://developer-challenge.cfapps.eu10.hana.ondemand.com/odata/v4/northbreeze/Products/1">the Chai product</a> (see <a href="#chai">earlier</a>), if we want a function with which to retrieve the value of a property, we need both the object and the property name, which we can express with a definition such as <code>myprop = p =&gt; o =&gt; o[p]</code>. One difference between <code>myprop</code> here and <code>prop</code> is that the latter, being a Ramda function, is curried by default.</p></blockquote><p>OK. Suppose we wanted to determine the products in the Produce category (the category ID is 7) and emit a list of their names.</p><p>The &quot;imperative&quot;, or at least direct way of approaching this might look like this:</p><pre class="language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>  products<br>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> x<span class="token punctuation">.</span>Category_CategoryID <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'ProductName'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span></code></pre><p>This produces what we want:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">[</span><br>  <span class="token string">"Uncle Bob's Organic Dried Pears"</span><span class="token punctuation">,</span><br>  <span class="token string">"Tofu"</span><span class="token punctuation">,</span><br>  <span class="token string">"Rössle Sauerkraut"</span><span class="token punctuation">,</span><br>  <span class="token string">"Manjimup Dried Apples"</span><span class="token punctuation">,</span><br>  <span class="token string">"Longlife Tofu"</span><br><span class="token punctuation">]</span></code></pre><p>but is a little rigid. It's not <em>bad</em>, and JavaScript's native <code>filter</code> and <code>map</code> functions work well. But we'll switch to the Ramda equivalents to experiment a little bit more, and to explore the point free and partial application concepts further, as well as working our way towards a nice (if not a little simple) composition.</p><h3>Building blocks</h3><p>Let's feel our way through constructing some high level building blocks (in the form of functions, of course).</p><p>First, how about this. I'll add <a href="https://ramdajs.com/docs/#curry">curry</a> and <a href="https://ramdajs.com/docs/#filter">filter</a> to the list of explicitly imported functions (<code>const { prop, curry, filter } = require('ramda')</code>), and use it when defining a function thus:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> justCategory <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'Category_CategoryID'</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">==</span> n<span class="token punctuation">)</span></code></pre><p>Because the function is curried, we can now comfortably partially apply it and build other functions with it:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> onlyProduce <span class="token operator">=</span> <span class="token function">justCategory</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span></code></pre><p>Now we can use this as follows:</p><pre class="language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>    <span class="token function">filter</span><span class="token punctuation">(</span>onlyProduce<span class="token punctuation">,</span> products<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'productname'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span></code></pre><p>Not a huge change, but right now it feels weird because we're sort of in a hybrid state - a &quot;pure&quot; <code>filter</code> function from Ramda but then the <code>Array.prototype.map</code> function tacked on at the end. Moreover, consider where that <code>products</code> data reference is currently: it's sort of stuck, embedded within the entire expression.</p><p>If we add <code>map</code> to the list of imported functions, we can modify things to use Ramda's <code>map</code> so that we have a literal composition:</p><pre class="language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>    <span class="token function">map</span><span class="token punctuation">(</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'ProductName'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">filter</span><span class="token punctuation">(</span>onlyProduce<span class="token punctuation">,</span> products<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span></code></pre><p>This is also a sort of intermediate state but one that conveniently illustrates the mathematical basis of composition, i.e. <code>f(g(x))</code>, where <code>g</code> is applied to <code>x</code> and then <code>f</code> is applied to what that produces. You might have seen this <a href="https://en.wikipedia.org/wiki/Function_composition_(computer_science)">composition of functions</a> <code>f</code> and <code>g</code> expressed as <code>f ∘ g</code>, i.e. &quot;g composed with f&quot;<a href="#footnote-2"><sup>2</sup></a>.</p><h3>Compose</h3><p>So let's use Ramda's <a href="https://ramdajs.com/docs/#compose">compose</a> to cement this, noting that we can &quot;unnest&quot; the relationship, and more importantly &quot;lose&quot; the reference to the data:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> produceList <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><br>  <span class="token function">map</span><span class="token punctuation">(</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'ProductName'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">filter</span><span class="token punctuation">(</span>onlyProduce<span class="token punctuation">)</span><br><span class="token punctuation">)</span></code></pre><p>While we're at it, let's construct another small building block:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'ProductName'</span><span class="token punctuation">)</span></code></pre><p>and use that to move our composition to something that is arguably even more declarative:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> produceList <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><br>  <span class="token function">map</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">filter</span><span class="token punctuation">(</span>onlyProduce<span class="token punctuation">)</span><br><span class="token punctuation">)</span></code></pre><p>Be aware that at this point, emitting <code>produceList</code> to the log will show this:</p><pre class="language-text"><code class="language-text">[Function (anonymous)]</code></pre><p>That's because <code>compose</code> has also only been partially applied, and is <em>waiting for data</em>. Let's give it some now:</p><pre class="language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><br>  <span class="token function">produceList</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><br><span class="token punctuation">)</span></code></pre><p>Guess what - this produces the same output too:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">[</span><br>  <span class="token string">"Uncle Bob's Organic Dried Pears"</span><span class="token punctuation">,</span><br>  <span class="token string">"Tofu"</span><span class="token punctuation">,</span><br>  <span class="token string">"Rössle Sauerkraut"</span><span class="token punctuation">,</span><br>  <span class="token string">"Manjimup Dried Apples"</span><span class="token punctuation">,</span><br>  <span class="token string">"Longlife Tofu"</span><br><span class="token punctuation">]</span></code></pre><p>Here's the script now in its entirety:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> prop<span class="token punctuation">,</span> curry<span class="token punctuation">,</span> filter<span class="token punctuation">,</span> compose<span class="token punctuation">,</span> map <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ramda'</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./products.json'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<br><br><span class="token keyword">const</span> justCategory <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> x</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'Category_CategoryID'</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">==</span> n<span class="token punctuation">)</span><br><br><span class="token keyword">const</span> onlyProduce <span class="token operator">=</span> <span class="token function">justCategory</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'ProductName'</span><span class="token punctuation">)</span><br><br><span class="token keyword">const</span> produceList <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><br>  <span class="token function">map</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">filter</span><span class="token punctuation">(</span>onlyProduce<span class="token punctuation">)</span><br><span class="token punctuation">)</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">produceList</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3>One extra level of abstraction</h3><p>Depending on how we prefer to think about the abstractions, we might wish to go one level further up towards even higher level coding abstractions by pushing the <code>map</code> and <code>filter</code> up into the pre-<code>compose</code> definitions:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> onlyProduce <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">justCategory</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'ProductName'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token keyword">const</span> produceList <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><br>  names<span class="token punctuation">,</span><br>  onlyProduce<br><span class="token punctuation">)</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">produceList</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3>Pipe</h3><p>In a way, we got here to this composition via a route that included function chains, which are most similar to the pipe based constructions in the <code>jq</code> and <code>bash</code> examples earlier. And in fact there's a sibling function to <code>compose</code> in the Ramda toolkit, which is <a href="https://ramdajs.com/docs/#pipe">pipe</a>.</p><p>With <code>compose</code>, we think about the <code>f(g(x))</code> pattern and express it naturally in that way, with the innermost function last in the list:</p><pre class="language-javascript"><code class="language-javascript"><span class="token function">compose</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span></code></pre><p>Alternatively we can consider the data flowing through a series of functions, our building blocks, so it's easier to think about things the other way round, i.e. <code>-&gt; | g | f</code>, and with <code>pipe</code> we can express it naturally in that way:</p><pre class="language-javascript"><code class="language-javascript"><span class="token function">pipe</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> f<span class="token punctuation">)</span></code></pre><p>If you're coming from a more standard JavaScript background and have been used to using function chains with the <code>Array</code> prototypical functions such as <code>map</code>, <code>filter</code>, <code>some</code>, <code>reduce</code> and so on, then <code>pipe</code> might be a better mental fit.</p><p>By the way, based on the <code>pipe</code> equivalent of the even higher abstraction version, it would look like this (assuming we add <code>pipe</code> to the list of imported functions from Ramda of course):</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> produceList <span class="token operator">=</span> <span class="token function">pipe</span><span class="token punctuation">(</span><br>  onlyProduce<span class="token punctuation">,</span><br>  names<br><span class="token punctuation">)</span></code></pre><h2>Wrapping up</h2><p>Anyway, I think it's time to bring this ramble to a close. Hopefully you can see that thinking about functional programming concepts such as partial application will naturally lead you to also think about other related concepts such as currying, closures and so on, all supported by the underpinnings that come in the form of functions as values and higher order functions. And while you can already start thinking functionally even in regular JavaScript, having a library like Ramda, or even building your own utility functions<a href="#footnote-3"><sup>3</sup></a>, takes you a great deal further.</p><p><a name="further-material"></a></p><h2>Further material</h2><ul><li><a href="/blog/posts/2025/05/01/fp-function-chains-and-cap-model-loading/">FP, function chains and CAP model loading</a></li><li><a href="/tags/jq/">More posts on jq</a></li><li>Brian Lonsdorf's classic talk <a href="https://www.youtube.com/watch?v=m3svKOdZijA">Hey Underscore, You're Doing It Wrong!</a></li></ul><hr><p><a name="footnotes"></a></p><h2>Footnotes</h2><p><a name="footnote-1"></a> 1 i.e. amenable to classic shell tools that process textual-based information.</p><p><a name="footnote-2"></a> 2 In some languages, such as Haskell, this is expressed in pretty much the same way, i.e. <code>foo = f . g</code></p><p><a name="footnote-3"></a> 3 For example, a simple <code>compose</code> function <a href="https://www.linkedin.com/posts/djadams_handsonsapdev-activity-7327252502918184961-LEo9">could look like</a> this: <code>const compose = (...fs) =&gt; (x) =&gt; fs.reverse().reduce((a, f) =&gt; f(a), x)</code> (yes I know there's a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight">reduceRight</a> too :-))</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/fp/">#fp</a> <a href="/tags/jq/">#jq</a> <a href="/tags/cap/">#cap</a> <a href="/tags/odata/">#odata</a> <a href="/tags/shell/">#shell</a> <a href="/tags/javascript/">#javascript</a> <a href="/tags/handsonsapdev/">#handsonsapdev</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2025/05/04/adjusting-the-preview-width-in-telescope&#39;s-horizontal-picker/"><span>Adjusting the preview width in Telescope&#39;s horizontal picker</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="/tweets/">Tweet Archive</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a rel="me" href="https://bsky.app/profile/qmacro.org" target="_blank" rel="noopener noreferrer">Bluesky</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>