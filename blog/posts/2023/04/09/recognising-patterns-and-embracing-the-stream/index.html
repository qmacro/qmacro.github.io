<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Recognising patterns and embracing the stream</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="recognising-patterns-and-embracing-the-stream">Recognising patterns and embracing the stream</h1>

<ul class="post-metadata">
	<li><time datetime="2023-04-09">09 April 2023</time></li>
	<li><a href="/tags/jq/" class="post-tag">jq</a>, </li>
	<li><a href="/tags/patterns/" class="post-tag">patterns</a></li>
</ul>

<p class="post-description-main"></p>

<p>I've been listening to discussions on <a href="https://bird.makeup/@code_report">Conor Hoekstra</a>'s <a href="https://www.arraycast.com/episodes">Array Cast</a> podcast and <a href="https://t.co/uijuAszeFw">ADSP: The Podcast</a> and watching some of the content on <a href="https://www.youtube.com/@code_report">his YouTube channel</a>, all of which I can highly recommend. While I don't understand everything that's being discussed, I do still enjoy and benefit from the content. One of the many recurring themes seems to be recognising patterns, being aware of what is being expressed, and thinking about whether there's an alternative way to do so, for simplicity, clarity, performance or other reasons.</p>
<p>I was happy to be able to recognise a pattern in a tiny submission I made this evening to a repo of <a href="https://github.com/atejada/led_numbers#led_numbers">different language based implementations of a simple LED number display</a> from <a href="https://twitter.com/Blag">Blag</a>, an old friend of mine from the SAP world.</p>
<h2 id="the-initial-contribution">The initial contribution</h2>
<p>I wanted to contribute a jq version of the LED number display program for the repo, as it didn't have one. The first commit in my pull request contained a working version, which was this:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token keyword">def</span> <span class="token function">segments</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">"| |"</span><span class="token punctuation">,</span> <span class="token string">"|_|"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"   "</span><span class="token punctuation">,</span> <span class="token string">"  |"</span><span class="token punctuation">,</span> <span class="token string">"  |"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">" _|"</span><span class="token punctuation">,</span> <span class="token string">"|_ "</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">" _|"</span><span class="token punctuation">,</span> <span class="token string">" _|"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"   "</span><span class="token punctuation">,</span> <span class="token string">"|_|"</span><span class="token punctuation">,</span> <span class="token string">"  |"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">"|_ "</span><span class="token punctuation">,</span> <span class="token string">" _|"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"   "</span><span class="token punctuation">,</span> <span class="token string">"|_ "</span><span class="token punctuation">,</span> <span class="token string">"|_|"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">"  |"</span><span class="token punctuation">,</span> <span class="token string">"  |"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">"|_|"</span><span class="token punctuation">,</span> <span class="token string">"|_|"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">" _ "</span><span class="token punctuation">,</span> <span class="token string">"|_|"</span><span class="token punctuation">,</span> <span class="token string">"  |"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">digits</span><span class="token punctuation">:</span> tostring <span class="token operator pipe">|</span> <span class="token c-style-function function">split</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> tonumber<span class="token punctuation">;</span>

<span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> transpose <span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token c-style-function function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>This was to be invoked like this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token number">42</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token parameter variable">-f</span> led_numbers.jq</code></pre>
<p>which would produce:</p>
<pre class="language-text" tabindex="0"><code class="language-text">    _
|_| _|
  ||_</code></pre>
<h2 id="an-explanation">An explanation</h2>
<p>By way of explanation, assuming we have the two function definitions (<code>segments</code> and <code>digits</code>) already, then:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq">segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span></code></pre>
<p>would produce:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"   "</span><span class="token punctuation">,</span>
  <span class="token string">"|_|"</span><span class="token punctuation">,</span>
  <span class="token string">"  |"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token string">" _ "</span><span class="token punctuation">,</span>
  <span class="token string">" _|"</span><span class="token punctuation">,</span>
  <span class="token string">"|_ "</span>
<span class="token punctuation">]</span></code></pre>
<p>One way of getting the &quot;horizontal slices&quot; of these LED numbers joined up onto the appropriate lines of output is to treat it as a matrix (in Conor &amp; co's language I might use the term &quot;rank 2&quot;) and transpose it.</p>
<p>So I wrapped this stream of arrays in an outer array with the <a href="https://stedolan.github.io/jq/manual/#Arrayconstruction:%5B%5D">array construction</a> syntax <code>[]</code>:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre>
<p>which gave me:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">[</span>
    <span class="token string">"   "</span><span class="token punctuation">,</span>
    <span class="token string">"|_|"</span><span class="token punctuation">,</span>
    <span class="token string">"  |"</span>
  <span class="token punctuation">]</span>
  <span class="token punctuation">[</span>
    <span class="token string">" _ "</span><span class="token punctuation">,</span>
    <span class="token string">" _|"</span><span class="token punctuation">,</span>
    <span class="token string">"|_ "</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">]</span></code></pre>
<p>which I could then transpose, which I did like this:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> transpose</code></pre>
<p>resulting in:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">[</span>
    <span class="token string">"   "</span><span class="token punctuation">,</span>
    <span class="token string">" _ "</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"|_|"</span><span class="token punctuation">,</span>
    <span class="token string">" _|"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"  |"</span><span class="token punctuation">,</span>
    <span class="token string">"|_ "</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">]</span></code></pre>
<p>These subarrays were now ready for joining together as longer strings:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> transpose <span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token c-style-function function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>with the following result:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"    _ "</span><span class="token punctuation">,</span>
  <span class="token string">"|_| _|"</span><span class="token punctuation">,</span>
  <span class="token string">"  ||_ "</span>
<span class="token punctuation">]</span></code></pre>
<p>But I just wanted the plain strings, rather than have then enclosed in an array, so I used the <a href="https://stedolan.github.io/jq/manual/#Array/ObjectValueIterator:.%5B%5D">array iterator</a> to do that:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span> | transpose | map(join(<span class="token string">""</span>))<span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>which gave me what I was looking for (remember that the <code>-r</code> raw output is still being used), so a stream of strings is output but without the enclosing double quotes):</p>
<pre class="language-text" tabindex="0"><code class="language-text">    _
|_| _|
  ||_</code></pre>
<p>Great!</p>
<p>This was what I send in <a href="https://github.com/atejada/led_numbers/pull/1/commits/e6e3e5c3196aa436f865446a1c99ba4b87380eba">the first commit</a> in the pull request.</p>
<h2 id="recognising-the-pattern">Recognising the pattern</h2>
<p>But the solution looked a little noisy, and after staring at it for a few seconds I realised that it was the last part that was bothering me:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token c-style-function function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>The pattern is: <code>map(...)[]</code>. If I didn't want to keep the array shape, then why bother with the <code>map</code> in the first place? It appeared to me that I could replace this with just the expression that I'd put inside the parentheses, in this case just the <code>join(&quot;&quot;)</code>.</p>
<h2 id="an-improvement">An improvement</h2>
<p>The only thing I had to do then, to allow the use of this pattern switch, was to embrace jq's natural streaming nature, and basically start streaming earlier in the pipeline, by using the array iterator directly on the output from <code>transpose</code>, like this:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> transpose<span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre>
<p>This returns something similar to what we saw <code>transpose</code> return earlier, but instead of a single value (an array of arrays of strings), it just returns a stream of the arrays of strings:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"   "</span><span class="token punctuation">,</span>
  <span class="token string">" _ "</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span>
  <span class="token string">"|_|"</span><span class="token punctuation">,</span>
  <span class="token string">" _|"</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span>
  <span class="token string">"  |"</span><span class="token punctuation">,</span>
  <span class="token string">"|_ "</span>
<span class="token punctuation">]</span></code></pre>
<p>Then, each of these three array values are passed downstream, where I then only need the expression that was hitherto inside the <code>map(...)[]</code> construct, i.e.:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token punctuation">[</span>segments<span class="token punctuation">[</span>digits<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> transpose<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator pipe">|</span> <span class="token c-style-function function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre>
<p>This indeed gave me the same result which I wanted:</p>
<pre class="language-text" tabindex="0"><code class="language-text">    _
|_| _|
  ||_</code></pre>
<p>This version feels more idiomatic, and I updated the line to look like this in <a href="https://github.com/atejada/led_numbers/pull/1/commits/5f243bc76b83566a0b1a70dfa5668d49ce496a67">the second commit</a> in the pull request.</p>
<p>Thanks to Conor and his cohorts for helping me remember to look for patterns!</p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2023/04/09/learning-from-community-solutions-on-exercism-part-3/">Learning from community solutions on Exercism - part 3</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2023/04/16/double-sap-btp-goodness-in-isernhagen/">Double SAP BTP goodness in Isernhagen</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2023/04/09/recognising-patterns-and-embracing-the-stream/` was built on 2025-10-14T15:39:28.665Z -->
		<script type="module" src="/dist/R1izrEYWYW.js"></script>
	</body>
</html>
