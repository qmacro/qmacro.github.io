<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2024/11/02/keeping-things-simple-in-domain-modelling-with-cds/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.fe6b9c1e7ba4ff2bb7b5.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Keeping things simple in domain modelling with CDS | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Keeping things simple in domain modelling with CDS"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2024/11/02/keeping-things-simple-in-domain-modelling-with-cds/"><meta name="description" content="Keeping things simple in domain modelling with CDS 02 Nov 2024 | 3 min read When embracing domain modelling with CAP, keep things simple...."><meta property="og:description" content="Keeping things simple in domain modelling with CDS 02 Nov 2024 | 3 min read When embracing domain modelling with CAP, keep things simple...."><meta name="description" content="Keeping things simple in domain modelling with CDS 02 Nov 2024 | 3 min read When embracing domain modelling with CAP, keep things simple...."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Keeping things simple in domain modelling with CDS</h1><div class="post__details"><time datetime="2024-11-02">02 Nov 2024 </time><span>| </span><span>3 min read</span></div></header><main class="post__content"><p>When embracing domain modelling with CAP, keep things simple. One of the greatest benefits of domain modelling done properly is having a domain expert on the team. Don't forget that domain expert, that key user, when building out the domain model.</p><p>What does that mean in practice? Here are two examples that Daniel gave in <a href="https://www.youtube.com/watch?v=XMchiFnDJ6E">the inaugural episode of The Art &amp; Science of CAP</a>.</p><h2>Use structured types with care</h2><p>At around 28 mins in, Daniel gave this example about avoiding the temptation to introduce structured types.</p><p>Let's say we start with this entity definition after the first domain modelling iteration:</p><pre class="language-cds"><code class="language-cds"><span class="token keyword">entity</span> Books : managed {<br>  ...<br>  stock    : <span class="token type builtin">Integer</span>;<br>  price    : <span class="token type builtin">Decimal</span>;<br>  currency : Currency;<br>  ...<br>}</code></pre><p>If on the next iteration further monetary elements were to be added, say <code>totalprice</code> and <code>netprice</code>, then the modelling expert would be tempted to abstract that combination of value and currency into a structured type, something like this:</p><pre class="language-cds"><code class="language-cds"><span class="token cqlkeywords keyword">type</span> Money {<br>  amount   : <span class="token type builtin">Decimal</span>;<br>  currency : Currency;<br>}</code></pre><p>and then use it to describe each of the monetary elements like this:</p><pre class="language-cds"><code class="language-cds"><span class="token keyword">entity</span> Books : managed {<br>  ...<br>  stock      : <span class="token type builtin">Integer</span>;<br>  price      : Money;<br>  totalprice : Money;<br>  netprice   : Money;<br>  ...<br>}</code></pre><p>While that seems appealing, it's only appealing to the modelling expert, certainly not the domain expert.</p><p>Moreover, and perhaps more subtly too, the introduction and use of this structured type brings about extra work: now, one must explicitly ensure that the value of each of the currency elements <code>price.currency</code>, <code>totalprice.currency</code> and <code>totalprice.currency</code> is the same!</p><p>Embracing the <a href="https://en.wikipedia.org/wiki/KISS_principle">KISS principle</a> and simply having a single <code>currency</code> element at the same level swings the pendulum back in the right direction -- towards the domain expert -- and also removes the currency matching burden that was introduced by the use of the structured type:</p><pre class="language-cds"><code class="language-cds"><span class="token keyword">entity</span> Books : managed {<br>  ...<br>  stock      : <span class="token type builtin">Integer</span>;<br>  price      : <span class="token type builtin">Decimal</span>;<br>  totalprice : <span class="token type builtin">Decimal</span>;<br>  netprice   : <span class="token type builtin">Decimal</span>;<br>  currency   : Currency;<br>  ...<br>}</code></pre><p>Of course, <a href="https://cap.cloud.sap/docs/cds/cdl#structured-types">CAP does support the definition and use of structured types in your CDS model</a>, but just because facilities are there, it doesn't mean you have to use them all the time. There are other principles that are more important. And in domain modelling, KISS is one of them.</p><h2>Avoid the 'foo:Foo' practice</h2><p>While a certain <a href="https://en.wikipedia.org/wiki/Foo_Foo_Lammar">famous Manchester drag queen &amp; nightclub owner</a> (RIP) might have something different to say here, defining a type for each of your elements is not considered good practice in CAP. In other words, don't automatically define a <code>Foo</code> type to describe your <code>foo</code> element. Or, to take the example Daniel gave, don't do this:</p><pre class="language-cds"><code class="language-cds"><span class="token cqlkeywords keyword">type</span> Stock : <span class="token type builtin">Integer</span>;<br><span class="token cqlkeywords keyword">type</span> Price : <span class="token type builtin">Decimal</span>;<br><br><span class="token keyword">entity</span> Books : managed {<br>  ...<br>  stock    : Stock;<br>  price    : Price;<br>  currency : Currency;<br>  ...<br>}</code></pre><p>Doing this moves away from the KISS principle, because we now have to jump from:</p><pre class="language-cds"><code class="language-cds">stock : Stock;</code></pre><p>to this:</p><pre class="language-cds"><code class="language-cds"><span class="token cqlkeywords keyword">type</span> Stock : <span class="token type builtin">Integer</span>;</code></pre><p>to see what the <code>stock</code> element really is underneath. More complicated than it needs to be.</p><blockquote><p>An important principle in domain modelling in CAP is keeping &quot;non-important&quot; details out of sight (CDS's <a href="https://cap.cloud.sap/docs/cds/cdl#aspects">aspects</a> concept plays an important role here). So one might be tempted to argue that the fact that the <code>stock</code> element is an <code>Integer</code> is not important. But there's a level beyond which we shouldn't really descend, and I think that CAP's <a href="https://cap.cloud.sap/docs/cds/types">built-in types</a> feels right as the common currency (no pun intended) between modeller and domain expert and a comfortable shared level.</p></blockquote><p>As Daniel said: &quot;<em>Keep your world ... as flat as the Earth</em>&quot; :-)</p><p>Of course, there are times when reuse types bring benefits. Here, where the reuse ratio is 1, it is unnecessary and over-complicated. Where the reuse ratio is a lot higher, then it starts to make sense.</p><p>Talking of &quot;reuse of types&quot;, there's another way that is possible in CDS, without even defining a type explicitly, but by thinking of <code>:</code> to mean &quot;inherits from&quot;, and considering that everything in CDS is just a definition. But that detail is for another post.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/cds/">#cds</a> <a href="/tags/cap/">#cap</a> <a href="/tags/tasc/">#tasc</a> <a href="/tags/gems/">#gems</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2024/10/26/immutable-layers-file-deletion-and-image-size-in-docker/"><span>Immutable layers, file deletion and image size in Docker</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>