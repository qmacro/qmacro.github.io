<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2024/08/24/new-source-for-lxd-images-on-crostini/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.54fe08380532f159e78f.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>New source for LXD images on Crostini | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="New source for LXD images on Crostini"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2024/08/24/new-source-for-lxd-images-on-crostini/"><meta name="description" content="New source for LXD images on Crostini 24 Aug 2024 | 4 min read I recently wanted to create a second Debian-based container in the Linux..."><meta property="og:description" content="New source for LXD images on Crostini 24 Aug 2024 | 4 min read I recently wanted to create a second Debian-based container in the Linux..."><meta name="description" content="New source for LXD images on Crostini 24 Aug 2024 | 4 min read I recently wanted to create a second Debian-based container in the Linux..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>New source for LXD images on Crostini</h1><div class="post__details"><time datetime="2024-08-24">24 Aug 2024 </time><span>| </span><span>4 min read</span></div></header><main class="post__content"><p>I recently wanted to create a second Debian-based container in the Linux context of one of my ChromeOS devices. But I found I couldn't, as the image wasn't available any more. This post is a short note-to-self to remind myself what happened and what I did.</p><h2>Background</h2><p>The Linux environment in ChromeOS, is the sum of various parts under the umbrella name &quot;Crostini&quot;. One of these parts is <code>termina</code>, a VM from which a default container is launched, with the name &quot;penguin&quot;. It's an LXD container, and there's the <code>lxc</code> command in <code>termina</code> for managing images and containers.</p><p>Most folks who are happy with the Linux terminal environment as-is won't ever need to know this stuff that's underneath, it works very nicely and is integrated well into the rest of the ChromeOS experience. But as <a href="https://chromium.googlesource.com/chromiumos/docs/+/master/containers_and_vms.md">you'll find out</a>, there's a lot going on, and it's a great area for tinkering and learning.</p><h2>Getting to the management level</h2><p>As mentioned just now, managing this stuff is done at the <code>termina</code> VM level, with <code>lxc</code>. To get to run <code>lxc</code> you need to jump into <code>termina</code> from <code>crosh</code>, the ChromeOS developer shell (reached with <code>Ctrl-Alt-T</code>), with <code>vmc start termina</code>.</p><p>Once in <code>termina</code> you can use <code>lxc</code>, like this:</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc list<br>+---------+---------+----------------------------+------+-----------+-----------+<br><span class="token operator">|</span>  NAME   <span class="token operator">|</span>  STATE  <span class="token operator">|</span>            IPV4            <span class="token operator">|</span> IPV6 <span class="token operator">|</span>   TYPE    <span class="token operator">|</span> SNAPSHOTS <span class="token operator">|</span><br>+---------+---------+----------------------------+------+-----------+-----------+<br><span class="token operator">|</span> penguin <span class="token operator">|</span> RUNNING <span class="token operator">|</span> <span class="token number">172.17</span>.0.1 <span class="token punctuation">(</span>docker0<span class="token punctuation">)</span>       <span class="token operator">|</span>      <span class="token operator">|</span> CONTAINER <span class="token operator">|</span> <span class="token number">0</span>         <span class="token operator">|</span><br><span class="token operator">|</span>         <span class="token operator">|</span>         <span class="token operator">|</span> <span class="token number">100.98</span>.28.100 <span class="token punctuation">(</span>tailscale0<span class="token punctuation">)</span> <span class="token operator">|</span>      <span class="token operator">|</span>           <span class="token operator">|</span>           <span class="token operator">|</span><br><span class="token operator">|</span>         <span class="token operator">|</span>         <span class="token operator">|</span> <span class="token number">100.115</span>.92.206 <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>      <span class="token operator">|</span>      <span class="token operator">|</span>           <span class="token operator">|</span>           <span class="token operator">|</span><br>+---------+---------+----------------------------+------+-----------+-----------+</code></pre><blockquote><p>I'm running both Docker and Tailscale in my default &quot;penguin&quot; container, hence the extra IPV4 addresses.</p></blockquote><h2>Image sources</h2><p>Images are available via &quot;remotes&quot;, which can be listed like this:</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc remote list<br>+-----------------+------------------------------------------+---------------+-------------+--------+--------+--------+<br><span class="token operator">|</span>      NAME       <span class="token operator">|</span>                   URL                    <span class="token operator">|</span>   PROTOCOL    <span class="token operator">|</span>  AUTH TYPE  <span class="token operator">|</span> PUBLIC <span class="token operator">|</span> STATIC <span class="token operator">|</span> GLOBAL <span class="token operator">|</span><br>+-----------------+------------------------------------------+---------------+-------------+--------+--------+--------+<br><span class="token operator">|</span> images          <span class="token operator">|</span> https://images.linuxcontainers.org       <span class="token operator">|</span> simplestreams <span class="token operator">|</span> none        <span class="token operator">|</span> YES    <span class="token operator">|</span> NO     <span class="token operator">|</span> NO     <span class="token operator">|</span><br>+-----------------+------------------------------------------+---------------+-------------+--------+--------+--------+<br><span class="token operator">|</span> <span class="token builtin class-name">local</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span> <span class="token operator">|</span> unix://                                  <span class="token operator">|</span> lxd           <span class="token operator">|</span> <span class="token function">file</span> access <span class="token operator">|</span> NO     <span class="token operator">|</span> YES    <span class="token operator">|</span> NO     <span class="token operator">|</span><br>+-----------------+------------------------------------------+---------------+-------------+--------+--------+--------+<br><span class="token operator">|</span> ubuntu          <span class="token operator">|</span> https://cloud-images.ubuntu.com/releases <span class="token operator">|</span> simplestreams <span class="token operator">|</span> none        <span class="token operator">|</span> YES    <span class="token operator">|</span> YES    <span class="token operator">|</span> NO     <span class="token operator">|</span><br>+-----------------+------------------------------------------+---------------+-------------+--------+--------+--------+<br><span class="token operator">|</span> ubuntu-daily    <span class="token operator">|</span> https://cloud-images.ubuntu.com/daily    <span class="token operator">|</span> simplestreams <span class="token operator">|</span> none        <span class="token operator">|</span> YES    <span class="token operator">|</span> YES    <span class="token operator">|</span> NO     <span class="token operator">|</span><br>+-----------------+------------------------------------------+---------------+-------------+--------+--------+--------+</code></pre><p>The <code>images</code> remote is where one normally retrieves non-Ubuntu LXD images, such as those from Debian, Alpine and so on. And to create and start a new container, based on a Debian image, this is the command:</p><pre class="language-shell"><code class="language-shell">lxc launch images:debian/12 mycontainer</code></pre><p>The last time I invoked such a command, which was probably late last year, everything worked as expected.</p><p>However, today, this happens (text wrapped for readability):</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc launch images:debian/12 mycontainer<br>Creating mycontainer<br>Error: Failed instance creation: Failed getting remote image info:<br>Failed getting image: The requested image couldn't be found</code></pre><p>Indeed, querying for images available at the <code>images</code> remote resulted in a list ... of zero:</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc image list images:<br>+-------+-------------+--------+-------------+--------------+------+------+-------------+<br><span class="token operator">|</span> ALIAS <span class="token operator">|</span> FINGERPRINT <span class="token operator">|</span> PUBLIC <span class="token operator">|</span> DESCRIPTION <span class="token operator">|</span> ARCHITECTURE <span class="token operator">|</span> TYPE <span class="token operator">|</span> SIZE <span class="token operator">|</span> UPLOAD DATE <span class="token operator">|</span><br>+-------+-------------+--------+-------------+--------------+------+------+-------------+</code></pre><h2>Project stewardship change</h2><p>This is because of some recent activity which has seen <a href="https://linuxcontainers.org/lxd/">Canonical take over LXD from the Linux Containers project</a> and even, in a rather surprising and unfortunate move, <a href="https://discuss.linuxcontainers.org/t/lxd-has-been-re-licensed-and-is-now-under-a-cla/18454">switch the licence</a> from Apache2 to AGPLv3. This is being dubbed as rather anti-community, and has caused many headaches for the hard working Linux Containers team, who have ultimately had to <a href="https://discuss.linuxcontainers.org/t/lxd-is-no-longer-part-of-the-linux-containers-project/17593">relinquish control of</a>, and <a href="https://discuss.linuxcontainers.org/t/important-notice-for-lxd-users-image-server/18479">end support for</a>, LXD containers.</p><p>While the URL <a href="https://images.linuxcontainers.org">https://images.linuxcontainers.org</a> still responds, and indeed returns a list of images, they are for Incus (a forked LXD project) and LXC, not LXD. The <a href="https://discuss.linuxcontainers.org/t/important-notice-for-lxd-users-image-server/18479#timeline-3">timeline</a> of the phasing out of support culminated in all LXD users losing access to images on that server at the beginning of May this year.</p><p>This is why <code>lxc image list images:</code> returns an empty list.</p><h2>New source for LXD images</h2><p>In the period since this change, it seems that Canonical has at least stepped up to provide a new <a href="https://documentation.ubuntu.com/lxd/en/latest/reference/remote_image_servers/">remote image server</a> which is at <a href="https://images.lxd.canonical.com/">https://images.lxd.canonical.com/</a>.</p><p>It can be used a new remote in the context of what I want to do in Crostini, so I swapped out the URL for the <code>images</code> remote like this:</p><pre class="language-shell"><code class="language-shell">lxc remote set-url images https://images.lxd.canonical.com/</code></pre><p>and checked to see if there were images available at that remote. Lo and behold, there were!</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc image list images: <span class="token operator">|</span> <span class="token function">head</span><br>+------------------------------------------+--------------+--------+-------------------------------------------+--------------+-----------------+-----------+-------------------------------+<br><span class="token operator">|</span>                  ALIAS                   <span class="token operator">|</span> FINGERPRINT  <span class="token operator">|</span> PUBLIC <span class="token operator">|</span>                DESCRIPTION                <span class="token operator">|</span> ARCHITECTURE <span class="token operator">|</span>      TYPE       <span class="token operator">|</span>   SIZE    <span class="token operator">|</span>          UPLOAD DATE          <span class="token operator">|</span><br>+------------------------------------------+--------------+--------+-------------------------------------------+--------------+-----------------+-----------+-------------------------------+<br><span class="token operator">|</span> almalinux/8 <span class="token punctuation">(</span><span class="token number">3</span> <span class="token function">more</span><span class="token punctuation">)</span>                     <span class="token operator">|</span> 69fdb178b29d <span class="token operator">|</span> <span class="token function">yes</span>    <span class="token operator">|</span> AlmaLinux <span class="token number">8</span> amd64 <span class="token punctuation">(</span>20240830_0012<span class="token punctuation">)</span>         <span class="token operator">|</span> x86_64       <span class="token operator">|</span> CONTAINER       <span class="token operator">|</span> <span class="token number">128</span>.99MB  <span class="token operator">|</span> Aug <span class="token number">30</span>, <span class="token number">2024</span> at <span class="token number">12</span>:00am <span class="token punctuation">(</span>UTC<span class="token punctuation">)</span> <span class="token operator">|</span><br>+------------------------------------------+--------------+--------+-------------------------------------------+--------------+-----------------+-----------+-------------------------------+<br><span class="token operator">|</span> almalinux/8 <span class="token punctuation">(</span><span class="token number">3</span> <span class="token function">more</span><span class="token punctuation">)</span>                     <span class="token operator">|</span> ffa80f7786e3 <span class="token operator">|</span> <span class="token function">yes</span>    <span class="token operator">|</span> AlmaLinux <span class="token number">8</span> amd64 <span class="token punctuation">(</span>20240830_0012<span class="token punctuation">)</span>         <span class="token operator">|</span> x86_64       <span class="token operator">|</span> VIRTUAL-MACHINE <span class="token operator">|</span> <span class="token number">850</span>.72MB  <span class="token operator">|</span> Aug <span class="token number">30</span>, <span class="token number">2024</span> at <span class="token number">12</span>:00am <span class="token punctuation">(</span>UTC<span class="token punctuation">)</span> <span class="token operator">|</span><br>+------------------------------------------+--------------+--------+-------------------------------------------+--------------+-----------------+-----------+-------------------------------+<br><span class="token operator">|</span> almalinux/8/arm64 <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">more</span><span class="token punctuation">)</span>               <span class="token operator">|</span> 73fb65f3527d <span class="token operator">|</span> <span class="token function">yes</span>    <span class="token operator">|</span> AlmaLinux <span class="token number">8</span> arm64 <span class="token punctuation">(</span>20240826_0027<span class="token punctuation">)</span>         <span class="token operator">|</span> aarch64      <span class="token operator">|</span> CONTAINER       <span class="token operator">|</span> <span class="token number">125</span>.23MB  <span class="token operator">|</span> Aug <span class="token number">26</span>, <span class="token number">2024</span> at <span class="token number">12</span>:00am <span class="token punctuation">(</span>UTC<span class="token punctuation">)</span> <span class="token operator">|</span><br>+------------------------------------------+--------------+--------+-------------------------------------------+--------------+-----------------+-----------+-------------------------------+<br><span class="token punctuation">..</span>.</code></pre><p>Quite a few, in fact:</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc image list images: <span class="token parameter variable">--format</span> csv <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><br><span class="token number">384</span></code></pre><h2>Launching a new container</h2><p>So I was then able to launch a Debian based container as before:</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc launch images:debian/12 mycontainer<br>Creating mycontainer<br>Starting mycontainer</code></pre><p>and jump right into it:</p><pre class="language-shell"><code class="language-shell"><span class="token punctuation">(</span>termina<span class="token punctuation">)</span> chronos@localhost ~ $ lxc <span class="token builtin class-name">exec</span> mycontainer <span class="token function">bash</span><br>root@mycontainer:~<span class="token comment">#</span></code></pre><h2>Wrapping up</h2><p>So all is well again. At least for me in my own little container world. Not so much for the Linux Containers folks. Thanks to them for everything they've done and continue to do, especially now with their next generation system container and virtual machine manager <a href="https://linuxcontainers.org/incus/">Incus</a>.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/crostini/">#crostini</a> <a href="/tags/chromeos/">#chromeos</a> <a href="/tags/lxc/">#lxc</a> <a href="/tags/lxd/">#lxd</a> <a href="/tags/termina/">#termina</a> <a href="/tags/canonical/">#canonical</a> <a href="/tags/homeops/">#homeops</a> <a href="/tags/shell/">#shell</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2024/09/03/setting-up-a-cache-server-for-apt-packages/"><span>←</span> <span>Setting up a cache server for apt packages</span> </a><a href="/blog/posts/2024/08/24/using-lazydocker-with-ssh-based-remote-contexts/"><span>Using lazydocker with SSH-based remote contexts</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="/tweets/">Tweet Archive</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a rel="me" href="https://bsky.app/profile/qmacro.org" target="_blank" rel="noopener noreferrer">Bluesky</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>