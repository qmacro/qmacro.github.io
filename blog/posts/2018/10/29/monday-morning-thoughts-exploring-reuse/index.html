<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Monday morning thoughts: exploring reuse</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">

      <meta property="og:title" content="Monday morning thoughts: exploring reuse">
        <meta property="og:site_name" content="DJ Adams">
          <meta property="og:image" content="/images/site-image.png">
        <meta property="og:description" content="Reserving the right to be wrong.">
        <meta property="og:url" content="https://qmacro.org/blog/posts/2018/10/29/monday-morning-thoughts-exploring-reuse/">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-word;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="monday-morning-thoughts-exploring-reuse">Monday morning thoughts: exploring reuse</h1>

<ul class="post-metadata">
	<li><time datetime="2018-10-29">29 October 2018</time></li>
	<li><a href="/tags/sapcommunity/" class="post-tag">sapcommunity</a>, </li>
	<li><a href="/tags/mondaymorningthoughts/" class="post-tag">mondaymorningthoughts</a></li>
</ul>

<p class="post-description-main"></p>

<p><em>In this post, I think about reuse and extension, in the context of the
Application Programming Model for SAP Cloud Platform, and mindful of
Björn Goerke's SAP TechEd 2018 keynote message in Barcelona - &quot;keep
the core clean&quot;.</em></p>
<p>Last week saw the Barcelona edition of SAP TechEd 2018, where SAP CTO
Björn Goerke and a great team of role models on stage gave us a keynote
with something for everyone - technical and business alike. During the
keynote, I
<a href="/tweets/qmacro/status/1054640660400295936">tweeted</a>:</p>
<blockquote>
<p><em>My three keywords from the #SAPTechEd keynote so far:</em></p>
<p><em>Open (standards, protocols, APIs)</em></p>
<p>*Reuse (important superpower of @sapcp application programming
model) *</p>
<p><em>Clean (keep the core clean by extending outside of it)</em></p>
</blockquote>
<p>I want to think about the &quot;reuse&quot; and &quot;clean&quot; keywords, because in
many ways they're complementary, in that reuse (and by association,
extension) can help to achieve the goal of a clean core.</p>
<p>Of course, there's a lot more to it than that, but reusing &amp; extending
definitions and services is a key part of building outside of the core,
whether for net new applications or to extend existing solutions. That
implies that the application programming model, which has reuse as a
&quot;superpower&quot;, is a very useful model to know about.</p>
<p>So I thought I'd look into an example of reuse and extension that exist
for us to meditate upon and learn from.</p>
<h2 id="cloud-samples-itelo">cloud-samples-itelo</h2>
<p>Earlier this year Oliver Welzel wrote &quot;<a href="https://blogs.sap.com/2018/06/27/itelo-a-sample-business-application-for-the-new-application-programming-model-for-sap-cloud-platform/">ITelO -- A Sample Business
Application for the new Application Programming Model for SAP Cloud
Platform</a>&quot;
in which he described an application with ra product catalog, and
reviews, for the fictitious company ITelO. The data model is in three
layers, with each building on the one beneath it.</p>
<p>This diagram from the post provides a nice summary of that:</p>
<p><img src="/images/2018/10/ITelOCatalog.png" alt=""></p>
<p><em>The component overview, showing how the data model is built up in
layers</em></p>
<p>(Perhaps before continuing with this post, it might be worth you going
and taking a read of Oliver's post. Don't forget to come back,
though!)</p>
<h2 id="multiple-layers">Multiple layers</h2>
<p>The idea is that there are core artefacts in the &quot;foundation&quot; layer,
the &quot;product-catalog&quot; layer builds on top of that, and then there's
the &quot;itelo&quot; specific application layer at the top.</p>
<p>Each layer is represented by a repository in GitHub, so all the source
is available to study. If we start at the top, and look at the data
model definition at the &quot;itelo&quot; layer, this is what we see*,
specifically in the
<a href="https://github.com/SAP/cloud-samples-itelo/blob/rel-1.0/db/model.cds">db/model.cds</a>
source:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token keyword">namespace</span> clouds.itelo;

<span class="token using keyword">using</span> clouds.products.Products <span class="token from keyword">from</span> '@sap/cloud-samples-catalog';
<span class="token using keyword">using</span> clouds.foundation <span class="token cqlkeywords keyword">as</span> fnd <span class="token from keyword">from</span> '@sap/cloud-samples-foundation';

<span class="token keyword">extend</span> Products with {
    reviews: <span class="token association-composition keyword">Association to many Reviews</span> <span class="token cqlkeywords keyword">on</span> reviews.product = $self <span class="token annotation important">@title:</span> '{i18n>review}';
    averageRating: <span class="token type builtin">Decimal(4, 2)</span> <span class="token annotation important">@(</span>
        title: '{i18n>averageRating}',
        Common.FieldControl: #ReadOnly
    );
    numberOfReviews: <span class="token type builtin">Integer </span><span class="token annotation important">@(</span>
        title: '{i18n>numberOfReviews}',
        Common.FieldControl: #ReadOnly
    );
}

<span class="token keyword">entity</span> Reviews: fnd.BusinessObject {
    product: <span class="token association-composition keyword">Association to Products</span> <span class="token annotation important">@title:</span> '{i18n>product}';
    reviewer: <span class="token association-composition keyword">Association to Reviewers</span> <span class="token annotation important">@title:</span> '{i18n>reviewer_XTIT}';
    title: <span class="token type builtin">String(60)</span> <span class="token annotation important">@title:</span> '{i18n>reviewTitle}';
    message: <span class="token type builtin">String(1024)</span> <span class="token annotation important">@title:</span> '{i18n>reviewText}';
    rating: <span class="token type builtin">Decimal(4, 2)</span> <span class="token annotation important">@title:</span> '{i18n>rating}';
    helpfulCount: <span class="token type builtin">Integer </span><span class="token annotation important">@title:</span> '{i18n>ratedHelpful}';
    helpfulTotal: <span class="token type builtin">Integer </span><span class="token annotation important">@title:</span> '{i18n>ratedTotal}';
}

annotate Reviews with {
    ID <span class="token annotation important">@title:</span> '{i18n>review}';
}

<span class="token keyword">entity</span> Reviewers: fnd.Person, fnd.BusinessObject {
}

annotate Reviewers with {
    ID <span class="token annotation important">@title:</span> '{i18n>reviewer_XTIT}';
}</code></pre>
<p>*I'm specifically using the &quot;rel-1.0&quot; branch in each case, because
that's what's also used in the dependency references that we'll see
shortly, and represents a stable version that we can examine.</p>
<h2 id="reuse-through-using-statements">Reuse through &quot;using&quot; statements</h2>
<p>Looking at the first few lines, we see some &quot;using&quot; statements:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token using keyword">using</span> clouds.products.Products <span class="token from keyword">from</span> '@sap/cloud-samples-catalog';
<span class="token using keyword">using</span> clouds.foundation <span class="token cqlkeywords keyword">as</span> fnd <span class="token from keyword">from</span> '@sap/cloud-samples-foundation';</code></pre>
<p>So this is already interesting. Is this reuse in action? It is. But what
does it mean, exactly? Let's investigate. Taking the first &quot;using&quot;
statement, something called &quot;clouds.products.Products&quot; is being used
from something called &quot;@sap/cloud-samples-catalog&quot;.</p>
<p>In the <a href="https://help.sap.com/viewer/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/c6f83f47d8364a06922a60aa57a699f8.html">Model
Reuse</a>
section of the documentation on the SAP Help Portal, we can see that
this is effectively an import of a definition from another CDS model.
OK, which one? Well, we can recognise the &quot;cloud-samples-catalog&quot; name
as it's one of the layers in the diagram we looked at earlier. But how
is that resolved?</p>
<p>For that, we have to look in the &quot;itelo&quot; layer project's
<a href="https://github.com/SAP/cloud-samples-itelo/blob/rel-1.0/package.json">package.json</a>
file, where, amongst other things, we see some dependencies defined:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds">"dependencies": {
    "<span class="token annotation important">@sap/cloud-samples-foundation":</span> "https:<span class="token single-line-comment comment">//github.com/SAP/cloud-samples-foundation.git#rel-1.0",</span>
    "<span class="token annotation important">@sap/cloud-samples-catalog":</span> "https:<span class="token single-line-comment comment">//github.com/SAP/cloud-samples-catalog.git#rel-1.0"</span>
}</code></pre>
<p>Ooh, well that's exciting, for a start! The package.json file is <a href="https://docs.npmjs.com/files/package.json">from
the Node Package Manager (NPM)
world</a> and the dependencies
section is where one defines dependencies to other packages, typically
ones like &quot;express&quot;, if you're building services that handle HTTP
requests, for example. But what do we have here?</p>
<p>Well, we can see the names referenced in the &quot;using&quot; statements
earlier, in other words &quot;@sap/cloud-samples-catalog&quot; and
&quot;@sap/cloud-samples-foundation&quot;. But instead of simple package names,
they're mapped to GitHub URLs. And not just any GitHub URLs, but URLs
that refer to specific repositories, and indeed specific branches!
Taking the URL for the &quot;@sap/cloud-samples-catalog&quot; name, we have:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds">https:<span class="token single-line-comment comment">//github.com/SAP/cloud-samples-catalog.git#rel-1.0</span></code></pre>
<p>which refers to the <a href="https://github.com/SAP/cloud-samples-catalog/tree/rel-1.0">rel-1.0
branch</a> of
the cloud-samples-catalog repository belonging to SAP.</p>
<h2 id="the-product-catalog-layer">The &quot;product-catalog&quot; layer</h2>
<p>Looking there, we see a fully formed application - the middle
&quot;product-catalog&quot; layer that we saw earlier, with app, srv and db
folders representing each of the three components of a typical fully
fledged solution based on the application programming model.</p>
<p><img src="/images/2018/10/Screenshot-2018-10-29-at-10.19.20.png" alt=""></p>
<p>In the db folder we see the
<a href="https://github.com/SAP/cloud-samples-catalog/blob/rel-1.0/db/model.cds">model.cds</a>
file, which starts like this:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token keyword">namespace</span> clouds.products;

<span class="token using keyword">using</span> clouds.foundation <span class="token cqlkeywords keyword">as</span> fnd <span class="token from keyword">from</span> '@sap/cloud-samples-foundation';
<span class="token using keyword">using</span> clouds.foundation.CodeList;

<span class="token keyword">entity</span> Products: fnd.BusinessObject {
    <span class="token single-line-comment comment">// general info</span>
    <span class="token cqlkeywords keyword">key</span> ID: <span class="token type builtin">String(36)</span>;
    name: localized <span class="token type builtin">String </span><span class="token annotation important">@(</span>
        title: '{i18n><span class="token cdl-keyword keyword">name</span>}',
        Common.FieldControl: #Mandatory,
        Capabilities.SearchRestrictions.Searchable
    );
    description: localized <span class="token type builtin">String </span><span class="token annotation important">@(</span>
        title: '{i18n>description}',
        Common.FieldControl: #Mandatory
    );

    [...]</code></pre>
<h2 id="fractals">Fractals</h2>
<p>In a wonderfully fractal way, we notice immediately that this model
definition also refers to another package with a &quot;using&quot; statement,
but let's resist descending deeper just at this moment. Instead, we can
concentrate on looking at what's going on with the &quot;using&quot; statement
we've seen in the consuming definition earlier, which looked like
this:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token using keyword">using</span> clouds.products.Products <span class="token from keyword">from</span> '@sap/cloud-samples-catalog';</code></pre>
<p>We realise that &quot;clouds.products.Products&quot; refers to the Products
entity in the &quot;cloud.products&quot; namespace, which is defined here with
the &quot;entity&quot; definition:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token keyword">entity</span> Products: fnd.BusinessObject { ... }</code></pre>
<p>But what is that &quot;fnd.BusinessObject&quot; sitting between the entity name
and the block definition in curly braces? Why, it's more reuse, this
time of the underlying &quot;foundation&quot; layer. Just above in the same
file, we can see that this layer is referenced in a &quot;using&quot; statement,
this time with a local alias &quot;fnd&quot; defined:</p>
<p>using clouds.foundation as fnd from '@sap/cloud-samples-foundation';</p>
<p>So now let's briefly descend into the fractal. The reference to
&quot;fnd.BusinessObject&quot; is to an entity defined in the &quot;foundation&quot;
layer, which we can see if we follow the <a href="https://github.com/SAP/cloud-samples-catalog/blob/rel-1.0/package.json#L9">dependency reference in the
&quot;product-catalog&quot; layer's
package.json</a>:</p>
<p><img src="/images/2018/10/Screenshot-2018-10-29-at-10.22.27.png" alt=""></p>
<p>(It's worth observing that in this layer we only have data definitions
-- in the form of &quot;.cds&quot; files -- rather than a full blown solution
with app, srv and db folders.)</p>
<p>In this repository (again, branch &quot;rel-1.0&quot;) we can find the
definition of the BusinessObject entity <a href="https://github.com/SAP/cloud-samples-foundation/blob/rel-1.0/common.cds#L3-L8">in the common.cds
file</a> looking
like this:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token keyword">abstract</span> <span class="token keyword">entity</span> BusinessObject : ManagedObject {
    <span class="token cqlkeywords keyword">key</span> ID : <span class="token type builtin">UUID </span><span class="token annotation important">@(</span>
        title: '{i18n>uuid}',
        Common.Text: {$value: <span class="token cdl-keyword keyword">name</span>, "<span class="token annotation important">@UI.TextArrangement":</span> #TextOnly}
    );
}</code></pre>
<p>Note in passing that here the &quot;BusinessObject&quot; entity is defined as
&quot;abstract&quot; which means that it's just a type declaration rather than
something for which instances should exist. Note also that it's further
defined, using a similar pattern to where we saw the
&quot;fnd.BusinessObject&quot; reference, by another abstract entity definition
&quot;ManagedObject&quot; (you can <a href="https://github.com/SAP/cloud-samples-foundation/blob/rel-1.0/common.cds#L10-L34">find this definition of
ManagedObject</a>
also in the common.cds file).</p>
<h2 id="extension-through-extend-statements">Extension through &quot;extend&quot; statements</h2>
<p>Moving back up the layers for some air, we see that directly following
the &quot;using&quot; statements, there is this:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token keyword">extend</span> Products with {
    reviews: <span class="token association-composition keyword">Association to many Reviews</span> <span class="token cqlkeywords keyword">on</span> reviews.product = $self <span class="token annotation important">@title:</span> '{i18n>review}';
    averageRating: <span class="token type builtin">Decimal(4, 2)</span> <span class="token annotation important">@(</span>
        title: '{i18n>averageRating}',
        Common.FieldControl: #ReadOnly
    );
    numberOfReviews: <span class="token type builtin">Integer </span><span class="token annotation important">@(</span>
        title: '{i18n>numberOfReviews}',
        Common.FieldControl: #ReadOnly
    );
}</code></pre>
<p>With the &quot;extend&quot;
<a href="https://help.sap.com/viewer/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/40582e7bbeca4311b0b165c8b9745094.html">aspect</a>,
entity definitions can be repurposed with extra properties, for example.
In this case, the existing Products entity (from the &quot;product-catalog&quot;
layer's data definition) is extended with three properties:
&quot;reviews&quot;, &quot;averageRating&quot; and &quot;numberOfReviews&quot;. Note that the
&quot;reviews&quot; property is an association to a <a href="https://github.com/SAP/cloud-samples-itelo/blob/1.0.0/db/model.cds#L18-L26">Reviews
entity</a>
at this (itelo) application layer, defined expressly for this purpose.</p>
<p>Moreover, some of the properties in the Reviews entity are also defined
as associations to further entities therein, such as the reviewer
property which points to the <a href="https://github.com/SAP/cloud-samples-itelo/blob/1.0.0/db/model.cds#L32-L33">Reviewers
entity</a>,
which has no properties of its own, but in a beautiful way inherits from
some of the definitions (Person and BussinessObject) at the
&quot;foundation&quot; layer:</p>
<pre class="language-cds" tabindex="0"><code class="language-cds"><span class="token keyword">entity</span> Reviewers: fnd.Person, fnd.BusinessObject {
}</code></pre>
<h2 id="wrapping-up">Wrapping up</h2>
<p>That might be a lot to take in, in one sitting. It has become quite
clear to me that the facilities afforded by the CDS language in the
application programming model are very rich when it comes to reuse and
extensions. Not only at the definition level, but also in the simplicity
of how package based references are realised.</p>
<p>While at first I thought it was a little odd to see the GitHub
repository &amp; branch URLs, and indeed to realise that the package.json
mechanism was fundamental to how artefacts in the application
programming model are related, I've come to think that it's a natural
way to do it, and a celebration of adopting an approach that's already
out there in the world beyond our SAP ecosphere.</p>
<p>What's more, we haven't even touched on how annotations work and what
we are able to do in terms of reuse there too. But I'll leave that for
another time, instead leaving you with the suggestion that reuse is
indeed an important superpower of the application programming model, and
demonstrably so. And keeping the core clean - well, the more extension
and reuse we can achieve, the closer we can get to a cleaner core.</p>
<hr>
<p>This post was brought to you by a chilly Monday morning, by <a href="https://www.pactcoffee.com/coffees/asomuprisma">Pact
Coffee's Asomuprisma</a>
in my <a href="https://anchor.fm/sap-community-podcast">SAP Coffee Corner Radio</a>
mug, and by a <a href="https://open.spotify.com/station/user/qmacro/cluster/3JqLjzwr3h5mESenCGHsbr">Spotify
mix</a>
designed for concentration.</p>
<hr>
<p>Read more posts in this series here: <a href="/tags/mondaymorningthoughts/">Monday morning
thoughts</a>.</p>
<hr>
<p><a href="https://community.sap.com/t5/technology-blogs-by-sap/monday-morning-thoughts-exploring-reuse/ba-p/13350771">Originally published on SAP Community</a></p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2018/10/22/monday-morning-thoughts-dynamic-language/">Monday morning thoughts: dynamic language</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2018/11/05/monday-morning-thoughts-on-starting-blogging/">Monday morning thoughts: on starting blogging</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2018/10/29/monday-morning-thoughts-exploring-reuse/` was built on 2026-01-16T13:05:29.951Z -->
		<script type="module" src="/dist/t-8sxMV3B9.js"></script>
	</body>
</html>
