<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2020/04/24/terminal-tip:-remotely-monitor-a-cf-deployment/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.7884d8f8e9dd86c3b137.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Terminal Tip: remotely monitor a CF deployment | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Terminal Tip: remotely monitor a CF deployment"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2020/04/24/terminal-tip:-remotely-monitor-a-cf-deployment/"><meta name="description" content="Terminal Tip: remotely monitor a CF deployment 24 Apr 2020 | 2 min read In today&#39;s HandsOnSAPDev live stream, Ep.65, we built the SAP Cloud..."><meta property="og:description" content="Terminal Tip: remotely monitor a CF deployment 24 Apr 2020 | 2 min read In today&#39;s HandsOnSAPDev live stream, Ep.65, we built the SAP Cloud..."><meta name="description" content="Terminal Tip: remotely monitor a CF deployment 24 Apr 2020 | 2 min read In today&#39;s HandsOnSAPDev live stream, Ep.65, we built the SAP Cloud..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Terminal Tip: remotely monitor a CF deployment</h1><div class="post__details"><time datetime="2020-04-24">24 Apr 2020 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p>In today's <a href="https://bit.ly/handsonsapdev">HandsOnSAPDev</a> live stream, <a href="http://bit.ly/handsonsapdev#ep65">Ep.65</a>, we built the SAP Cloud Platform Workflow sample application MTA in the SAP Web IDE, and deployed it to our Cloud Foundry (CF) space from there too. We noticed that the console logging was buffering the deployment log, so we didn't see much during the operation:</p><p><a href="https://www.youtube.com/watch?v=ZLtwMSq0DKo"><img src="/images/2020/04/Screenshot-2020-04-24-at-14.38.26.png" alt=""></a></p><p>At the time, I wondered out loud whether it was possible to remotely monitor an operation.</p><p>Remember that the <a href="https://plugins.cloudfoundry.org/#multiapps">multiapps</a> plugin for the <code>cf</code> command line tool gives us lots of options in relation to multi target application (MTA) operations. A couple of example are:</p><ul><li>see a summary list of active operations with the <code>mta-ops</code> command</li><li>download the logs of such an operation, with the <code>download-mta-op-logs</code> command (which is also available in the form of a mercifully shorter alias <code>dmol</code>)</li></ul><p>This latter command is in the right ballpark, but doesn't allow the live monitoring (or &quot;tailing&quot;) of log output.</p><p>After the live stream ended, I was pondering this and had a look at the documentation on the SAP Help Portal, specifically the <a href="https://help.sap.com/viewer/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/65ddb1b51a0642148c6b468a759a8a2e.html">Multitarget Application Commands for the Cloud Foundry Environment</a> section. There, it describes the <code>-i</code> option to the <code>cf deploy</code> command, which allows us to interact with active MTA operations:</p><pre class="language-shell"><code class="language-shell">cf deploy  <span class="token punctuation">[</span>-i <span class="token operator">&lt;</span>OPERATION_ID<span class="token operator">></span><span class="token punctuation">]</span> <span class="token punctuation">[</span>-a <span class="token operator">&lt;</span>ACTION<span class="token operator">></span><span class="token punctuation">]</span> </code></pre><p>Digging a little further, it turns out that one of the actions is <code>monitor</code>, and indeed that's exactly what we're looking for!</p><p>So, kicking off a deployment in the SAP Web IDE gives us something in the console that looks like what we see above in the screenshot. But we can switch to a more comfortable terminal environment and use this feature to monitor that very operation that we kicked off in the SAP Web IDE.</p><p>Here's how: In the terminal, we can first find out the ID of the MTA operation, like this:</p><pre class="language-shell"><code class="language-shell">-<span class="token operator">></span> cf mta-ops                                                                                                                   <br>Getting active multi-target app operations <span class="token keyword">in</span> org p2001351149trial / space dev as qmacro+workflowcodejam@example.com<span class="token punctuation">..</span>.           <br>OK                                                                                                                              <br><span class="token function">id</span>                                     <span class="token builtin class-name">type</span>     mta <span class="token function">id</span>                  status    started at                      started by    <br>f450e444-8632-11ea-abb3-eeee0a8f6ba7   DEPLOY   sample.onboarding.mta   RUNNING   <span class="token number">2020</span>-04-24T13:53:19.367Z<span class="token punctuation">[</span>UTC<span class="token punctuation">]</span>   qmacro+workflowcodejam@example.com </code></pre><p>We can then take the ID and use it like this:</p><pre class="language-shell"><code class="language-shell">-<span class="token operator">></span> cf deploy <span class="token parameter variable">-i</span> f450e444-8632-11ea-abb3-eeee0a8f6ba7 <span class="token parameter variable">-a</span> monitor                                   <br>Updating application <span class="token string">"uiDeployer"</span><span class="token punctuation">..</span>.<br>Application <span class="token string">"uiDeployer"</span> attributes are not modified and will not be updated                      <br>Uploading application <span class="token string">"uiDeployer"</span><span class="token punctuation">..</span>.<br>Content of application <span class="token string">"uiDeployer"</span> is not changed - upload will be skipped.                      <br>Starting application <span class="token string">"uiDeployer"</span><span class="token punctuation">..</span>.<br>Application <span class="token string">"uiDeployer"</span> started<br>Deleting discontinued configuration entries <span class="token keyword">for</span> application <span class="token string">"uiDeployer"</span><span class="token punctuation">..</span>.<br>Service key <span class="token string">"onboarding-workflow-credentials"</span> <span class="token keyword">for</span> <span class="token function">service</span> <span class="token string">"workflow"</span> already exists<br>Uploading content module <span class="token string">"onboarding"</span> <span class="token keyword">in</span> target <span class="token function">service</span> <span class="token string">"workflow"</span><span class="token punctuation">..</span>.<br>Deploying content module <span class="token string">"onboarding"</span> <span class="token keyword">in</span> target <span class="token function">service</span> <span class="token string">"workflow"</span><span class="token punctuation">..</span>.<br>Skipping deletion of services, because the <span class="token builtin class-name">command</span> line option <span class="token string">"--delete-services"</span> is not specified.<br>Process finished.<br>Use <span class="token string">"cf dmol -i f450e444-8632-11ea-abb3-eeee0a8f6ba7"</span> to download the logs of the process.</code></pre><p>I'd say that the ability to monitor ongoing MTA operations in the terminal, regardless of where the operation was initiated, is pretty neat. Wouldn't you?</p><p>If this has whetted your appetite, read the next post in this collection: <a href="https://blogs.sap.com/2020/05/01/terminal-tip-a-cf-remote-monitor-script/">Terminal Tip: a CF remote monitor script</a>, which ties these things together into a neat little script.</p><p>Share &amp; enjoy, and remember, <a href="https://twitter.com/search?q=%23TheFutureIsTerminal&amp;src=typed_query">TheFutureIsTerminal</a>!</p><hr><p><a href="https://community.sap.com/t5/technology-blogs-by-sap/terminal-tip-remotely-monitor-a-cf-deployment/ba-p/13453433">Originally published on SAP Community</a></p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/sapcommunity/">#sapcommunity</a> <a href="/tags/terminal/">#terminal</a> <a href="/tags/terminaltip/">#terminaltip</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2020/05/01/terminal-tip:-a-cf-remote-monitor-script/"><span>←</span> <span>Terminal Tip: a CF remote monitor script</span> </a><a href="/blog/posts/2020/04/23/terminal-tip:-switching-cf-targets/"><span>Terminal Tip: switching CF targets</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="/tweets/">Tweet Archive</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a rel="me" href="https://bsky.app/profile/qmacro.bsky.social" target="_blank" rel="noopener noreferrer">Bluesky</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>