<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2020/07/02/sap-npm-packages-now-on-npmjs.org/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.7884d8f8e9dd86c3b137.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>SAP NPM packages now on npmjs.org | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="SAP NPM packages now on npmjs.org"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2020/07/02/sap-npm-packages-now-on-npmjs.org/"><meta name="description" content="SAP NPM packages now on npmjs.org 02 Jul 2020 | 5 min read This post tells you what you need to know - and do - about the recent migration..."><meta property="og:description" content="SAP NPM packages now on npmjs.org 02 Jul 2020 | 5 min read This post tells you what you need to know - and do - about the recent migration..."><meta name="description" content="SAP NPM packages now on npmjs.org 02 Jul 2020 | 5 min read This post tells you what you need to know - and do - about the recent migration..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>SAP NPM packages now on npmjs.org</h1><div class="post__details"><time datetime="2020-07-02">02 Jul 2020 </time><span>| </span><span>5 min read</span></div></header><main class="post__content"><p><em>This post tells you what you need to know - and do - about the recent migration of SAP Node.js packages to the default registry at npmjs.org.</em></p><p>🚨See the <a href="#updates">Updates</a> section for an important announcement.</p><h2>TL;DR</h2><p>Since 2017 SAP has made Node.js packages available at an SAP-specific registry <a href="https://npm.sap.com">https://npm.sap.com</a>. Over the past few weeks the team has been busy migrating these packages to the default public registry <a href="https://npmjs.org">https://npmjs.org</a>.</p><p>Moreover, updates to SAP packages will in future only be available from the default public registry, and the SAP-specific registry will be phased out.</p><p>So now is the time to remove any NPM configuration you may have set to point to the SAP-specific registry for SAP packages.</p><p>Do it like this:</p><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> config delete @sap:registry</code></pre><p>(If you're on Windows, you may need to put the <code>@sap:registry</code> part in double quotes).</p><p>And you're done!</p><h2>Background</h2><p>The default package manager for Node.js is the Node Package Manager (NPM). Node.js packages (also referred to as NPM packages) can be made available publicly in registries. The main, default registry is at <a href="https://npmjs.org">https://npmjs.org</a>.</p><p>For organisational purposes, a package can belong to a <a href="https://docs.npmjs.com/using-npm/scope.html">scope</a> (think of it as similar to a namespace). The scope starts with an @ sign and is joined to the package name with a slash. For example, the package</p><pre class="language-text"><code class="language-text">@sap/cds-dk</code></pre><p>is in the <code>@sap</code> scope.</p><p>Combine this scope idea with the fact that there can be more than one registry (that's why <a href="https://npmjs.org">https://npmjs.org</a> is called the &quot;default&quot; registry) and it means that it's possible to, for example, have packages belonging to a certain scope published to and available at a different registry.</p><h2>The (now retired) SAP NPM registry</h2><p>This is the basis of what SAP did three years ago with the launching of the SAP NPM registry - see the <a href="https://blogs.sap.com/2017/05/16/sap-npm-registry-launched-making-the-lives-of-node.js-developers-easier/">post</a> from Sven Kohlhaas back in 2017.</p><p>On your system, NPM will exist mainly as the command <code>npm</code>, and when you ask it to install a package for you it will download the package from the registry associated with the specified scope.</p><p>Here's an example (note that this is how it's worked up until now, for illustration purposes):</p><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> <span class="token function">install</span> @sap/cds-dk</code></pre><p>If there's no specific association between the <code>@sap</code> scope and the SAP NPM registry where the package was available, <code>npm</code> would assume and use the default registry at <a href="https://npmjs.org">https://npmjs.org</a>.</p><p>So we'd set configuration for <code>npm</code> to tell it to use a specific registry for <code>@sap</code> scoped packages, like this:</p><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> config <span class="token builtin class-name">set</span> @sap:registry<span class="token operator">=</span>https://npm.sap.com</code></pre><p>Now, with the recent migration of SAP packages to the main, default NPM registry at <a href="https://npmjs.org">https://npmjs.org</a>, while the <code>@sap</code> scoping of the packages remain, the configuration setting associating the <code>@sap</code> scope to the SAP-specific registry (<a href="https://npm.sap.com">https://npm.sap.com</a>) is no longer required.</p><p>Not only that, but it's no longer recommended either, as updates to SAP packages will only be made available on the default NPM registry and the SAP-specific registry will eventually disappear (see the <a href="#updates">Updates</a> section).</p><h2>Understanding and making the change</h2><p>You can examine your NPM configuration with <code>npm config</code>. Here's an example from my machine right now:</p><pre class="language-shell"><code class="language-shell">▶ <span class="token function">npm</span> config list<br><span class="token punctuation">;</span> cli configs<br>metrics-registry <span class="token operator">=</span> <span class="token string">"https://registry.npmjs.org/"</span><br>scope <span class="token operator">=</span> <span class="token string">""</span><br>user-agent <span class="token operator">=</span> <span class="token string">"npm/6.14.4 node/v12.18.0 darwin x64"</span><br><br><span class="token punctuation">;</span> userconfig /Users/i347491/.npmrc<br>@qmacro:registry <span class="token operator">=</span> <span class="token string">"https://npm.pkg.github.com"</span><br>@sap:registry <span class="token operator">=</span> <span class="token string">"https://npm.sap.com"</span><br>depth <span class="token operator">=</span> <span class="token number">0</span><br><br><span class="token punctuation">;</span> <span class="token function">node</span> bin location <span class="token operator">=</span> /Users/i347491/.nvm/versions/node/v12.18.0/bin/node<br><span class="token punctuation">;</span> cwd <span class="token operator">=</span> /Users/i347491<br><span class="token punctuation">;</span> <span class="token environment constant">HOME</span> <span class="token operator">=</span> /Users/i347491<br><span class="token punctuation">;</span> <span class="token string">"npm config ls -l"</span> to show all defaults.</code></pre><p>The semicolon prefixed lines are comments, and the chunk of configuration in the middle is my user specific configuration (i.e. settings that I have made) which have been stored in an <code>.npmrc</code> file in my home directory.</p><p>You can see two scope/registry settings. The first one is for my own <code>@qmacro</code> scoped packages which are on GitHub (see the <a href="https://github.com/features/packages">GitHub packages feature</a> for more information on this).</p><p>The second one is the current (and now unwanted) scope/registry association for SAP packages, there as a result of me running the <code>npm config set</code> command at some stage in the past. It's this association that needs to be removed (so that <code>npm</code> will use the default NPM registry for any <code>@sap</code> scoped packages).</p><p>So let's do this together now:</p><pre class="language-shell"><code class="language-shell"><span class="token function">npm</span> config delete @sap:registry</code></pre><p>This will do exactly what we want, i.e. remove the configuration entry associating the <code>@sap</code> scope with the old (retired) SAP-specific registry.</p><h2>Checking that the change took effect</h2><p>Now, all <code>npm</code> operations referring to <code>@sap</code> scoped packages will use the default <a href="https://npmjs.org">https://npmjs.org</a> registry.</p><p>How do you check this? Of course, you can first just re-run the <code>npm config list</code> command and check that the <code>@sap:registry</code> configuration line has gone.</p><p>You can also check this in a more interesting way by asking for information on <code>@sap</code> scoped package, and checking that the information comes from the default NPM registry implicitly.</p><p>Here's an example that you can try: <code>npm info @sap/cds-dk</code></p><p>This is what the output looks like on my machine right now:</p><pre class="language-shell"><code class="language-shell">▶ <span class="token function">npm</span> info @sap/cds-dk<br><br>@sap/cds-dk@1.8.5 <span class="token operator">|</span> See LICENSE <span class="token function">file</span> <span class="token operator">|</span> deps: <span class="token number">10</span> <span class="token operator">|</span> versions: <span class="token number">17</span><br>Command line client and development toolkit <span class="token keyword">for</span> the SAP Cloud Application Programming Model<br>https://cap.cloud.sap/<br><br>keywords: cap, cds, cli<br><br>bin: cds<br><br>dist<br>.tarball: https://registry.npmjs.org/@sap/cds-dk/-/cds-dk-1.8.5.tgz<br>.shasum: 37673e772df6670b4a021943ef904919385c1b76<br>.integrity: sha512-mqNy5hDg8M8YeFhF0gjfDVGxrUhrojcbRqUV6rWMocRm8ZKbifFBd6syG56R49NUaiei9lZfsdTX6acOP3DzNg<span class="token operator">==</span><br>.unpackedSize: <span class="token number">1.0</span> MB<br><br>dependencies:<br>@sap/cds-foss: ^1.2.0           @sap/edm-converters: ^1.0.30    nodemon: ^2.0.2                 xml-js: ^1.6.11<br>@sap/cds-sidecar-client: ^1.1.3 express: ^4.17.1                passport: ^0.4.1<br>@sap/cds: <span class="token number">3.34</span>.x                mustache: ^4.0.1                sqlite3: <span class="token number">4.1</span>.1<br><br>maintainers:<br>- sap_extncrepos <span class="token operator">&lt;</span>extncrepos@sap.com<span class="token operator">></span><br>- sapnaas <span class="token operator">&lt;</span>Holger.Brox@sap.com<span class="token operator">></span><br>- sapnaasuser <span class="token operator">&lt;</span>extncrepos@sap.com<span class="token operator">></span><br><br>dist-tags:<br>latest: <span class="token number">1.8</span>.5<br><br>published <span class="token number">2</span> weeks ago by sap_extncrepos <span class="token operator">&lt;</span>extncrepos@sap.com<span class="token operator">></span></code></pre><p>The details when you do this may look different as the versions, maintainers and dependencies change over time, but what you want to look for is the fully qualified domain name (FQDN) in the <code>tarball</code> URL:</p><pre class="language-url"><code class="language-url"><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">registry.npmjs.org</span></span><span class="token path"><span class="token path-separator">/</span>@sap<span class="token path-separator">/</span>cds-dk<span class="token path-separator">/</span>-<span class="token path-separator">/</span>cds-dk-1.8.5.tgz</span></code></pre><p>This confirms that it's the default registry that's in play here.</p><h2>For the curious</h2><p>That's about it for this post, but here's a bit more information for the curious.</p><p>In case you're wondering, the structure of the <code>npm</code> command set is quite flexible, designed to fit how you think.</p><p>For example, with the <code>npm config set</code> command earlier, the config word could have been omitted (i.e. <code>npm set</code> works too).</p><p>Some of you sharp-eyed readers will have noticed this comment in my configuration output:</p><pre class="language-text"><code class="language-text">; "npm config ls -l" to show all defaults.</code></pre><p>In other words, instead of <code>npm config list</code> you can use <code>npm config ls</code>. Likewise, I could have used <code>npm config rm</code> instead of <code>npm config delete</code>.</p><p>And what about this configuration setting (which has nothing to do with package scopes or registries)?</p><pre class="language-text"><code class="language-text">depth = 0</code></pre><p>It just tells <code>npm</code> that when it's showing me information on packages and their dependencies, don't display any levels of package hierarchy in the output, as I usually just want to see the top level package information.</p><p>For example, I can easily see which packages I've installed globally, like this:</p><pre class="language-shell"><code class="language-shell">▶ <span class="token function">npm</span> list <span class="token parameter variable">--global</span><br>/Users/i347491/.nvm/versions/node/v12.18.0/lib<br>├── @sap/cds-dk@1.8.5<br>├── katacoda-cli@0.0.20<br>├── mbt@1.0.14<br>└── npm@6.14.4</code></pre><p>Without this depth setting in my configuration, the output would be a complex hierarchy that is detailed but not what I'm usually looking for:</p><pre class="language-shell"><code class="language-shell">▶ <span class="token function">npm</span> list <span class="token parameter variable">--global</span><br>/Users/i347491/.nvm/versions/node/v12.18.0/lib<br>├─┬ @sap/cds-dk@1.8.5<br>│ ├─┬ @sap/cds@3.34.2<br>│ │ ├─┬ @sap/cds-compiler@1.26.2<br>│ │ │ ├── antlr4@4.7.1<br>│ │ │ ├─┬ resolve@1.8.1<br>│ │ │ │ └── path-parse@1.0.6<br>│ │ │ └── sax@1.2.4 deduped<br>│ │ ├── @sap/cds-foss@1.2.0 deduped<br>│ │ ├── @sap/cds-reflect@2.11.0<br>│ │ └─┬ @sap/cds-runtime@1.2.2<br>│ │   ├─┬ @sap-cloud-sdk/core@1.18.1<br>│ │   │ ├─┬ @sap-cloud-sdk/analytics@1.19.0<br>│ │   │ │ ├── @sap-cloud-sdk/util@1.19.0 deduped<br>│ │   │ │ └── axios@0.19.2 deduped<br>│ │   │ ├─┬ @sap-cloud-sdk/util@1.19.0<br>│ │   │ │ ├── chalk@3.0.0 deduped<br>│ │   │ │ ├── rambda@5.1.1<br><br><span class="token punctuation">[</span><span class="token punctuation">..</span>. and another <span class="token number">2600</span>+ lines<span class="token operator">!</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span></code></pre><p>(It's rather pleasing to notice the use of the <a href="https://www.npmjs.com/package/rambda">Rambda</a> package here in the SAP Cloud SDK - but that's a story for another time :-))</p><p><a href="https://hitchhikers.fandom.com/wiki/Share_and_Enjoy">Share &amp; enjoy!</a></p><h2>Updates</h2><p>21 Oct 2021 The official retirement date for <code>npm.sap.com</code> is 28 Feb 2022. See <a href="https://launchpad.support.sap.com/#/notes/3109201">Note 3109201</a> for details.</p><hr><p><a href="https://community.sap.com/t5/application-development-blog-posts/sap-npm-packages-now-on-npmjs-org/ba-p/13463459">Originally published on SAP Community</a></p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/sapcommunity/">#sapcommunity</a> <a href="/tags/npm/">#npm</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2020/07/20/in-an-mta.yaml-file-you-can-use-the-service-name-parameter-to-point-to-an-existing-resource/"><span>←</span> <span>In an mta.yaml file you can use the service-name parameter to point to an existing resource</span> </a><a href="/blog/posts/2020/06/20/removing-the-knob-on-a-la-pavoni-steam-valve/"><span>Removing the knob on a La Pavoni steam valve</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="/tweets/">Tweet Archive</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a rel="me" href="https://bsky.app/profile/qmacro.org" target="_blank" rel="noopener noreferrer">Bluesky</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>