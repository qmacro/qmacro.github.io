<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>More Untappd data explorations with jq - my top ranking beer types (part 1)</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="more-untappd-data-explorations-with-jq-my-top-ranking-beer-types-part-1">More Untappd data explorations with jq - my top ranking beer types (part 1)</h1>

<ul class="post-metadata">
	<li><time datetime="2022-10-30">30 October 2022</time></li>
	<li><a href="/tags/jq-series-top-beer-types/" class="post-tag">jq-series-top-beer-types</a>, </li>
	<li><a href="/tags/untappd/" class="post-tag">untappd</a>, </li>
	<li><a href="/tags/jq/" class="post-tag">jq</a>, </li>
	<li><a href="/tags/beer/" class="post-tag">beer</a></li>
</ul>

<p class="post-description-main"></p>

<p>I've been exploring my Untappd data a bit more since <a href="/blog/posts/2022/10/28/untappd-data-with-jq-my-top-brewery-countries/">analysing my top brewery countries</a>, this time to see if my average ratings indicated anything about my preferred beer types. Here's what I've done so far, in part 1 of this little series.</p>
<p><a href="https://untappd.com/user/qmacro/checkin/658678850"><img src="/images/2022/10/dogfishhead-checkin.png" alt="a 5 star rating to a checkin of Dogfishhead's 90 Minute Imperial IPA"></a></p>
<p>Near the start of the previous post <a href="https://qmacro.org/blog/posts/2022/10/28/untappd-data-with-jq-my-top-brewery-countries/">Untappd data with jq - my top brewery countries</a> there's an example of a checkin object; here are some of the properties:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"beer_name"</span><span class="token operator">:</span> <span class="token string">"Leffe Brune / Bruin"</span><span class="token punctuation">,</span>
  <span class="token property">"brewery_name"</span><span class="token operator">:</span> <span class="token string">"Abbaye de Leffe"</span><span class="token punctuation">,</span>
  <span class="token property">"beer_type"</span><span class="token operator">:</span> <span class="token string">"Brown Ale - Belgian"</span><span class="token punctuation">,</span>
  <span class="token property">"rating_score"</span><span class="token operator">:</span> <span class="token string">"5"</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="what-are-the-beer-types">What are the beer types?</h2>
<p>I wanted to know how (if at all) my rating was affected by my particular preferences on beer types. I started looking at what types existed in my checkin data. First, how many are we talking about here?</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token operator">&lt;</span> checkins.json jq <span class="token string">'
map(.beer_type) | unique | length
'</span></code></pre>
<p>Wow, there are quite a few:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token number">177</span></code></pre>
<p>Let's have a look at the first 20:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token operator">&lt;</span> checkins.json jq <span class="token string">'
map(.beer_type) | unique[:20]
'</span></code></pre>
<blockquote>
<p>The <a href="https://stedolan.github.io/jq/manual/#unique,unique_by(path_exp)">unique</a> function produces a sorted list as well as removing duplicates.</p>
</blockquote>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"Altbier"</span><span class="token punctuation">,</span>
  <span class="token string">"Barleywine - American"</span><span class="token punctuation">,</span>
  <span class="token string">"Barleywine - English"</span><span class="token punctuation">,</span>
  <span class="token string">"Barleywine - Other"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Blonde"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Dubbel"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Quadrupel"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Strong Dark Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Strong Golden Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Tripel"</span><span class="token punctuation">,</span>
  <span class="token string">"Bitter - Best"</span><span class="token punctuation">,</span>
  <span class="token string">"Bitter - Extra Special / Strong (ESB)"</span><span class="token punctuation">,</span>
  <span class="token string">"Bitter - Session / Ordinary"</span><span class="token punctuation">,</span>
  <span class="token string">"Bière de Champagne / Bière Brut"</span><span class="token punctuation">,</span>
  <span class="token string">"Black &amp; Tan"</span><span class="token punctuation">,</span>
  <span class="token string">"Blonde Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Bock - Doppelbock"</span><span class="token punctuation">,</span>
  <span class="token string">"Bock - Eisbock"</span><span class="token punctuation">,</span>
  <span class="token string">"Bock - Hell / Maibock / Lentebock"</span><span class="token punctuation">,</span>
  <span class="token string">"Bock - Single / Traditional"</span>
<span class="token punctuation">]</span></code></pre>
<p>OK so there are quite a few.</p>
<h2 id="reducing-the-number-of-types">Reducing the number of types</h2>
<p>I might be able to be a little less granular if I just take whatever comes before the dash, if there is one. That would, for example, group together all the Bock types, and, for another example, all the IPAs, of which there are quite a few:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token operator">&lt;</span> checkins.json jq <span class="token string">'
map(.beer_type|select(startswith("IPA -"))) | unique
'</span></code></pre>
<p>As you can see:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"IPA - American"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Belgian"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Black / Cascadian Dark Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Brett"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Brut"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Cold"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - English"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Farmhouse"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Imperial / Double"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Imperial / Double Black"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Imperial / Double Milkshake"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Imperial / Double New England / Hazy"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Milkshake"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - New England / Hazy"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - New Zealand"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Other"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Red"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Rye"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Session"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Sour"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Triple"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - Triple New England / Hazy"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA - White / Wheat"</span>
<span class="token punctuation">]</span></code></pre>
<p>So if I call the part before any dash the &quot;major&quot; type, how many of those are there? Hopefully fewer than 177. Let's work it out:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token operator">&lt;</span> checkins.json jq <span class="token string">'
map(.beer_type|split(" -")|first) | unique | length, .
'</span></code></pre>
<blockquote>
<p>Hold on though, what if a <code>beer_type</code> value doesn't have a dash? What will calling <code>split(&quot; -&quot;)</code> do here? Let's see:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token parameter variable">-n</span> <span class="token string">'
["Major - minor", "Some other type"] | map(split(" -")|first)
'</span></code></pre>
<p>(The <code>-n</code> option tells <code>jq</code> to use <code>null</code> as the single input value, effectively telling <code>jq</code> not to expect any JSON to be fed in).</p>
<p>This gives:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"Major"</span><span class="token punctuation">,</span>
  <span class="token string">"Some other type"</span>
<span class="token punctuation">]</span></code></pre>
<p>This is what we want to happen.</p>
</blockquote>
<p>OK, let's run the filter, which gives:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token number">62</span>
<span class="token punctuation">[</span>
  <span class="token string">"Altbier"</span><span class="token punctuation">,</span>
  <span class="token string">"Barleywine"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Blonde"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Dubbel"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Quadrupel"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Strong Dark Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Strong Golden Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Belgian Tripel"</span><span class="token punctuation">,</span>
  <span class="token string">"Bitter"</span><span class="token punctuation">,</span>
  <span class="token string">"Bière de Champagne / Bière Brut"</span><span class="token punctuation">,</span>
  <span class="token string">"Black &amp; Tan"</span><span class="token punctuation">,</span>
  <span class="token string">"Blonde Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Bock"</span><span class="token punctuation">,</span>
  <span class="token string">"Brett Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Brown Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"California Common"</span><span class="token punctuation">,</span>
  <span class="token string">"Chilli / Chile Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Cider"</span><span class="token punctuation">,</span>
  <span class="token string">"Cream Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Dark Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Farmhouse Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Freeze-Distilled Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Fruit Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Gluten-Free"</span><span class="token punctuation">,</span>
  <span class="token string">"Golden Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Grape Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Historical Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Honey Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"IPA"</span><span class="token punctuation">,</span>
  <span class="token string">"Kellerbier / Zwickelbier"</span><span class="token punctuation">,</span>
  <span class="token string">"Kölsch"</span><span class="token punctuation">,</span>
  <span class="token string">"Lager"</span><span class="token punctuation">,</span>
  <span class="token string">"Lambic"</span><span class="token punctuation">,</span>
  <span class="token string">"Mead"</span><span class="token punctuation">,</span>
  <span class="token string">"Mild"</span><span class="token punctuation">,</span>
  <span class="token string">"Märzen"</span><span class="token punctuation">,</span>
  <span class="token string">"Old Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Pale Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Pilsner"</span><span class="token punctuation">,</span>
  <span class="token string">"Porter"</span><span class="token punctuation">,</span>
  <span class="token string">"Rauchbier"</span><span class="token punctuation">,</span>
  <span class="token string">"Red Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Roggenbier"</span><span class="token punctuation">,</span>
  <span class="token string">"Rye Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Rye Wine"</span><span class="token punctuation">,</span>
  <span class="token string">"Schwarzbier"</span><span class="token punctuation">,</span>
  <span class="token string">"Scotch Ale / Wee Heavy"</span><span class="token punctuation">,</span>
  <span class="token string">"Scottish Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Scottish Export Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Shandy / Radler"</span><span class="token punctuation">,</span>
  <span class="token string">"Smoked Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Sour"</span><span class="token punctuation">,</span>
  <span class="token string">"Specialty Grain"</span><span class="token punctuation">,</span>
  <span class="token string">"Spiced / Herbed Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Stout"</span><span class="token punctuation">,</span>
  <span class="token string">"Strong Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Table Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Traditional Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Wheat Beer"</span><span class="token punctuation">,</span>
  <span class="token string">"Wild Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Winter Ale"</span><span class="token punctuation">,</span>
  <span class="token string">"Winter Warmer"</span>
<span class="token punctuation">]</span></code></pre>
<blockquote>
<p>Note there are two JSON values - a scalar (62) and an array. I wanted the count, as well as all the names of the major types, and that's what was produced, as you can see, from <code>length</code> and <code>.</code> respectively. The interesting thing to note is that in the last part of the filter, <em>both</em> <code>length</code> and <code>.</code> were passed the output from the preceding expression (the output from <code>unique</code>); there was no need for any variable binding or explicit value passing.</p>
</blockquote>
<h2 id="encoding-a-function">Encoding a function</h2>
<p>That &quot;major type&quot; thing is something I'll likely use again, so it's worth considering creating a function for it.</p>
<blockquote>
<p>From now on, I'll stop showing the entire command line invocation (passing the file contents to <code>jq</code>, and specifying the filter in single quotes, also on the command line) and show just the <code>jq</code> expressions instead. That's mostly because I can then get it formatted a little nicer in these posts (with a bit of colour that's sensitive to <code>jq</code>'s syntax). I'll create a file <code>untappd.jq</code> to hold the <code>jq</code> expressions, so you just need to imagine that the invocations now look like this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token operator">&lt;</span> checkins.json jq <span class="token parameter variable">-f</span> untappd.jq </code></pre>
</blockquote>
<p>The function is very simple and just encapsulates what we've done already, which is then replaced with a call to that function:</p>
<pre class="language-jq" tabindex="0"><code class="language-jq"><span class="token keyword">def</span> <span class="token function">category</span><span class="token punctuation">:</span> <span class="token c-style-function function">split</span><span class="token punctuation">(</span><span class="token string">" -"</span><span class="token punctuation">)</span> <span class="token operator pipe">|</span> first<span class="token punctuation">;</span>

<span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token punctuation">.</span>beer_type<span class="token operator pipe">|</span>category<span class="token punctuation">)</span> <span class="token operator pipe">|</span> unique <span class="token operator pipe">|</span> length<span class="token punctuation">,</span> <span class="token dot important">.</span></code></pre>
<p>I wasn't fond of the name &quot;major_type&quot; for the function, so I've come up with the name &quot;category&quot; instead.</p>
<h2 id="whats-next">What's next</h2>
<p>That's the end of part 1. It looks like I have a manageable set of major beer types (categories) to use as a basis for this analysis. I've also got the feeling that the <code>jq</code> that I'll end up writing might be more than a few lines' worth, so I'm glad I've made the switch away from a &quot;one-liner&quot; to a file based filter.</p>
<p>In <a href="/blog/posts/2022/10/31/more-untappd-data-explorations-with-jq-my-top-ranking-beer-types-(part-2)/">part 2</a> I look at collecting my ratings across all the checkins, ready for averaging them by category.</p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2022/10/28/untappd-data-with-jq-my-top-brewery-countries/">Untappd data with jq - my top brewery countries</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2022/10/31/stop-asking-for-slides-in-advance/">Stop asking for slides in advance</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2022/10/30/more-untappd-data-explorations-with-jq-my-top-ranking-beer-types-part-1/` was built on 2025-10-10T07:26:34.761Z -->
		<script type="module" src="/dist/R1izrEYWYW.js"></script>
	</body>
</html>
