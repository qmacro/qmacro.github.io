<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Exploring GitHub repo name distribution with jq</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">

      <meta property="og:title" content="Exploring GitHub repo name distribution with jq">
        <meta property="og:site_name" content="DJ Adams">
          <meta property="og:image" content="/images/site-image.png">
        <meta property="og:description" content="Reserving the right to be wrong.">
        <meta property="og:url" content="https://qmacro.org/blog/posts/2022/05/07/exploring-github-repo-name-distribution-with-jq/">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-word;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="exploring-github-repo-name-distribution-with-jq">Exploring GitHub repo name distribution with jq</h1>

<ul class="post-metadata">
	<li><time datetime="2022-05-07">07 May 2022</time></li>
	<li><a href="/tags/jq/" class="post-tag">jq</a>, </li>
	<li><a href="/tags/github/" class="post-tag">github</a>, </li>
	<li><a href="/tags/gh/" class="post-tag">gh</a></li>
</ul>

<p class="post-description-main"></p>

<p>I wanted a brief rundown of the name prefixes for repositories in the <a href="https://github.com/SAP-samples">SAP-samples</a> organisation on GitHub. With the <code>gh</code> CLI it was easy to grab the names, and gave me the opportunity to practise a bit of <code>jq</code>. Here's what I did.</p>
<p>The <a href="https://github.com/SAP-samples">SAP-samples</a> organisation on GitHub is where we keep lots of sample code, configuration and more for various SAP services and products. We also store our workshop and CodeJam material in repositories there too.</p>
<p>There's a sort of loose naming convention, where the first part of the name gives a general indication of topic. For example, the first part of the <a href="https://github.com/SAP-samples/cloud-messaging-handsonsapdev">cloud-messaging-handsonsapdev</a> repository, &quot;cloud&quot;, gives an indication that the topic is the cloud in general, and the first part of the <a href="https://github.com/SAP-samples/btp-setup-automator">btp-setup-automator</a> repository, &quot;btp&quot;, indicates that the main topic is the SAP Business Technology Platform.</p>
<p>I wanted to find out what the names were of all the repositories in the <a href="https://github.com/SAP-samples">SAP-samples</a> organisation, and understand the distribution across the different topics. Something like this, showing here that the most popular topic is &quot;cloud&quot;:</p>
<pre class="language-text" tabindex="0"><code class="language-text">1    abap
1    artifact
2    btp
3    cloud
2    sap
1    ui5</code></pre>
<h2 id="using-the-gh-cli">Using the gh CLI</h2>
<p>Requesting the names of public repositories with the GitHub CLI <a href="https://github.com/cli/cli">gh</a> is easy. Here's an example:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">gh repo list SAP-samples <span class="token parameter variable">--limit</span> <span class="token number">10</span> <span class="token parameter variable">--public</span></code></pre>
<p>This produces output something like this (output somewhat redacted for display purposes):</p>
<pre class="language-text" tabindex="0"><code class="language-text">SAP-samples/cloud-sdk-js                   This re...  public  7h
SAP-samples/cloud-cap-samples-java         A sampl...  public  15h
SAP-samples/btp-setup-automator            Automat...  public  15h
SAP-samples/btp-ai-sustainability-bootcamp This gi...  public  15h
SAP-samples/cloud-cap-samples              This pr...  public  17h
SAP-samples/ui5-exercises-codejam          Materia...  public  19h
SAP-samples/cap-sflight                    Using S...  public  1d
SAP-samples/cloud-cf-feature-flags-sample  A sampl...  public  1d
SAP-samples/cloud-espm-cloud-native        Enterpr...  public  2d
SAP-samples/iot-edge-samples               Showcas...  public  2d</code></pre>
<blockquote>
<p>This is a slightly contrived example, because I wanted to illustrate the distribution over a small number of repositories (10 in this case). To this end, I cut down the actual output to come up with a list of repositories that would illustrate the point. If you want to find out what I did with this list, and how I turned it into what <code>gh</code> would output, in particular what JSON structure it would produce (see the next section in this post), you may want to read the &quot;prequel&quot; post to this one: <a href="/blog/posts/2022/05/06/converting-strings-to-objects-with-jq/">Converting strings to objects with jq</a>.</p>
</blockquote>
<p>With regular shell tools I could parse out the names, split off the topic prefix, and go from there. But I'm trying to improve my skills in <a href="https://stedolan.github.io/jq/">jq</a>, and the <code>gh</code> CLI gives me an opportunity to do that, with the combination of two options.</p>
<h3 id="requesting-json-output-with-json">Requesting JSON output with --json</h3>
<p>With <code>--json</code> I can specify fields I want to have returned to me. At first I was at a loss as to which fields were available to specify, but leaving off the value for <code>--json</code> gives a list.</p>
<p>In other words, invoking this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">gh repo list <span class="token parameter variable">--json</span></code></pre>
<p>results in a list like this (cut short for brevity):</p>
<pre><code>Specify one or more comma-separated fields for `--json`:
  assignableUsers
  codeOfConduct
  contactLinks
  createdAt
  defaultBranchRef
  deleteBranchOnMerge
  description
  diskUsage
  forkCount
  ...
</code></pre>
<p>The field <code>name</code> is available, and applying it as the value for <code>--json</code> like this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">gh repo list SAP-samples <span class="token parameter variable">--limit</span> <span class="token number">10</span> <span class="token parameter variable">--public</span> <span class="token parameter variable">--json</span> name</code></pre>
<p>gives this JSON output:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-sdk-js"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-cap-samples-java"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"btp-setup-automator"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"btp-ai-sustainability-bootcamp"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-cap-samples"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ui5-exercises-codejam"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cap-sflight"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-cf-feature-flags-sample"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-espm-cloud-native"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"iot-edge-samples"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code></pre>
<h3 id="filtering-json-output-with-jq">Filtering JSON output with --jq</h3>
<p>With the <code>--jq</code> option, a jq filter can be supplied that will be applied to the JSON output produced. Let's start with a very simple example.</p>
<p>As we can see, the structure returned is an array of objects, each containing the property or properties requested with the <code>--json</code> option. So to obtain the value of each of the <code>name</code> properties from the JSON output that we saw earlier, we can use <code>.[] | .name</code>, or, more succinctly, <code>.[].name</code>:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">gh repo list SAP-samples <span class="token parameter variable">--limit</span> <span class="token number">10</span> <span class="token parameter variable">--public</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--json</span> name <span class="token punctuation">\</span>
  <span class="token parameter variable">--jq</span> .<span class="token punctuation">[</span><span class="token punctuation">]</span>.name</code></pre>
<p>This returns the following:</p>
<pre class="language-text" tabindex="0"><code class="language-text">artifact-of-the-month
cloud-sdk-js
sap-tech-bytes
cloud-cap-samples-java
btp-setup-automator
btp-ai-sustainability-bootcamp
sap-iot-samples
abap-platform-fundamentals-01
cloud-cap-samples
ui5-exercises-codejam</code></pre>
<h3 id="the-jq-option-in-gh-is-applied-with-raw-output">The --jq option in gh is applied with --raw-output</h3>
<p>We can make one side observation here. Normally, we'd expect to see JSON values output from <code>jq</code>; in other words, double-quoted strings like this:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token string">"artifact-of-the-month"</span>
<span class="token string">"cloud-sdk-js"</span>
<span class="token string">"sap-tech-bytes"</span>
<span class="token string">"cloud-cap-samples-java"</span>
<span class="token string">"btp-setup-automator"</span>
<span class="token string">"btp-ai-sustainability-bootcamp"</span>
<span class="token string">"sap-iot-samples"</span>
<span class="token string">"abap-platform-fundamentals-01"</span>
<span class="token string">"cloud-cap-samples"</span>
<span class="token string">"ui5-exercises-codejam"</span></code></pre>
<p>So it seems like when a <code>jq</code> filter is applied via the <code>--jq</code> option to <code>gh</code>, it's applied with the <code>--raw-output</code> (<code>-r</code>) option implicitly. I think that makes sense, especially if the output is to be used with other Unix command line tools later on in a pipeline.</p>
<h2 id="using-the-power-of-jq">Using the power of jq</h2>
<p>Now we have the context in which we can invoke a jq filter on the JSON output from <code>gh</code>, let's dig in a little more. Bear in mind that this may not be the most efficient way of doing things, but I thought it might still be useful, and it certainly helps me to try to express something in jq in public, as it were.</p>
<p>To be kind to the API, I'll grab the JSON output from the <code>gh</code> invocation and use that while I build up the filter:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">gh repo list SAP-samples <span class="token parameter variable">--limit</span> <span class="token number">10</span> <span class="token parameter variable">--public</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--json</span> name <span class="token punctuation">\</span>
  <span class="token operator">></span> names.json</code></pre>
<p>As a reminder, the content of <code>names.json</code> will look like this:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-sdk-js"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-cap-samples-java"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"btp-setup-automator"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"btp-ai-sustainability-bootcamp"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-cap-samples"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ui5-exercises-codejam"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cap-sflight"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-cf-feature-flags-sample"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"cloud-espm-cloud-native"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"iot-edge-samples"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code></pre>
<h3 id="get-the-first-part-of-the-name">Get the first part of the name</h3>
<p>The convention is to use dashes to separate the different parts of the repository names, so it occurs to me that I can use <a href="https://stedolan.github.io/jq/manual/#split(str)">split</a>, which produces an array, and then grab the first element.</p>
<p>Let's have a first go, based on the <code>name</code> property access we saw earlier:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token string">'.[].name | split("-") | .[0]'</span> names.json</code></pre>
<p>This produces the following list:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token string">"artifact"</span>
<span class="token string">"cloud"</span>
<span class="token string">"sap"</span>
<span class="token string">"cloud"</span>
<span class="token string">"btp"</span>
<span class="token string">"btp"</span>
<span class="token string">"sap"</span>
<span class="token string">"abap"</span>
<span class="token string">"cloud"</span>
<span class="token string">"ui5"</span></code></pre>
<h3 id="stay-within-the-context-of-an-array">Stay within the context of an array</h3>
<p>In jq, there are plenty of functions that operate on arrays, such as <a href="https://stedolan.github.io/jq/manual/#sort,sort_by(path_expression)">sort</a>, <a href="https://stedolan.github.io/jq/manual/#min,max,min_by(path_exp),max_by(path_exp)">min and max</a> and <a href="https://stedolan.github.io/jq/manual/#reverse">reverse</a>. There's also <a href="https://stedolan.github.io/jq/manual/#group_by(path_expression)">group-by</a> which is what will be useful to our requirements here. The manual's description is as follows:</p>
<blockquote>
<p><code>group_by(.foo)</code> takes as input an array, groups the elements having the same <code>.foo</code> field into separate arrays, and produces all of these arrays as elements of a larger array, sorted by the value of the <code>.foo</code> field.</p>
</blockquote>
<p>We're starting from an array (note the outer enclosing <code>[...]</code> in the data we're working on) so it makes sense to try to keep that array context. So rather than use the <a href="https://stedolan.github.io/jq/manual/#Array/ObjectValueIterator:.%5B%5D">array / object iterator</a>, which &quot;explodes&quot; an array into separate results, we can use <a href="https://stedolan.github.io/jq/manual/#map(x),map_values(x)">map</a> here:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token string">'map(.name | split("-") | .[0])'</span> names.json</code></pre>
<p>This produces the same values, but within an array:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"artifact"</span><span class="token punctuation">,</span>
  <span class="token string">"cloud"</span><span class="token punctuation">,</span>
  <span class="token string">"sap"</span><span class="token punctuation">,</span>
  <span class="token string">"cloud"</span><span class="token punctuation">,</span>
  <span class="token string">"btp"</span><span class="token punctuation">,</span>
  <span class="token string">"btp"</span><span class="token punctuation">,</span>
  <span class="token string">"sap"</span><span class="token punctuation">,</span>
  <span class="token string">"abap"</span><span class="token punctuation">,</span>
  <span class="token string">"cloud"</span><span class="token punctuation">,</span>
  <span class="token string">"ui5"</span>
<span class="token punctuation">]</span></code></pre>
<h3 id="using-group-by">Using group_by</h3>
<p>Now we can use <a href="https://stedolan.github.io/jq/manual/#group_by(path_expression)">group-by</a> on this (switching here to a multi-line version for better readability):</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token punctuation">\</span>
  <span class="token string">'map(.name | split("-") | .[0])
  | group_by(.)'</span> <span class="token punctuation">\</span>
  names.json</code></pre>
<p>This seems to &quot;<a href="https://en.wikipedia.org/wiki/Does_exactly_what_it_says_on_the_tin#:~:text=%22It%20does%20exactly%20what%20it,accurate%20description%20of%20its%20qualities.">do exactly what it says on the tin</a>&quot;:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">[</span>
    <span class="token string">"abap"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"artifact"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"btp"</span><span class="token punctuation">,</span>
    <span class="token string">"btp"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"cloud"</span><span class="token punctuation">,</span>
    <span class="token string">"cloud"</span><span class="token punctuation">,</span>
    <span class="token string">"cloud"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"sap"</span><span class="token punctuation">,</span>
    <span class="token string">"sap"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">"ui5"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">]</span></code></pre>
<p>Note that the value passed to <code>group_by</code> is <code>.</code>, i.e. the <code>path_expression</code> is the entire string value, for example <code>&quot;artifact&quot;</code>, <code>&quot;cloud&quot;</code>, <code>&quot;sap&quot;</code> etc.</p>
<p>Great. We can already start to see the distribution of topics now, but let's go a bit further.</p>
<h3 id="creating-a-list-of-topic-counts">Creating a list of topic counts</h3>
<p>I think ideally I'd like a flat list of topics with their counts, in a tab-separated list, as that is then conducive to further processing on the command line should I want to. In other words, I want this sort of line for each topic:</p>
<pre><code>[count][tab][topic-name]
</code></pre>
<h3 id="producing-the-raw-data">Producing the raw data</h3>
<p>First, let's produce the raw data for this list. While we wanted to avoid exploding the array earlier, now would be the time to use the <a href="https://stedolan.github.io/jq/manual/#Array/ObjectValueIterator:.%5B%5D">array / object iterator</a>:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token punctuation">\</span>
  <span class="token string">'map(.name | split("-") | .[0])
  | group_by(.)
  | .[]'</span> <span class="token punctuation">\</span>
  names.json</code></pre>
<p>This produces a JSON value for each of the array items. Here, each item, and thus value produces, is an array containing one or more instances of a topic name:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token string">"abap"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token string">"artifact"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token string">"btp"</span><span class="token punctuation">,</span>
  <span class="token string">"btp"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token string">"cloud"</span><span class="token punctuation">,</span>
  <span class="token string">"cloud"</span><span class="token punctuation">,</span>
  <span class="token string">"cloud"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token string">"sap"</span><span class="token punctuation">,</span>
  <span class="token string">"sap"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token string">"ui5"</span>
<span class="token punctuation">]</span></code></pre>
<p>In effect, this removes the outermost <code>[...]</code> array that contains all these inner arrays.</p>
<p>Now it's just a matter of defining what we want to see, with the <a href="https://stedolan.github.io/jq/manual/#Arrayconstruction:%5B%5D">array constructor</a>, in this case, two elements representing the length of the array, and the first value of the array <code>[length, .[0]]</code>:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token punctuation">\</span>
  <span class="token string">'map(.name | split("-") | .[0])
  | group_by(.)
  | .[]
  | [length, .[0]]'</span> <span class="token punctuation">\</span>
  names.json</code></pre>
<p>Remember that this construct <code>.[] | ...</code> will iterate through each array element and pass them one at a time to the filter that follows the pipe. And this produces the following:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">"abap"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">"artifact"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">"btp"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token string">"cloud"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">"sap"</span>
<span class="token punctuation">]</span>
<span class="token punctuation">[</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">"ui5"</span>
<span class="token punctuation">]</span></code></pre>
<h3 id="output-the-results-as-a-tab-separated-list">Output the results as a tab-separated list</h3>
<p>We have our list of topic counts, so now let's add the final touch to have a tab-separated list. There's nothing further we need to do to the data, it's as we want it. So we just need some formatting. In the <a href="https://stedolan.github.io/jq/manual/#Formatstringsandescaping">Format strings and escaping</a> section of the jq manual, we see that there's the <code>@tsv</code> which is described thus:</p>
<blockquote>
<p>The input must be an array, and it is rendered as TSV (tab-separated values). Each input array will be printed as a single line.</p>
</blockquote>
<p>This is exactly what we're looking for. Note that here, the &quot;input array&quot; referred to is each of the individual arrays in the output above, i.e. this is the first array:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">"abap"</span>
<span class="token punctuation">]</span></code></pre>
<p>Let's try it:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token punctuation">\</span>
  <span class="token string">'map(.name | split("-") | .[0])
  | group_by(.)
  | .[]
  | [length, .[0]]
  | @tsv'</span> <span class="token punctuation">\</span>
  names.json</code></pre>
<pre class="language-text" tabindex="0"><code class="language-text">"1\tabap"
"1\tartifact"
"2\tbtp"
"3\tcloud"
"2\tsap"
"1\tui5"</code></pre>
<p>Close! Remember that by default, an invocation of <code>jq</code> on the command line will output JSON values by default. These strings are JSON values. But here we want the raw form, via the <code>--raw-output</code> (<code>-r</code>), to benefit from (and see) the tab characters (<code>\t</code>) that the <code>@tsv</code> has put in for us:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">jq <span class="token parameter variable">-r</span> <span class="token punctuation">\</span>
  <span class="token string">'map(.name | split("-") | .[0])
  | group_by(.)
  | .[]
  | [length, .[0]]
  | @tsv'</span> <span class="token punctuation">\</span>
  names.json</code></pre>
<p>This gives us what we're looking for:</p>
<pre class="language-text" tabindex="0"><code class="language-text">1    abap
1    artifact
2    btp
3    cloud
2    sap
1    ui5</code></pre>
<p>And in fact, remembering that when a jq filter is invoked from <code>gh</code> via the <code>--jq</code> option the raw output is used by default, we can now put everything together and benefit from that in the final <code>gh</code> invocation, which looks like this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">gh repo list SAP-samples <span class="token parameter variable">--limit</span> <span class="token number">10</span> <span class="token parameter variable">--public</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--json</span> name <span class="token punctuation">\</span>
  <span class="token parameter variable">--jq</span> <span class="token punctuation">\</span>
  <span class="token string">'map(.name | split("-") | .[0])
   | group_by(.)
   | .[]
   | [length, .[0]]
   | @tsv'</span></code></pre>
<p>This gives us the same result, i.e.:</p>
<pre class="language-text" tabindex="0"><code class="language-text">1    abap
1    artifact
2    btp
3    cloud
2    sap
1    ui5</code></pre>
<p>So I can see that the most common topic here is &quot;cloud&quot;.</p>
<h2 id="wrapping-up">Wrapping up</h2>
<p>I'm happy with this approach, how I'm starting to get a better feel for how data flows through a jq filter, and also that I can use such filters with the GitHub CLI.</p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2022/05/06/converting-strings-to-objects-with-jq/">Converting strings to objects with jq</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2022/05/19/json-object-values-into-csv-with-jq/">JSON object values into CSV with jq</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2022/05/07/exploring-github-repo-name-distribution-with-jq/` was built on 2026-02-04T13:49:18.732Z -->
		<script type="module" src="/dist/t-8sxMV3B9.js"></script>
	</body>
</html>
