<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2022/05/21/exploring-json-with-interactive-jq/"><link href="/assets/main.f502db4e74c7edd25353.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Exploring JSON with interactive jq | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Exploring JSON with interactive jq"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2022/05/21/exploring-json-with-interactive-jq/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@qmacro"><meta name="description" content="Exploring JSON with interactive jq 21 May 2022 | 2 min read I often use ijq, or &amp;quot;interactive jq&amp;quot;, to explore JSON, and also to..."><meta property="og:description" content="Exploring JSON with interactive jq 21 May 2022 | 2 min read I often use ijq, or &amp;quot;interactive jq&amp;quot;, to explore JSON, and also to..."><meta name="description" content="Exploring JSON with interactive jq 21 May 2022 | 2 min read I often use ijq, or &amp;quot;interactive jq&amp;quot;, to explore JSON, and also to..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><meta name="twitter:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/talks">Talks</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Exploring JSON with interactive jq</h1><div class="post__details"><time datetime="2022-05-21">21 May 2022 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p>I often use ijq, or &quot;interactive jq&quot;, to explore JSON, and also to improve my jq fu, because it gives me immediate visual feedback. Here's an example.</p><p>There's a wrapper around <code>jq</code> called <a href="https://sr.ht/~gpanders/ijq/">ijq</a> (short for &quot;interactive jq&quot;) which is a bit like a REPL in that it affords immediate feedback. It's a lovely program, and I use it a lot.</p><p>Yesterday I <a href="https://twitter.com/qmacro/status/1527678770454331392">shared a short video</a> of an example of how it can be used to explore a JSON dataset and I thought I'd give that example a more permanent home here on the blog.</p><p><img src="/images/2022/05/ijq.gif" alt="ijq in action"></p><p>(There's an <a href="https://asciinema.org/a/496082">asciinema version of this</a> too).</p><p>In practising a little <code>jq</code>, I thought I'd use it to find out the most common city in the <a href="https://services.odata.org/v4/northwind/northwind.svc/Customer_and_Suppliers_by_Cities">Customers and Suppliers by Cities</a> entityset in the V4 Northwind service.</p><p>This is the invocation I ended up with:</p><pre class="language-jq"><code class="language-jq"><span class="token punctuation">.</span>value<br><span class="token operator pipe">|</span> <span class="token c-style-function function">group_by</span><span class="token punctuation">(</span><span class="token punctuation">.</span>City<span class="token punctuation">)</span><br><span class="token operator pipe">|</span> <span class="token c-style-function function">map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>length<span class="token punctuation">,</span> first<span class="token punctuation">.</span>City<span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token operator pipe">|</span> <span class="token c-style-function function">sort_by</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token operator pipe">|</span> reverse<br><span class="token operator pipe">|</span> first<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></code></pre><p>Here's a brief breakdown of the invocation I ended up with:</p><ul><li><code>.value</code> gives me the entire array of objects in the dataset, each one of which represents a customer or supplier in a city</li><li><code>group_by(...)</code> collects array elements together that have the same path expression specified (in this case the <code>City</code> property), producing an array of arrays</li><li><code>map(...)</code> is much like <code>map</code> in other languages, in that it will apply the function or filter given to the input array, producing a new array</li><li><code>[length, first.City]</code> uses the array constructor (<code>[...]</code>) to produce an array of two elements, the first being the length of the input (the inner array containing the same-city grouped objects) and the value of the <code>City</code> property for the <code>first</code> element in that array*</li><li><code>sort_by(...)</code> sorts the input array (which is now the one with length-and-city name elements) by the first item (<code>.[0]</code>), i.e. by the length</li><li><code>reverse</code> simply reverses the order of the items of the array</li><li><code>first[1]</code> then this picks the second item (<code>[1]</code>) of the first element, which after the reverse-sort will be the length-and-city pair with the highest length</li></ul><p>*during the interactive session, I'd just guessed that there would be a <code>first</code> function, and there was!</p><p>For those of you wondering, I deliberately chose to reverse the list before picking out the first element, so the element would be at the top and therefore visible in <code>ijq</code>'s output window:</p><pre class="language-jq"><code class="language-jq"><span class="token operator pipe">|</span> <span class="token c-style-function function">sort_by</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token operator pipe">|</span> reverse<br><span class="token operator pipe">|</span> first<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></code></pre><p>But I could have just as well done this:</p><pre class="language-jq"><code class="language-jq"><span class="token operator pipe">|</span> <span class="token c-style-function function">sort_by</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token operator pipe">|</span> last<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></code></pre><p>As a kind fellow rightly pointed out in the comments to my previous post <a href="https://qmacro.org/blog/posts/2022/05/19/json-object-values-into-csv-with-jq/">JSON object values into CSV with jq</a> - TIMTOWTDI, or &quot;there is more than one way to do it&quot;, an adage from the Perl community.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/jq/">#jq</a> <a href="/tags/ijq/">#ijq</a> <a href="/tags/json/">#json</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2022/05/21/products-by-supplier-in-odata-and-jq/"><span>←</span> <span>Products by supplier in OData and jq</span> </a><a href="/blog/posts/2022/05/19/json-object-values-into-csv-with-jq/"><span>JSON object values into CSV with jq</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://twitter.com/qmacro" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a rel="me" href="https://mastodon.cloud/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>