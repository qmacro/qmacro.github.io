<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Bash notes 2</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">

      <meta property="og:title" content="Bash notes 2">
        <meta property="og:site_name" content="DJ Adams">
          <meta property="og:image" content="/images/site-image.png">
        <meta property="og:description" content="Reserving the right to be wrong.">
        <meta property="og:url" content="https://qmacro.org/blog/posts/2022/04/10/bash-notes-2/">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-word;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="bash-notes-2">Bash notes 2</h1>

<ul class="post-metadata">
	<li><time datetime="2022-04-10">10 April 2022</time></li>
	<li><a href="/tags/shell/" class="post-tag">shell</a>, </li>
	<li><a href="/tags/til/" class="post-tag">til</a>, </li>
	<li><a href="/tags/exercism/" class="post-tag">exercism</a></li>
</ul>

<p class="post-description-main"></p>

<p>I looked at a couple of more solutions to another Exercism exercise in the Bash track - <a href="https://exercism.org/tracks/bash/exercises/scrabble-score">Scrabble Score</a>. I was reminded of one particular feature of the <code>case</code> statement, and another solution was rather splendid in its approach and it reminded me a little of some functional programming techniques, or perhaps MapReduce.</p>
<p>I find <a href="https://exercism.org">Exercism</a> great for practice but get as much if not more pleasure and insight from reading the Community Solutions - solutions to exercises that others have completed.</p>
<p>My initial solution to the Scrabble Score exercise was a little pedestrian, which I find acceptable at least as the first iteration, as long as it works. That said, I had been trying to write my solution to reflect, almost visually, the instructions, the core of which was this table:</p>
<pre class="language-text" tabindex="0"><code class="language-text">Letter                           Value
A, E, I, O, U, L, N, R, S, T       1
D, G                               2
B, C, M, P                         3
F, H, V, W, Y                      4
K                                  5
J, X                               8
Q, Z                               10</code></pre>
<p>I'd ended up with this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token builtin class-name">declare</span> <span class="token assign-left variable">word</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${1<span class="token operator">^^</span>}</span>"</span>
<span class="token builtin class-name">declare</span> <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ${#word}<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"AEIOULNRST"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">))</span></span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"DG"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>         <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">))</span></span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"BCMP"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>       <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">))</span></span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"FHVWY"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>      <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">))</span></span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"K"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>          <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">))</span></span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"JX"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>         <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">))</span></span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"QZ"</span> <span class="token operator">=~</span> <span class="token variable">${word<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>         <span class="token operator">&amp;&amp;</span> <span class="token variable"><span class="token punctuation">((</span>score <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">))</span></span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$score</span>"</span></code></pre>
<p>It was ok, if not a little &quot;bulky&quot;.</p>
<p>In looking at other solutions, I came across one from user <a href="https://exercism.org/profiles/edwin0258">Devin Miller</a> which did what I'd been looking to achieve, but in a much neater way:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token assign-left variable">total</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">x</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $<span class="token punctuation">{</span><span class="token number">1</span>^^<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-o</span> <span class="token builtin class-name">.</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">case</span> <span class="token variable">$x</span> <span class="token keyword">in</span>
        <span class="token punctuation">[</span>AEIOULNRST<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>DG<span class="token punctuation">]</span><span class="token punctuation">)</span>         <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>BCMP<span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>FHVWY<span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        K<span class="token punctuation">)</span>            <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">+=</span><span class="token number">5</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span>JX<span class="token punctuation">]</span><span class="token punctuation">)</span>         <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        *<span class="token punctuation">)</span>            <span class="token variable"><span class="token punctuation">((</span>total<span class="token operator">+=</span><span class="token number">10</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">done</span></code></pre>
<p>I'd forgotten that the <code>case</code> statement allows for pattern matching. The <a href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_07_03.html">Simplified conditions section of the Bash Beginners Guide</a> states: &quot;Each case is an expression matching a pattern&quot;. What sort of pattern? Well, the Bash Manual explains, in <a href="https://www.gnu.org/software/bash/manual/html_node/Pattern-Matching.html#Pattern-Matching">section 3.5.8.1 on Pattern Matching</a>. In Devlin's solution here, the <code>[...]</code> construct is used for each case expression, which &quot;matches any of the enclosed characters&quot;. Of course! This makes for a much more concise way of expressing that scoring table. I think, for symmetry, I'd have used <code>((total+=1))</code> for the first case, just to match the rest, but there you go.</p>
<p>One note on the <a href="https://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html">command substitution</a> in the <code>for</code> line above. There's nothing in the rules that says that external commands, that would normally and perhaps naturally be part of any Bash script solution (after all, Bash scripts are great for encoding UNIX style constructs) so the use of the external <code>grep</code> command here is fine. And it's an interesting way to iterate through the letters of the word passed to the scoring script.</p>
<p>The secret is in the <code>-o</code> option, short for <code>--only-matching</code>, and the man page describes this option thus:</p>
<blockquote>
<p>Print only the matched (non-empty) parts of a matching line, with each such part on a separate output line.</p>
</blockquote>
<p>Before we look at that, note that the <code>${1^^}</code> <a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">parameter expansion</a> results in an uppercased version of the value in <code>$1</code>.</p>
<p>So if <code>$1</code> had the value <code>hello</code>, then the result of <code>echo ${1^^} | grep -o .</code> would be:</p>
<pre class="language-text" tabindex="0"><code class="language-text">H
E
L
L
O</code></pre>
<p>This feeds nicely into the <code>for ... in</code> style loop construct used. The effect, ultimately, is the same as the C-style for loop construct I used in my solution where I used a incrementing variable <code>i</code> to point to each letter of the word in turn, via the <code>${parameter:offset:length}</code> style of <a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">parameter expansion</a>.</p>
<p>I'd like to dwell briefly on <a href="https://exercism.org/tracks/bash/exercises/scrabble-score/solutions/kayhide">another solution to this exercise</a>, which looks like this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token builtin class-name">set</span> <span class="token parameter variable">-eu</span>
<span class="token function-name function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">local</span> <span class="token parameter variable">-l</span> <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token operator">:</span>alpha<span class="token operator">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span>}</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>aeioulnrst<span class="token punctuation">]</span><span class="token operator">/</span>_}</span>  <span class="token comment"># 1</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>dg<span class="token punctuation">]</span><span class="token operator">/</span>__}</span>         <span class="token comment"># 2</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>bcmp<span class="token punctuation">]</span><span class="token operator">/</span>___}</span>      <span class="token comment"># 3</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>fhvwy<span class="token punctuation">]</span><span class="token operator">/</span>____}</span>    <span class="token comment"># 4</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">/</span>_____}</span>       <span class="token comment"># 5</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>jx<span class="token punctuation">]</span><span class="token operator">/</span>________}</span>   <span class="token comment"># 8</span>
    <span class="token assign-left variable">str</span><span class="token operator">=</span><span class="token variable">${str<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">[</span>qz<span class="token punctuation">]</span><span class="token operator">/</span>__________}</span> <span class="token comment"># 10</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">#</span>str}</span>
<span class="token punctuation">}</span>
main <span class="token string">"<span class="token variable">$@</span>"</span></code></pre>
<p>This is a really interesting approach that appeals to my sense of beauty and intrigue - all the heavy lifting is done with the <code>${parameter/pattern/string}</code> style of <a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">parameter expansion</a>, specifically the one where all matches are replaced because the pattern actually begins with a <code>/</code> (i.e. it's <code>${str//[aeioulnrst]/_}</code> rather than <code>${str/[aeioulnrst]/_}</code>).</p>
<p>What is happening here is that after removing any characters that are not in the &quot;alphabetic&quot; POSIX class (see the POSIX Character Classes section of <a href="https://tldp.org/LDP/abs/html/x17129.html">18.1. A Brief Introduction to Regular Expressions</a>), the letters are replaced by underscores, where the number of underscores in the replacement reflects the points for that letter. So for example an <code>a</code> is replaced with <code>_</code> reflecting a single point for that letter, whereas an <code>f</code> is replaced with <code>____</code> reflecting four points for that letter. After all the replacements are done, the string is just a sequence of underscores, and how many underscores reflects the total number of points for that word (which is reflected in yet another style of parameter expansion, the length of a variable, via <code>${#parameter}</code>). Lovely!</p>
<p>I don't know about you, but this sort of reminds me of the underlying philosophy of <a href="https://en.wikipedia.org/wiki/MapReduce">MapReduce</a>, where the input is reduced to a sequence of simple, countable atoms - in this case, underscore characters. Given the &quot;sequence&quot; feeling that this solution also conveys, I think there's an element of FP philosophy too.</p>
<hr>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="/posts/2022-04-07-bash-notes-1/">Bash notes</a></li>
<li>Posts with the <a href="/tags/shell/">shell</a> tag</li>
</ul>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2022/04/07/bash-notes/">Bash notes</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2022/04/15/a-classic-example-of-yak-shaving-and-some-stream-editing/">A classic example of yak shaving, and some stream editing</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2022/04/10/bash-notes-2/` was built on 2026-01-13T13:33:33.982Z -->
		<script type="module" src="/dist/t-8sxMV3B9.js"></script>
	</body>
</html>
