<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Bash notes</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">

      <meta property="og:title" content="Bash notes">
        <meta property="og:site_name" content="DJ Adams">
          <meta property="og:image" content="/images/site-image.png">
        <meta property="og:description" content="Reserving the right to be wrong.">
        <meta property="og:url" content="https://qmacro.org/blog/posts/2022/04/07/bash-notes/">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="bash-notes">Bash notes</h1>

<ul class="post-metadata">
	<li><time datetime="2022-04-07">07 April 2022</time></li>
	<li><a href="/tags/shell/" class="post-tag">shell</a>, </li>
	<li><a href="/tags/til/" class="post-tag">til</a>, </li>
	<li><a href="/tags/exercism/" class="post-tag">exercism</a></li>
</ul>

<p class="post-description-main"></p>

<p>Here are a few things I learned, or re-learned, while reading through a neat solution to a Bash track exercise in Exercism.</p>
<!--excerpt-->
<p>I completed a very basic solution to the <a href="https://exercism.org/tracks/bash/exercises/proverb">Proverb exercise in the Bash track on Exercism</a> and proceeded to look at some of the solutions others had submitted. A <a href="https://exercism.org/tracks/bash/exercises/proverb/solutions/glennj">beautifully simple and succinct solution</a> from user <a href="https://exercism.org/profiles/glennj">Glenn Jackman</a> had the most stars, and I wanted to share a few things I learned from it.</p>
<p>Here is the latest iteration of this solution:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token shebang important">#!/usr/bin/env bash</span>

<span class="token comment"># There must be at least 2 positional parameters</span>
<span class="token comment"># to enter the loop:</span>
<span class="token comment">#   `i` initialized to 1</span>
<span class="token comment">#   `i &lt; $#` test passes only if 2 or more parameters</span>

<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> $# <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> j<span class="token operator">++</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"For want of a <span class="token variable">${<span class="token operator">!</span>i}</span> the <span class="token variable">${<span class="token operator">!</span>j}</span> was lost."</span>
<span class="token keyword">done</span>

<span class="token comment"># And at least one parameter to print this:</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">"And all for the want of a <span class="token variable">$1</span>."</span> <span class="token operator">||</span> <span class="token builtin class-name">:</span></code></pre>
<p>Here are three things I learned or re-learned.</p>
<h2 id="incrementing-multiple-variables-in-a-loop-construct">Incrementing multiple variables in a loop construct</h2>
<p>The <a href="https://tldp.org/LDP/abs/html/loops1.html">Loops and Branches chapter of the Advanced Bash Scripting Guide</a> has <a href="https://tldp.org/LDP/abs/html/loops1.html#FORLOOPC">examples of a C-style for loop</a> that uses double parentheses. The last of these examples, and what we see here in the script, shows that we can actually initialise and increment more than one variable inside the double parentheses construct. In other words, in this line:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> $# <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> j<span class="token operator">++</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span></code></pre>
<p>we have both <code>i</code> and <code>j</code> being initialised and then incremented. This is a really neat solution for maintaining more than one indices. In case you're wondering, the <code>$#</code> is the number of parameters passed to the script; each parameter is available via their position in variables like this: <code>$1</code>, <code>$2</code>, <code>$3</code> and so on (they're referred to as <a href="https://www.gnu.org/software/bash/manual/html_node/Positional-Parameters.html">positional parameters</a>). So if the invocation is <code>scriptname hello world</code> then <code>$1</code> is <code>hello</code> and <code>$2</code> is <code>world</code>.</p>
<h2 id="dynamic-reference-to-positional-parameters-with-indirect-expansion">Dynamic reference to positional parameters with indirect expansion</h2>
<p>So while you can refer to e.g. the second parameter with <code>$2</code>, what if you wanted to refer to the nth parameter, where <code>n</code> was dynamic? This is the case in Glenn's solution; have a close look at this line:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">    <span class="token builtin class-name">echo</span> <span class="token string">"For want of a <span class="token variable">${<span class="token operator">!</span>i}</span> the <span class="token variable">${<span class="token operator">!</span>j}</span> was lost."</span></code></pre>
<p>Here we want to refer to the &quot;i-th&quot; and the &quot;j-th&quot; parameter, whatever <code>i</code> and <code>j</code> are each time round the loop. Using simply a reference like this: <code>$i</code> would resolve to the value of <code>i</code>, which would be <code>1</code> for example (in the first iteration of the loop). But what we want is the value of the first parameter. This is why we see the <code>!</code> which introduces a level of indirection. So here, we see <code>${!i}</code> and <code>${!j}</code>.</p>
<p>What happens is that these both resolve to &quot;the value of the variable name in <code>i</code> and <code>j</code>&quot;. So in the first iteration of the loop, these then would resolve to the values of <code>$1</code> and <code>$2</code>. And in the second iteration, they'd resolve to the values of <code>$2</code> and <code>$3</code>.</p>
<h2 id="ensuring-a-successful-script-exit">Ensuring a successful script exit</h2>
<p>The last line looks like this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">"And all for the want of a <span class="token variable">$1</span>."</span> <span class="token operator">||</span> <span class="token builtin class-name">:</span></code></pre>
<p>The <code>|| :</code> construct may look a little odd. But if one considers what <code>:</code> does, it makes sense (indeed, it's explained by Glenn in the comments on this iteration of his solution). The <code>:</code> is the &quot;no operation&quot; command, and I've covered it in a previous blog post - see <a href="/blog/posts/2021/09/03/exploring-fff-part-1-main/#the-no-operation-command-colon">The no-operation command : (colon)</a>). Essentially, it does nothing, successfully. Which means that if the <code>[[ -n $1 ]]</code> condition is not true (i.e. <code>$1</code> is empty) then the <code>echo</code> will not execute, the script will then end anyway, but with a non-zero exit code, and this is not desired.</p>
<p>Using <code>|| :</code> here is like using <code>|| true</code> but perhaps more idiomatic to Bash.</p>
<hr>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>The <a href="https://qmacro.org/tags/exercism/">exercism</a> and <a href="https://qmacro.org/tags/shell/">shell</a> tags on this blog</li>
<li><a href="/blog/posts/2021/09/03/exploring-fff-part-1-main/">Exploring fff part 1 - main</a></li>
</ul>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2022/03/25/understanding-jqs-reduce-function/">Understanding jq&#39;s reduce function</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2022/04/10/bash-notes-2/">Bash notes 2</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2022/04/07/bash-notes/` was built on 2026-01-01T14:31:30.447Z -->
		<script type="module" src="/dist/t-8sxMV3B9.js"></script>
	</body>
</html>
