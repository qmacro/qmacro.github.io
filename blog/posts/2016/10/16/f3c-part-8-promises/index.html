<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2016/10/16/f3c-part-8-promises/"><link href="/assets/main.c8613da530e0f001ce67.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>F3C Part 8 - Promises | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="F3C Part 8 - Promises"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2016/10/16/f3c-part-8-promises/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@qmacro"><meta name="description" content="F3C Part 8 - Promises 16 Oct 2016 | 2 min read FunFunFunction Video: Promises - Part 8 of Functional Programming in JavaScript (This post is..."><meta property="og:description" content="F3C Part 8 - Promises 16 Oct 2016 | 2 min read FunFunFunction Video: Promises - Part 8 of Functional Programming in JavaScript (This post is..."><meta name="description" content="F3C Part 8 - Promises 16 Oct 2016 | 2 min read FunFunFunction Video: Promises - Part 8 of Functional Programming in JavaScript (This post is..."><meta property="og:image" content="https://qmacro.org/images/site-image-square.png"><meta name="twitter:image" content="https://qmacro.org/images/site-image-square.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/talks">Talks</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>F3C Part 8 - Promises</h1><div class="post__details"><time datetime="2016-10-16">16 Oct 2016 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p>FunFunFunction Video: <a href="https://www.youtube.com/watch?v=2d7s3spWAzo&amp;index=8&amp;list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84">Promises - Part 8 of Functional Programming in JavaScript</a></p><p>(This post is part of the <a href="/f3c/">F3C</a> series)</p><p>This video episode was recorded over a year ago. Since that time, a native implementation of Promises is available in my scratchpad of choice, (the developer tools console of) Google Chrome. So there's no requirement for us to use <code>babelify/polyfill</code> or other similar techniques, we can just go ahead and say:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>and get</p><pre class="language-javascript"><code class="language-javascript">Promise <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token punctuation">[</span>PromiseStatus<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">"pending"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>PromiseValue<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">}</span></code></pre><p>Because of this, it would seem that many of the implementation related <a href="https://github.com/mattdesl/promise-cookbook#pitfalls">pitfalls detailed in the Promise Cookbook</a>, to which MPJ refers in his video description, are no longer relevant. Which is a good thing.</p><p>Like recursion, asynchronous programming in general and promises in particular make me stop and think. There's an uphill element to thinking about asynchronous tasks, and chaining them together. So I reflected a little longer than normal on what I'd learned from this video. Moreover, I'd been intrigued by what MPJ had mentioned in the video, multiple times, about <strong>composability</strong>.</p><p>I have a general understanding about function composition from my relationship with Clojure. But following the video, I explored some other material, including a talk from Full Stack Toronto: <a href="https://www.youtube.com/watch?v=v6oFo_Uajwk">Reduce Complexity with Functional JS by @frontvu</a>. This talk gives a very brief introduction to some of the key concepts of functional programming, and includes this implementation of a <code>compose</code> function:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">compose</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">var</span> funcList <span class="token operator">=</span> arguments<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span><br>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> funcList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        args <span class="token operator">=</span> <span class="token punctuation">[</span>funcList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token keyword">return</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>This allows us then to do something like this:</p><pre class="language-javascript"><code class="language-javascript"><span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=></span> n <span class="token operator">*</span> n<span class="token punctuation">,</span> <span class="token parameter">n</span> <span class="token operator">=></span> <span class="token operator">++</span>n<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><br><span class="token comment">// 36</span></code></pre><p>In other words, we're composing a couple of functions (the anonymous increment and square functions here) to form a new function.</p><p>This is similar to <a href="https://clojuredocs.org/clojure.core/comp">Clojure's native composition function</a> <code>comp</code>. There are many examples of how <code>comp</code> can be used, but my favourite one, beautifully simple, is this:</p><pre class="language-clojure"><code class="language-clojure"><span class="token punctuation">(</span><span class="token keyword">filter</span> <span class="token punctuation">(</span><span class="token keyword">comp</span> not zero?<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token comment">;;=> (1 2 3 4)</span></code></pre><p>Anyway, back to promises in JavaScript. In the light of this reflection on <code>comp</code> and <code>compose</code>, the point that MPJ was making about promises being composable makes sense. We can think of function composition as chaining functions together, in a similar way to the Unix pipeline idea - the output of one function gets fed into the input of the next. It's almost so simple as to be too hard to understand.</p><p>I had found myself on a journey to the centre of the earth just to understand function composition, whereas it had been sitting there innocently in front of me all this time. The ability to string promises together, passing promises and values through the <code>then</code> chain, is pretty damn powerful. Add to that the ability to treat a list of functions the way that <code>Promises.all</code> gives us, and there's a compelling argument for getting to know more about promises right there.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/language-ramblings/">#language-ramblings</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2016/10/19/f3c-parts-9-and-10-functors/"><span>←</span> <span>F3C Parts 9 and 10 - Functors</span> </a><a href="/blog/posts/2016/10/04/f3c-part-7-recursion/"><span>F3C Part 7 - Recursion</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a href="https://twitter.com/qmacro" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>