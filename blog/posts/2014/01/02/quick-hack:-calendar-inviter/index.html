<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2014/01/02/quick-hack:-calendar-inviter/"><link href="/assets/main.c8613da530e0f001ce67.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Quick hack: Calendar Inviter | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Quick hack: Calendar Inviter"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2014/01/02/quick-hack:-calendar-inviter/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@qmacro"><meta name="description" content="Quick hack: Calendar Inviter 02 Jan 2014 | 2 min read Working in different organisations sometimes means having different email addresses..."><meta property="og:description" content="Quick hack: Calendar Inviter 02 Jan 2014 | 2 min read Working in different organisations sometimes means having different email addresses..."><meta name="description" content="Quick hack: Calendar Inviter 02 Jan 2014 | 2 min read Working in different organisations sometimes means having different email addresses..."><meta property="og:image" content="https://qmacro.org/images/DJA-head.png"><meta name="twitter:image" content="https://qmacro.org/images/DJA-head.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/talks">Talks</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Quick hack: Calendar Inviter</h1><div class="post__details"><time datetime="2014-01-02">02 Jan 2014 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p>Working in different organisations sometimes means having different email addresses and calendars. Currently I have two Outlook instances I have to manage (one for <a href="http://www.bluefinsolutions.com">Bluefin</a> and one for a client) on top of my Google-based personal calendar.</p><p>Keeping them in sync is a struggle that I avoid, but there’s recently been a specific case where I do want to make the effort, and that’s time / location scheduling – where I’ll be, on what days. This information needs to be in all calendars, to share with work colleagues, and for my own sanity (I see my Google calendar as my master instance in this case).</p><p><img src="/images/2014/01/calendars.jpg" alt="image">So I wrote a quick Google Apps Script hack to allow me to quickly specify the where/when events in a particular Google calendar that I maintain (called “Work”), and then have those events distributed, via invitations, to my other Outlook identities. It’s not very sophisticated – all it does is look through the Work calendar for all-day events matching a certain title pattern, then look at the guest list; if the emails I want to share the event with are not already on the list, they’re added, and invites are sent.</p><p>Because of <a href="https://code.google.com/p/google-apps-script-issues/issues/detail?id=574">an issue with the CalendarService component of Google Apps Script</a> (that’s been open since May 2011!) you can’t directly cause invites to be sent to new guests that you add to an existing event. So one workaround is to create the calendar invitation (ICS file) yourself and email it. It’s pretty simple (and Romain Vialard <a href="https://code.google.com/p/google-apps-script-issues/issues/detail?id=574#c2">has an example</a> in the commentary on the issue).</p><p>Actually creating the ICS file myself was a solution to not one but two issues. The ICS files that are auto-generated by Google Calendar when you add a guest via the UI contain entries like this for all-day events:</p><p>DTSTART;VALUE=DATE:20140305<br>DTEND;VALUE=DATE:20140306</p><p>Unfortunately Outlook makes an incorrect guess as to the timezone for these dates, based on its own timezone, and when the recipient calendar is in a different timezone than the originating event (in my case UTC and UTC+1), it causes the replicated entry to be skewed by an hour, causing the all-day event to span the wrong days! So being in control of the ICS content generation means I can be more explicit which in turn means that Outlook doesn’t get it wrong.</p><p>DTSTART:20140305T000000Z<br>DTEND:20140306T000000Z</p><p>So that’s it. <a href="https://gist.github.com/qmacro/8219400">I’ve made the script available as a Gist</a> on Github and here’s a screenshot of some typical results.</p><p><img src="/images/2014/01/log.jpg" alt="image"></p><p>Share &amp; enjoy!</p><p></p><p></p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/appsscript/">#appsscript</a> <a href="/tags/calendar/">#calendar</a> <a href="/tags/gmail/">#gmail</a> <a href="/tags/google/">#google</a> <a href="/tags/outlook/">#outlook</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2014/02/05/alt-k:-reading-notes/"><span>←</span> <span>Alt-K: Reading Notes</span> </a><a href="/blog/posts/2013/11/27/sap-uk-and-ireland-user-group-conference-demo-jam!/"><span>SAP UK &amp; Ireland User Group Conference - Demo Jam!</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a href="https://twitter.com/qmacro" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>