<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>SAP Tech Bytes: Exploring SAP-samples with gh and fzf</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="sap-tech-bytes-exploring-sap-samples-with-gh-and-fzf">SAP Tech Bytes: Exploring SAP-samples with gh and fzf</h1>

<ul class="post-metadata">
	<li><time datetime="2021-04-06">06 April 2021</time></li>
	<li><a href="/tags/sapcommunity/" class="post-tag">sapcommunity</a>, </li>
	<li><a href="/tags/gh/" class="post-tag">gh</a>, </li>
	<li><a href="/tags/fzf/" class="post-tag">fzf</a>, </li>
	<li><a href="/tags/github/" class="post-tag">github</a>, </li>
	<li><a href="/tags/sap-tech-bytes/" class="post-tag">sap-tech-bytes</a></li>
</ul>

<p class="post-description-main"></p>

<p><em>Discover repositories that might be useful for you by exploring them
from the command line with a couple of powerful tools.</em></p>
<p>The <a href="https://github.com/SAP-samples">SAP-samples organisation on GitHub</a>
contains many repositories with sample code on various SAP technology
topics. There's also a new show <a href="https://www.youtube.com/playlist?list=PL6RpkC85SLQDS1XbEQIWG_h3fSj_jG_yQ">SAP Samples
Spotlight</a>
on our SAP Developers YouTube channel highlighting some of these
repositories. We're not going to be able to cover all of them on the
show, so here's a way of exploring what's on offer, using command line
tools.</p>
<p><img src="/images/2021/04/org-sampler.gif" alt=""></p>
<p>GitHub's command line tool <a href="https://github.com/cli/cli">gh</a> gives us
the ability to explore the API surface area. The latest release (1.8.1
at the time of writing) offers pagination, result cacheing and a
built-in version of <a href="https://jqlang.org/">jq</a>, the JSON
processor.</p>
<p>You can install <code>gh</code> and <code>fzf</code> locally, or even install them in the
terminal of a dev space in the SAP Business Application Studio to try
things out. See how we do this in the <a href="https://github.com/SAP-samples/teched2020-developer-keynote">SAP TechEd 2020 Developer Keynote
repository</a> -
take a look specifically at the <a href="https://github.com/SAP-samples/teched2020-developer-keynote/tree/main/usingappstudio#add-tools-to-your-dev-space">Add tools to your dev
space</a>
section.</p>
<p>Before you use <code>gh</code> for the first time, you'll need to authenticate -
use <code>gh auth login</code> and follow the prompts. Then you're all set to use
the <code>org-sampler</code> script as shown above.</p>
<h2 id="the-script">The script</h2>
<p>Let's break it down line by line (mostly <a href="/blog/posts/2021/01/26/columnar-layout-with-awk/#homage">in homage to a great teacher,
Randal L Schwartz</a>).</p>
<pre class="language-shell" tabindex="0"><code class="language-shell"> <span class="token number">1</span> <span class="token comment">#!/usr/bin/env bash</span>
 <span class="token number">2</span>
 <span class="token number">3</span> <span class="token builtin class-name">readonly</span> <span class="token assign-left variable">org</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${1<span class="token operator">:?</span>Specify org name}</span>"</span>
 <span class="token number">4</span>
 <span class="token number">5</span> <span class="token function-name function">jqscript</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token number">6</span>
 <span class="token number">7</span>   <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> EOF
 <span class="token number">8</span>   .<span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token number">9</span>   <span class="token operator">|</span> <span class="token punctuation">[</span>
<span class="token number">10</span>     .name,
<span class="token number">11</span>     <span class="token string">"Name: \(.name)<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>Description: \(.description)<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>Language: \(.language)<span class="token entity" title="\n">\n</span>Watchers: \(.watchers_count)<span class="token entity" title="\n">\n</span>Stars: \(.stargazers_count)<span class="token entity" title="\n">\n</span>Forks: \(.forks_count)"</span>
<span class="token number">12</span>     <span class="token punctuation">]</span>
<span class="token number">13</span>   <span class="token operator">|</span> @tsv
<span class="token number">14</span> EOF
<span class="token number">15</span>
<span class="token number">16</span> <span class="token punctuation">}</span>
<span class="token number">17</span>
<span class="token number">18</span> gh api
<span class="token number">19</span>   <span class="token string">"/orgs/<span class="token variable">$org</span>/repos"</span>
<span class="token number">20</span>   <span class="token parameter variable">--paginate</span>
<span class="token number">21</span>   <span class="token parameter variable">--cache</span> 1h
<span class="token number">22</span>   <span class="token parameter variable">--jq</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span>jqscript<span class="token variable">)</span></span>"</span>
<span class="token number">23</span>   <span class="token operator">|</span> fzf
<span class="token number">24</span>     --with-nth<span class="token operator">=</span><span class="token number">1</span>
<span class="token number">25</span>     <span class="token parameter variable">--delimiter</span><span class="token operator">=</span><span class="token string">'\t'</span>
<span class="token number">26</span>     <span class="token parameter variable">--preview</span><span class="token operator">=</span><span class="token string">'echo -e {2}'</span>
<span class="token number">27</span>     --preview-window<span class="token operator">=</span>up:sharp:wrap:40%</code></pre>
<p>1: the <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> uses
<code>env</code> to find <code>bash</code> on my system to execute the contents of the file</p>
<p>3: the script expects a single argument to be specified - the name of
the organisation on GitHub. For our purposes this should be SAP-samples</p>
<p>5-16: a simple function to encapsulate the small <code>jq</code> script that will
be passed to the invocation of <code>gh</code> to parse the JSON output that is
returned from the API call</p>
<p>8: the JSON output's outermost element is an array, which means we
start with <code>.[]</code> to say &quot;take each of the array items&quot;; each array
item represents a repository within the organisation, and has different
properties</p>
<p>9: we flow the array items (via the <code>|</code>) into a list of fields that we
keep together with <code>[</code> starting on this line, and ending with <code>]</code> on
line 12</p>
<p>10: the first field in the list is simply the value of the <code>name</code>
property (the name of the repository)</p>
<p>11: the second field is a string that's made up of literal and
repository property values, combined into a multi-line string (note the
newline characters in there <code>\n</code>); this string is what's to be shown in
the preview (at the top, in the demo above)</p>
<p>13: finally each list of fields is flowed into <code>@tsv</code> which produces a
tab separated values set of records</p>
<p>18-22: the main action is in these lines - the call to <code>gh</code>'s <code>api</code>
facility</p>
<p>19: the API call is to the endpoint for <a href="https://docs.github.com/en/rest/reference/repos#list-organization-repositories">listing organisation
repositories</a> -
specifically for the organisation (in <code>$org</code>) specified when the script
was invoked</p>
<p>20: there are a limited number of results returned by the API in any one
response; the <code>--paginate</code> option tells <code>gh</code> to make enough calls to
page through all of the results - very convenient!</p>
<p>21: the recent <code>--cache</code>option allows for cacheing of the results, to
save on hitting the API endpoints too frequently and unnecessarily; it
makes a lot of sense here given the frequency of new repository
creations</p>
<p>22: the <code>--jq</code> option is also recent, and given that the API output is
JSON, is very useful; we use the <code>jq</code> script defined earlier in the
<code>jqscript</code> function here to produce that set of tab separated records
(where the first field is the repository name and the second field is
the multi-line string showing the repository details)</p>
<p>23: the (tab separated records) output is then passed into <code>fzf</code>to give
us a chance to browse or search through the entire list and see the
repositories' details</p>
<p>24: using <code>--with-nth=1</code> we can tell <code>fzf</code> to only show the first field
in the actual selection list</p>
<p>25: we tell <code>fzf</code> how to know what the fields are with
<code>--delimiter='\t'</code>, i.e. the fields are separated by tab characters</p>
<p>26: with <code>--preview='echo -e {2}'</code> we tell <code>fzf</code> that we want to have
something shown in a preview window for each item; what is shown is the
result of <code>echo -e {2}</code> where <code>{2}</code> is an <code>fzf</code> placeholder representing
the second field in the list (i.e. the multi-line string) and the <code>-e</code>
switch tells <code>echo</code> to actually interpret backslash escapes, meaning
that the newline characters (<code>\n</code>) in the field will be rendered
properly and the preview will indeed be multi-line</p>
<p>27: the <code>--preview-window=up:sharp:wrap:40%</code> option tells <code>fzf</code> how to
display the preview window, including that it should be at the top,
above the list (<code>up</code>), that any long text lines should be wrapped (this
is good for the value of the repositories' description fields) and that
the preview window should take up just less than half of the screen
(<code>40%</code>)</p>
<p>And that's it.</p>
<p>The command line is a powerful environment and with it come powerful
tools that can help you retrieve, bend and shape the information you
need to work with.</p>
<h2 id="trying-it-yourself">Trying it yourself</h2>
<p>There's a branch for this SAP Tech Bytes post in the accompanying <a href="https://github.com/SAP-samples/sap-tech-bytes">SAP
Tech Bytes repository</a>,
and it contains the version of the script
<a href="https://github.com/SAP-samples/sap-tech-bytes/blob/2021-04-05-exploring-sap-samples-with-gh-and-fzf/org-sampler">org-sampler</a>
described above:</p>
<p><a href="https://github.com/SAP-samples/sap-tech-bytes/tree/2021-04-05-exploring-sap-samples-with-gh-and-fzf">https://github.com/SAP-samples/sap-tech-bytes/tree/2021-04-05-exploring-sap-samples-with-gh-and-fzf</a></p>
<p><em>This post was inspired by <a href="https://seb.jambor.dev/posts/improving-shell-workflows-with-fzf/">Improving shell workflows with
fzf</a>.</em></p>
<p><a href="#saptechbytes"><img src="/images/2021/02/screenshot-2021-02-22-at-11.00.25.png" alt=""></a></p>
<hr>
<p>SAP Tech Bytes is an initiative to bring you bite-sized information on
all manner of topics, in
<a href="https://www.youtube.com/playlist?list=PL6RpkC85SLQC3HBShmlMaPu_nL--4f20z">video</a>
and <a href="/tags/sap-tech-bytes/">written</a> format. Enjoy!</p>
<hr>
<p><a href="https://community.sap.com/t5/technology-blogs-by-sap/sap-tech-bytes-exploring-sap-samples-with-gh-and-fzf/ba-p/13512644">Originally published on SAP Community</a></p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2021/04/04/mainframes-sdsf-and-github-actions/">Mainframes, SDSF and GitHub Actions</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2021/04/13/producing-json-with-jq-for-appending-issue-titles/">Producing JSON with jq for appending issue titles</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2021/04/06/sap-tech-bytes-exploring-sap-samples-with-gh-and-fzf/` was built on 2025-10-05T10:59:08.873Z -->
		<script type="module" src="/dist/R1izrEYWYW.js"></script>
	</body>
</html>
