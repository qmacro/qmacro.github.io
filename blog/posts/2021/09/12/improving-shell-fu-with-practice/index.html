<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Improving shell fu with practice</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		
	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="improving-shell-fu-with-practice">Improving shell fu with practice</h1>

<ul class="post-metadata">
	<li><time datetime="2021-09-12">12 September 2021</time></li>
	<li><a href="/tags/autodidactics/" class="post-tag">autodidactics</a>, </li>
	<li><a href="/tags/kitty/" class="post-tag">kitty</a>, </li>
	<li><a href="/tags/shell/" class="post-tag">shell</a></li>
</ul>

<p class="post-description-main"></p>

<p>Practising in the shell helps me improve and exposes me to new knowledge. Here's an example.</p>
<!--excerpt-->
<p>At the end of the working day I'm tired, but there's often just enough energy left in my brain to explore new options for some Unix commands, and practise my shell fu. Here's a few trivial things that I just learned, by writing a pipeline to choose and display a new theme for my current terminal of choice, <a href="https://sw.kovidgoyal.net/kitty/">kitty</a>.</p>
<p>There's <a href="https://github.com/dexpota/kitty-themes">a nice selection of themes for kitty</a>; I've installed the contents of the repo in the right place and can select a theme by <a href="https://github.com/qmacro/dotfiles/blob/ba940b5b70b069010e18d22d8d88da01acaf9048/config/kitty/kitty.conf#L1287">adding an include at the bottom of my <code>kitty.conf</code> file</a>:</p>
<pre><code>include ./theme.conf
</code></pre>
<p>and then creating <code>theme.conf</code> as a symbolic link pointing to the actual theme configuration file (from the repo) that I want to use:</p>
<pre><code>lrwxr-xr-x   1 i347491  staff     72 13 Sep 18:07 theme.conf -&gt; kitty-themes/themes/SpaceGray.conf
</code></pre>
<p>This was achieved with the following:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$DOTFILES</span>/config/kitty/ <span class="token punctuation">\</span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">find</span> kitty-themes/themes <span class="token parameter variable">-name</span> <span class="token string">'*.conf'</span> <span class="token punctuation">\</span>
    <span class="token operator">|</span> <span class="token function">shuf</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token punctuation">\</span>
    <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token parameter variable">-J</span> % <span class="token function">ln</span> <span class="token parameter variable">-fsv</span> % theme.conf <span class="token punctuation">\</span>
    <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">-o</span> <span class="token string">'\w+(?=\.conf$)'</span></code></pre>
<p>This uses <code>find</code> to look for <code>conf</code> files in the <code>kitty-themes/themes/</code> directory within my dotfiles configuration for <code>kitty</code>. The output of such a <code>find</code> command looks like this:</p>
<pre><code>kitty-themes/themes/SpaceGray_Eighties_Dull.conf
kitty-themes/themes/Monokai.conf
kitty-themes/themes/Floraverse.conf
...
</code></pre>
<p>I pass this list to <code>shuf</code> (short for &quot;shuffle&quot;), which &quot;generates random permutations&quot; and ask it via <code>-n 1</code> to only give me one back.</p>
<p>Then of course it would be nice to use <code>xargs</code> to pass that single, random theme file name, for example <code>kitty-themes/themes/SpaceGray.conf</code>, to the <code>ln</code> command to create a symbolic link. The thing is, <code>xargs</code> puts what it's given at the end of the list; in other words, if we did this:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token builtin class-name">echo</span> kitty-themes/themes/SpaceGray.conf <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">ln</span> <span class="token parameter variable">-fsv</span> theme.conf</code></pre>
<p>then the <code>ln</code> command invoked would be the wrong way round, i.e.:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token function">ln</span> <span class="token parameter variable">-fsv</span> theme.conf kitty-themes/themes/SpaceGray.conf</code></pre>
<p>instead of</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token function">ln</span> <span class="token parameter variable">-fsv</span> kitty-themes/themes/SpaceGray.conf theme.conf</code></pre>
<p>Luckily <code>xargs</code> has the <code>-J</code> option which allows us to specify a pattern, and then refer to that pattern to insert the value appropriately, which is what is happening here - the <code>%</code> is the pattern and shows where in the <code>ln</code> command the value should be put:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token function">xargs</span> <span class="token parameter variable">-J</span> % <span class="token function">ln</span> <span class="token parameter variable">-fsv</span> % theme.conf</code></pre>
<p>What of the <code>ln</code> command itself? Well there's the <code>-s</code> option which is the main deal, i.e. we want to create a symbolic link. The <code>-f</code> option tells <code>ln</code> to not worry about any existing file (i.e. if there's already a <code>theme.conf</code>) and to just overwrite it. And the <code>-v</code> is a verbose option which outputs what is being done.</p>
<p>This last <code>-v</code> option is used so that I can get the name of the randomly selected theme. Without the last part of the pipeline, into <code>grep</code>, we'd see something like this, output because of this <code>-v</code> option to <code>ln</code>:</p>
<pre><code>theme.conf -&gt; kitty-themes/themes/SpaceGray.conf
</code></pre>
<p>So we can then pipe this into <code>grep</code> to grab the <code>SpaceGray</code> part, invoking the powerful Perl Compatible Regular Expression (PCRE) class of regular expressions (for which I have to use the <code>-P</code> option) to be able to use a positive lookahead assertion <code>(?=\.conf$)</code> to say <em>what we're trying to match, <code>\w+</code> (a sequence of at least one word character), must be directly followed by <code>.conf</code> up against the end of the line (<code>$</code>)</em>.</p>
<p>Such an assertion is not part of the actual match, which means we can then simply use the <code>-o</code> option to tell <code>grep</code> to output just the match itself, i.e.:</p>
<pre><code>SpaceGray
</code></pre>
<p>I use this technique in <a href="https://github.com/SAP-samples/sap-tech-bytes/blob/8cbc01e51a8adcc6051fe9c6800c91a4093f1af9/getbtpcli">getbtpcli</a> (see <a href="https://github.com/SAP-samples/sap-tech-bytes/blob/8cbc01e51a8adcc6051fe9c6800c91a4093f1af9/getbtpcli#L61">line 61</a>) - if you're interested in reading more about this, have a look at the blog post <a href="https://blogs.sap.com/2021/09/01/sap-tech-bytes-btp-cli-installation/">SAP Tech Bytes: btp CLI - installation</a>, and the comments too.</p>
<p>And that's pretty much it. Nothing earth shattering, but certainly a couple of things that I found out (in particular <code>ln</code>'s <code>-v</code> option and <code>xargs</code>'s <code>-J</code> option.</p>
<p>Happy learning!</p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2021/09/07/sap-tech-bytes-btp-cli-logging-in/">SAP Tech Bytes: btp CLI – logging in</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2021/09/14/sap-tech-bytes-btp-cli-managing-configuration/">SAP Tech Bytes: btp CLI - managing configuration</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2021/09/12/improving-shell-fu-with-practice/` was built on 2025-09-15T15:58:49.612Z -->
		<script type="module" src="/dist/xbxy_EL6cU.js"></script>
	</body>
</html>
