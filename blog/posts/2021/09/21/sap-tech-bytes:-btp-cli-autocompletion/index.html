<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2021/09/21/sap-tech-bytes:-btp-cli-autocompletion/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.54fe08380532f159e78f.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>SAP Tech Bytes: btp CLI - autocompletion | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="SAP Tech Bytes: btp CLI - autocompletion"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2021/09/21/sap-tech-bytes:-btp-cli-autocompletion/"><meta name="description" content="SAP Tech Bytes: btp CLI - autocompletion 21 Sep 2021 | 4 min read Get the btp CLI to help you with command autocompletion. This is a..."><meta property="og:description" content="SAP Tech Bytes: btp CLI - autocompletion 21 Sep 2021 | 4 min read Get the btp CLI to help you with command autocompletion. This is a..."><meta name="description" content="SAP Tech Bytes: btp CLI - autocompletion 21 Sep 2021 | 4 min read Get the btp CLI to help you with command autocompletion. This is a..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>SAP Tech Bytes: btp CLI - autocompletion</h1><div class="post__details"><time datetime="2021-09-21">21 Sep 2021 </time><span>| </span><span>4 min read</span></div></header><main class="post__content"><p><em>Get the btp CLI to help you with command autocompletion.</em></p><p>This is a follow-on post from the previous one: <a href="/blog/posts/2021/09/14/sap-tech-bytes:-btp-cli-managing-configuration/">SAP Tech Bytes: btp CLI - managing configuration</a> and starts where we left off there, with you logged in.</p><h2>Actions, groups, objects and the command structure</h2><p>There are many different types of resources that you might want to manage on the SAP Business Technology Platform (BTP). Moreover, there are different actions that you might want to take on each. This is why the command structure that the btp CLI supports is how it is:</p><pre class="language-text"><code class="language-text">Usage: btp [OPTIONS] ACTION [GROUP/OBJECT] [PARAMS]</code></pre><p>The BTP resources are the OBJECTs and these are organised into different GROUPs. You perform ACTIONs on these, possibly supplying relevant information via PARAMS. There are also general <a href="https://help.sap.com/viewer/DRAFT/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/11d9f67d2c68485ca2f435b955d3b85b.html">OPTIONS</a> that are not ACTION or GROUP/OBJECT specific.</p><p>Here's a shortened excerpt from the output shown when invoking the <code>--help</code> option, i.e. <code>btp --help</code>:</p><pre class="language-text"><code class="language-text">Actions for accounts/available-environment<br>  list                  Get all available environments for a subaccount<br>  get                   Get details about an available environment for a subaccount<br><br>Actions for accounts/directory<br>  get                   Get details about a directory and its contents<br>  create                Create a directory<br>  update                Update a directory<br>  delete                Delete a directory<br>  enable                Change the set of enabled features for a directory<br><br>Actions for accounts/subaccount<br>  list                  List all subaccounts in a global account<br>  get                   Get details about a subaccount<br>  create                Create a subaccount<br>  update                Update a subaccount<br>  delete                Delete a subaccount<br>  move                  Move a subaccount<br>  subscribe             Subscribe to an application from a subaccount<br>  unsubscribe           Unsubscribe an application from a subaccount<br><br>Actions for security/app<br>  list                  List all apps<br>  get                   Get details about a specific app<br><br>...</code></pre><p>The relationship between ACTION (<code>get</code>, <code>list</code>, <code>update</code>, etc) and GROUP/OBJECT (<code>accounts/directory</code>, <code>security/app</code>, etc) can be seen quite nicely here.</p><h2>Enabling autocomplete</h2><p>With the btp CLI you can perform different actions on a wide range of objects, so much so that it can be a little overwhelming at first. This is where autocompletion comes in. You can use the Tab key to ask <code>btp</code> to make suggestions, based on what you've typed in so far (which could be nothing at all).</p><p>As well as the main actions, there are some general actions too - you've used a couple already: <code>login</code> and <code>target</code>. <a href="https://help.sap.com/viewer/DRAFT/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/46355fab22814944bedf449a6c953369.html">Turning on autocompletion</a> is achieved with another of these general actions.</p><p>Do it now:</p><pre class="language-shell"><code class="language-shell">btp <span class="token builtin class-name">enable</span> autocomplete <span class="token function">bash</span></code></pre><blockquote><p>The btp CLI supports autocompletion for different shells: Bash, Zsh and PowerShell. The shell you're running in your SAP Business Application Studio dev space is Bash; this is why you need to specify <code>bash</code> as a parameter.</p></blockquote><p>Here's what happens:</p><pre class="language-text"><code class="language-text">This will install the autocomplete plugin script for bash<br>to /home/user/.config/btp/autocomplete/scripts.<br>Do you want to continue? [no]>yes<br>Which RCFile should be used for the installation?<br>1: /home/user/.bash_profile<br>2: /home/user/.bashrc<br>3: /home/user/.profile<br>4: Custom<br>Enter option>2<br>Autocomplete script for bash has been installed<br>to /home/user/.config/btp/autocomplete/scripts.<br>You must start a new terminal session to activate the installed script.<br><br>Tips:<br>  Use the TAB key to complete commands and provide valid command actions, options, and parameters.<br>  Use the TAB key to cycle through the suggestion lists and the ENTER key to select.<br><br>OK</code></pre><p>There are a few things worthy of note here:</p><ul><li>the autocomplete mechanism is installed into a subdirectory <code>autocomplete/</code> within the configuration directory we specified for the btp CLI; this keeps everything nicely together</li><li>I chose option 2, i.e. <code>/home/user/.bashrc</code> as that is the file we've been using to maintain and customise our shell environment There are useful tips at the end of the output on how to use the autocomplete feature</li></ul><blockquote><p>Have you ever wondered why the <code>.bashrc</code> file name ends in <code>rc</code> and what it means? Did you spot the reference to <code>RCFile</code> in the output? Let me know in the comments.</p></blockquote><p>The installed autocomplete mechanism in <code>.config/btp/autocomplete/</code> needs to be activated when the shell session starts; if you look into your <code>.bashrc</code> file now, you'll see a new line has been appended, right after the two we recently added. The line looks like this (with some whitespace added for readability):</p><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">SAP_BTP_CLI_AUTOCOMPLETE</span><span class="token operator">=</span><span class="token string">"/home/user/.config/btp/autocomplete/scripts/sapbtpcli-autocomplete.plugin.sh"</span><br>  <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">source</span> <span class="token variable">$SAP_BTP_CLI_AUTOCOMPLETE</span><br>  <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">bind</span> <span class="token string">'set show-all-if-ambiguous on'</span><br>  <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">bind</span> <span class="token string">'set show-mode-in-prompt on'</span></code></pre><p>This just sets another btp CLI related environment variable pointing to the autocomplete script, runs that script, and sets a couple of <a href="https://www.gnu.org/software/bash/manual/html_node/Readline-Init-File-Syntax.html"><code>readline</code> options</a>:</p><ul><li><code>show-all-if-ambiguous</code> will list possible matches immediately</li><li><code>show-mode-in-prompt</code> adds a little indicator to the prompt to show the editing mode (we'll see this shortly)</li></ul><blockquote><p><code>readline</code> is Bash's command-line editing interface.</p></blockquote><p>As instructed, start a new terminal session to have the <code>.bashrc</code> re-sourced, and you're ready. Note that the shell prompt now has an @ symbol at the front:</p><pre class="language-text"><code class="language-text">@user: user $</code></pre><p>This is the result of turning on <code>show-mode-in-prompt</code>; personally, I don't like this so I remove that last <code>bind</code> statement from my <code>.bashrc</code>. You can do the same, or leave it as it is.</p><h2>Enjoying the comfort of autocomplete</h2><p>Now you're ready to try the autocomplete features out. First, enter <code>btp</code> (including a space, so that the shell won't try to autocomplete the &quot;btp&quot; command itself), and then hit the Tab key; you should see something like this:</p><pre class="language-text"><code class="language-text">@user: user $ btp <tab><br>add          enable       register     unassign     update<br>assign       get          remove       unregister<br>create       list         share        unshare<br>delete       move         subscribe    unsubscribe</tab></code></pre><p>You'll recognise these as all of the possible actions that <code>btp</code> understands.</p><p>Next, continue with <code>l &lt;tab&gt;</code>:</p><pre class="language-text"><code class="language-text">@user: user $ btp l<tab></tab></code></pre><p>which should then autocomplete to <code>list</code> and hit <code>&lt;tab&gt;</code> once more, and you should see the objects, by group, which can be listed:</p><pre class="language-text"><code class="language-text">@user: user $ btp list<br>accounts/assigned-entitlements  security/role<br>accounts/available-environment  security/role-collection<br>accounts/available-region       security/user<br>accounts/custom-property        services/binding<br>accounts/entitlement            services/broker<br>accounts/environment-instance   services/instance<br>accounts/resource-provider      services/offering<br>accounts/subaccount             services/plan<br>accounts/subscription           services/platform<br>security/app</code></pre><blockquote><p>Note that you haven't pressed Enter yet, at all.</p></blockquote><p>Nice! Let's say we want to list the entitlements for our trial subaccount (remember, this is already pre-selected via our use of <code>target</code> in <a href="/blog/posts/2021/09/07/sap-tech-bytes:-btp-cli-logging-in/">SAP Tech Bytes: btp CLI - logging in</a>). So continue on the same line with <code>a&lt;tab&gt;e&lt;tab&gt;</code> which will narrow things down to the <code>accounts</code> group and the objects beginning with <code>e</code>:</p><pre class="language-text"><code class="language-text">@user: user $ btp list<br>accounts/entitlement           accounts/environment-instance</code></pre><p>Close in on your target by adding a final <code>t</code> (note that the autocomplete has autocompleted as far as it can by adding an <code>n</code>) to disambiguate <code>entitlement</code> from <code>environment-instance</code>, and then hit <code>&lt;tab&gt;</code> one more time to autocomplete to what we're looking for:</p><pre class="language-shell"><code class="language-shell">@user: user $ btp list accounts/entitlement<br><br>Showing entitlements <span class="token keyword">for</span> subaccount b8a33bf9-b155-4736-aadf-582dae8fd65a:<br><br><span class="token function">service</span> name                         <span class="token function">service</span> plan       <span class="token function">quota</span><br>customer-order-sourcing-app-trial    dev                <span class="token number">1</span><br>saas-registry                        application        <span class="token number">1</span><br>APPLICATION_RUNTIME                  MEMORY             <span class="token number">4</span><br>alm-ts                               lite               <span class="token number">1</span><br>sapappstudiotrial                    trial              <span class="token number">1</span><br>business-rules                       lite               <span class="token number">1</span><br>transport                            standard           <span class="token number">1</span><br>personal-data-manager-service        standard           <span class="token number">1</span><br>portal                               standard           <span class="token number">100</span><br><span class="token punctuation">..</span>.</code></pre><p>Now that's what I call working in comfort! Here it is in action:</p><p><img src="/images/2021/09/autocomplete.gif" alt=""></p><p>The best thing to do here is to simply try the autocomplete feature out for yourself - it's easiest to learn about it by doing. And that's it for this post!</p><p>In the next post, we take a look at output, and alternative formats.</p><hr><p><img src="/images/2021/02/screenshot-2021-02-22-at-11.00.25.png" alt=""></p><p>SAP Tech Bytes is an initiative to bring you bite-sized information on all manner of topics, in <a href="https://www.youtube.com/playlist?list=PL6RpkC85SLQC3HBShmlMaPu_nL--4f20z">video</a> and <a href="https://community.sap.com/t5/tag/sap-tech-bytes/tg-p">written</a> format. Enjoy!</p><hr><p><a href="https://community.sap.com/t5/technology-blogs-by-sap/sap-tech-bytes-btp-cli-autocompletion/ba-p/13503134">Originally published on SAP Community</a></p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/sapcommunity/">#sapcommunity</a> <a href="/tags/btp/">#btp</a> <a href="/tags/cli/">#cli</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2021/10/14/sourcing-vs-executing-in-bash/"><span>←</span> <span>Sourcing vs executing in Bash</span> </a><a href="/blog/posts/2021/09/15/using-functions-more/"><span>Using functions more</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="/tweets/">Tweet Archive</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a rel="me" href="https://bsky.app/profile/qmacro.org" target="_blank" rel="noopener noreferrer">Bluesky</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>