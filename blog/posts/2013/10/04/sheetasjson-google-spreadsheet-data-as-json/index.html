<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2013/10/04/sheetasjson-google-spreadsheet-data-as-json/"><link href="/assets/main.6972fce5fb2684e4524a.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>SheetAsJSON - Google Spreadsheet Data as JSON | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="SheetAsJSON - Google Spreadsheet Data as JSON"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2013/10/04/sheetasjson-google-spreadsheet-data-as-json/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@qmacro"><meta name="description" content="SheetAsJSON - Google Spreadsheet Data as JSON 04 Oct 2013 | 2 min read This is a short post to explain how to expose a &#39;typical&#39; Google..."><meta property="og:description" content="SheetAsJSON - Google Spreadsheet Data as JSON 04 Oct 2013 | 2 min read This is a short post to explain how to expose a &#39;typical&#39; Google..."><meta name="description" content="SheetAsJSON - Google Spreadsheet Data as JSON 04 Oct 2013 | 2 min read This is a short post to explain how to expose a &#39;typical&#39; Google..."><meta property="og:image" content="https://qmacro.org/images/DJA-head.png"><meta name="twitter:image" content="https://qmacro.org/images/DJA-head.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/talks">Talks</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>SheetAsJSON - Google Spreadsheet Data as JSON</h1><div class="post__details"><time datetime="2013-10-04">04 Oct 2013 </time><span>| </span><span>2 min read</span></div></header><main class="post__content"><p>This is a short post to explain how to expose a 'typical' Google spreadsheet (rows of columnar data, with first header row) as JSON, via HTTP. It might sound somewhat esoteric but believe me it’s helped me and others out quite a bit in the past.</p><p>If you’ve got a sheet and want to consume that from a web app, for example, via JSON or JSONP, or just want a different way of getting data out of a spreadsheet for further processing in the environment of your choice (that has a JSON parser) then this could be useful for you.</p><p>The idea is that you have a base URL and append a query string, supplying values for two parameters: the id of the spreadsheet and the name of the sheet within the spreadsheet. For example, for this sheet, the value for <code>id</code> would be</p><p>0AuAssa05Fog5dGc5WVNRbFZDcWJCLVY2V2NidWFKeXc</p><p>and the value for <code>sheet</code> would be</p><p>Sheet1</p><p><img src="//qmacro.org/content/images/2013/10/sheet1.png" alt=""></p><p>The exposure is via a Google Apps Script, which uses a couple of Apps Script APIs from the <a href="https://developers.google.com/apps-script/reference/spreadsheet/">Spreadsheet</a> and <a href="https://developers.google.com/apps-script/reference/content/">Content</a> services. The script, <a href="https://script.google.com/d/143u0RLuppsmYJ0B3wzo6i0jZYSfIFV2NLJMHPM-Sqczpr9bLwdffc-Wx/edit?usp=sharing">SheetAsJSON</a>, runs as a <a href="https://developers.google.com/apps-script/execution_web_apps">web app</a>, which puts a few requirements on the script itself.</p><p>It must implement a doGet method (for HTTP GET). It must be versioned (only versions of scripts can be deployed):</p><p><img src="//qmacro.org/content/images/2013/10/version.png" alt=""></p><p>It must also be deployed as a web app and made available for others (or just yourself) to execute:</p><p><img src="//qmacro.org/content/images/2013/10/deploy-268x300.png" alt=""></p><p>As you can see in the above screenshot, you also need to make sure the script is authorised to run. See the <a href="https://developers.google.com/apps-script/">Google Apps Script documentation</a> for more details.</p><p>The <a href="https://script.google.com/d/143u0RLuppsmYJ0B3wzo6i0jZYSfIFV2NLJMHPM-Sqczpr9bLwdffc-Wx/edit?usp=sharing">script source is here</a>, and contains just a handful of functions which I’ll briefly describe here.</p><p><strong>doGet</strong>: Creates a text output object, grabs the id and sheet query parameter values, opens the spreadsheet, reads the header and data records (via readData_), setting them as an array of objects in the data['records'] element, and then returns the content, pausing for a second only to work out whether JSONP or JSON was required, and returning the content and the content-type appropriately.</p><p><strong>readData_</strong>: Goes and reads the header row via getHeaderRow_, and then the data rows via getDataRows_. It replaces any whitespace in the header values with underscores.</p><p><strong>getHeaderRow_</strong>: Grabs the first row of the sheet, with the intention of treating the content of each cell in that row as the property names of the data objects.</p><p><strong>getDataRows_</strong>: Grabs the rest of the rows of the sheet, creating JavaScript objects with properties one for each column.</p><p>Yes, it’s perhaps over-simple in places, but it works for me, and may work for you too.</p><p>So with that in mind, let’s say we use the &quot;Typical Spreadsheet&quot; shown in the screenshot above, and take its id and the name of the first and only sheet. When we append the query parameters appropriately onto the web app’s URL for this particular instance of the script (mine), we get:</p><p><span style="color: #ff6600;">https://script.google.com/macros/s/AKfycbxOLElujQcy1-ZUer1KgEvK16gkTLUqYftApjNCM_IRTL3HSuDk/exec</span>?<span style="color: #339966;">id=0AuAssa05Fog5dGc5WVNRbFZDcWJCLVY2V2NidWFKeXc</span>&amp;<span style="color: #0000ff;">sheet=Sheet1</span></p><p>which will return this: <img src="//qmacro.org/content/images/2013/10/json.png" alt=""></p><p>Note that there’s a redirect which means the final URL you see in the URL bar is not the one above. Note also that the formatting in my browser is down to the great Chrome extension &quot;<a href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc?hl=en">JSONView</a>&quot;.</p><p>Share and enjoy!</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/appsscript/">#appsscript</a> <a href="/tags/contentservice/">#contentservice</a> <a href="/tags/google/">#google</a> <a href="/tags/json/">#json</a> <a href="/tags/jsonp/">#jsonp</a> <a href="/tags/spreadsheet/">#spreadsheet</a> <a href="/tags/spreadsheetservice/">#spreadsheetservice</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2013/11/27/sap-uk-and-ireland-user-group-conference-demo-jam!/"><span>←</span> <span>SAP UK &amp; Ireland User Group Conference - Demo Jam!</span> </a><a href="/blog/posts/2013/08/10/yrs2013-hacks-on-github/"><span>#YRS2013 Hacks on Github</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a href="https://twitter.com/qmacro" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>