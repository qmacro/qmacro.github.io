<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2013/10/17/mobile-dev-course-w3u3-rewrite-index-and-structure/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.4654d4542dcb045c9ba3.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Mobile Dev Course W3U3 Rewrite - Index and Structure | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Mobile Dev Course W3U3 Rewrite - Index and Structure"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2013/10/17/mobile-dev-course-w3u3-rewrite-index-and-structure/"><meta name="description" content="Mobile Dev Course W3U3 Rewrite - Index and Structure 17 Oct 2013 | 4 min read I rewrote the mobile dev course sample app from W3U3. This..."><meta property="og:description" content="Mobile Dev Course W3U3 Rewrite - Index and Structure 17 Oct 2013 | 4 min read I rewrote the mobile dev course sample app from W3U3. This..."><meta name="description" content="Mobile Dev Course W3U3 Rewrite - Index and Structure 17 Oct 2013 | 4 min read I rewrote the mobile dev course sample app from W3U3. This..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Mobile Dev Course W3U3 Rewrite - Index and Structure</h1><div class="post__details"><time datetime="2013-10-17">17 Oct 2013 </time><span>| </span><span>4 min read</span></div></header><main class="post__content"><p>I <a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">rewrote the mobile dev course sample app from W3U3</a>. This post explains what I changed in the index.html file, and why. It also takes a look at the general app structure of directories and files.</p><p>First, I'll take the lines of the new version of index.html chunk-by-chunk, with comments.</p><h2>index.html</h2><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>W3U3 Redone Basic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></code></pre><p>There's an important meta tag that I added, the X-UA-Compatible one. This is to give IE the best chance of running SAPUI5 properly. Without this there could be rendering issues in IE. (Of course, the alternative is to stop using IE altogether, but that's a different debate!)</p><pre class="language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://sapui5.hana.ondemand.com/sdk/resources/sap-ui-core.js<span class="token punctuation">"</span></span><br>        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><br>        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sap-ui-bootstrap<span class="token punctuation">"</span></span><br>        <span class="token attr-name">data-sap-ui-libs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sap.m<span class="token punctuation">"</span></span><br>        <span class="token attr-name">data-sap-ui-xx-bindingSyntax</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>complex<span class="token punctuation">"</span></span><br>        <span class="token attr-name">data-sap-ui-theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sap_bluecrystal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>Here in the bootstrap tag I'm specifying the complex binding syntax, which I'll be using later on (in the ProductDetail view, to fix a problem with the product image URL). I'm also specifying the Blue Crystal theme (sap_bluecrystal), rather than the Mobile Visual Identity theme (sap_mvi).</p><pre class="language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>        jQuery<span class="token punctuation">.</span>sap<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">setLevel</span><span class="token punctuation">(</span>jQuery<span class="token punctuation">.</span>sap<span class="token punctuation">.</span>log<span class="token punctuation">.</span>LogLevel<span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        jQuery<span class="token punctuation">.</span>sap<span class="token punctuation">.</span><span class="token function">registerModulePath</span><span class="token punctuation">(</span><span class="token string">"com.opensap"</span><span class="token punctuation">,</span> <span class="token string">"./myapp/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"idAppView"</span><span class="token punctuation">,</span> <span class="token string">"com.opensap.App"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeAt</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>This is where you'll see the biggest change in this file. The open.sap.com course version has a ton of &lt;script&gt; tags (12, to be precise) to load every single file in the app, including some that aren't even necessary. This is simply ignoring the automatic module loading mechanism that is built into SAPUI5. The mechanism not only allows you to avoid a sea of &lt;script&gt; tags, it also allows you to organise your app's resources in a clean and efficient way, refer to them semantically rather than physically, and have load-on-demand features too.</p><p>Here, we're saying &quot;modules that begin with 'com.opensap' can be found in the 'myapp' directory below where we are&quot;. And then we use that module loading system directly by asking for the instantiation of the &quot;com.opensap.App&quot; view (giving it an id of &quot;idAppView&quot;) before having it rendered in the main &lt;div&gt; tag (see below).</p><p>Also note the use of the jQuery.sap.log.* functions for console logging. This abstracts the logging mechanism so you don't have to think about whether console.log works in a particular browser properly (yes IE, I'm looking at you again).</p><pre class="language-html"><code class="language-html">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sapUiBody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Instantiating the view, which has an associated controller with an onInit function, is also a better way, or at least a more SAPUI5-way, to kick off processing, rather than have a function referred to in the onload attribute of the &lt;body&gt; tag, as the open.sap.com course version of the app does. So this is how we're doing it here. The sap.ui.jsview call causes that view's controller's onInit function to run, rather than having an onload=&quot;initializeModel()&quot; in the &lt;body&gt; tag.</p><h2>Files and app organisation</h2><p>This post is also probably the best place to cover the app's organization and files, so I'll do that here as well. First, I'll show you what the original open.sap.com version looks like, then I'll show you what this new version looks like.</p><p><img src="/images/2013/10/originalstructure.png" alt="Original version"></p><p>Here we see first of all that the views and controllers are split into separate directories. This isn't wrong, it just feels a little odd. So in the new version I've put the view/controller pairs together in a &quot;myapp&quot; directory.</p><p>More disconcerting is the model/modeljs file. The fact that the file is in a directory called &quot;model&quot; suggests that it has something to do with data. But when we look into the file there is some data-relevant stuff (creating a JSON model and setting it on the core) but there's also some view instantiation and placement for rendering. This is not ideal. It's not a problem that the model file is a script (when you're building JSON-based model data manually it's often useful to be able to construct properties and values dynamically), but I do have a problem with the mix of concerns.</p><p>There's often a js directory when the app requires 3rd party libraries that have functionality that SAPUI5 does not provide. These three files (Base64.js, datajs-1.1.1.js and SMPCloudHTTPClient.js) do not fall into this category, and don't belong here. In fact, this whole directory and its contents is not required:</p><p>Base64.js is used in the original version to encode a Basic Authentication username / password combination. As you'll see, this is very manual and not necessary. The datajs-1.1.1.js library is a specific version of the OData library. SAPUI5 speaks OData natively and does not need an extra library; indeed, the inclusion of a specific version like this may clash with the one that SAPUI5 supplies and uses internally. The SMPCloudHTTPClient.js here is used to create a new client object that includes the Application Connection ID (APPCID) header on requests to the SMP server. As you'll see in an upcoming post that looks more closely at the use and abuse of the OData modelling in the app, you'll see that this is also not necessary.</p><p><img src="/images/2013/10/newstructure.png" alt="Rewritten version"></p><p>As you can see, the rewritten version is smaller, doesn't have extraneous and unnecessary libraries and has the view and controller pairs in one directory (&quot;myapp&quot;, referred to in the module loading mechanism in the index.html file earlier).</p><p>It also has a 'real' model file that just has data in it - <a href="https://github.com/qmacro/w3u3_redonebasic/blob/master/model/app.json">app.json</a>. This data is just information about the relationship with the app backend on the SMP server and is very similar to the intention of the original version.</p><p>So, that's it for the index and app organisation. Have a look for yourself at the original and new versions of the index.html and model files, and compare them alongside this description here.</p><p>See the end of the initial post &quot;<a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">Mobile Dev Course W3U3 Rewrite - Intro</a>&quot; for links to all the parts in this series.</p><p>Until next time, share &amp; enjoy!</p><p><a href="https://blogs.sap.com/2013/10/17/mobile-dev-course-w3u3-rewrite-indexhtml/">Originally published on SAP Community</a></p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/sapcommunity/">#sapcommunity</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2013/10/18/mobile-dev-course-w3u3-rewrite-app-and-login/"><span>←</span> <span>Mobile Dev Course W3U3 Rewrite - App and Login</span> </a><a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/"><span>Mobile Dev Course W3U3 Rewrite - Intro</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>