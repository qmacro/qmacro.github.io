<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Mobile Dev Course W3U3 Rewrite - App and Login</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		
	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="mobile-dev-course-w3u3-rewrite-app-and-login">Mobile Dev Course W3U3 Rewrite - App and Login</h1>

<ul class="post-metadata">
	<li><time datetime="2013-10-18">18 October 2013</time></li>
	<li><a href="/tags/sapcommunity/" class="post-tag">sapcommunity</a></li>
</ul>

<p class="post-description-main"></p>

<p>I <a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">rewrote the mobile dev course sample app from W3U3</a>. This post explains what I changed in the App and Login views / controllers. See the links at the bottom of the <a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">opening post</a> to get to explanations for the other areas.</p>
<h2 id="app">App</h2>
<p>In the index.html, we instantiated the App view, which is a JavaScript view. The view has a corresponding controller and they look like this.</p>
<h3 id="app-view-js">App.view.js</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"com.opensap.App"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getControllerName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"com.opensap.App"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">createContent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oController</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> oApp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>App</span><span class="token punctuation">(</span><span class="token string">"idApp"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">pages</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"Login"</span><span class="token punctuation">,</span> <span class="token string">"com.opensap.Login"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"ProductList"</span><span class="token punctuation">,</span> <span class="token string">"com.opensap.ProductList"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"ProductDetail"</span><span class="token punctuation">,</span> <span class="token string">"com.opensap.ProductDetail"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"SupplierDetail"</span><span class="token punctuation">,</span> <span class="token string">"com.opensap.SupplierDetail"</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> oApp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>This is actually not too far from the original version. However, it is much shorter, as it takes advantage of the pages aggregation property of the App control, and sticks the views straight in there. This is much quicker and neater than the slightly pedestrian way it is done in the original version. Also, there is no need to navigate explicitly to Login (this.app.to(&quot;Login&quot;)) as the first control in the aggregation will be the default anyway.</p>
<h3 id="app-controller-js">App.controller.js</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">"com.opensap.App"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>

    <span class="token function-variable function">onInit</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">getCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setModel</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>json<span class="token punctuation">.</span>JSONModel</span><span class="token punctuation">(</span><span class="token string">"model/app.json"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The App controller is even smaller, and uses the onInit event to create the JSON model that will hold the data about the application connection (this was mentioned in the <a href="/blog/posts/2013/10/17/mobile-dev-course-w3u3-rewrite-index-and-structure/">Index &amp; Structure post</a>).</p>
<p>Note that rather than having one single model in the app that holds all sorts of unrelated data, as it is done in the original version (there's a single JSON model for everything, and that's it), I am using setModel's optional second parameter, to specify a name (&quot;app&quot;) for the model. This way it becomes a &quot;named model&quot; and is not the default (where no name is specified). You'll see later that references to properties in named models are prefixed with the name and a &quot;&gt;&quot; symbol, like this: &quot;{app&gt;/ES1Root}&quot;.</p>
<p>The original App controller had empty onInit, onBeforeShow and navButtonTap events, which I have of course left out here (I'm guessing they might have come from a controller template and left in there).</p>
<h2 id="login">Login</h2>
<p>So the App view is used as a container, that has navigation capabilities (it actually inherits from NavContainer); it doesn't have any direct visible elements of its own. Instead, the &quot;pages&quot; aggregation is what holds the content entities, and the first one in there is the one that's shown by default. In this case it's Login.</p>
<p>The Login view and its corresponding controller are somewhat more involved, so let's take a look at the rewritten version step by step.</p>
<h3 id="login-view-js">Login.view.js</h3>
<p>The view itself is fairly self explanatory and doesn't differ too much from the original. There are however a couple of things I want to point out before moving on to the controller.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"com.opensap.Login"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>

    <span class="token function-variable function">getControllerName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"com.opensap.Login"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function-variable function">createContent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oController</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Login"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">showNavButton</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token literal-property property">footer</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Bar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">contentMiddle</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"Login"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">press</span><span class="token operator">:</span> <span class="token punctuation">[</span>oController<span class="token punctuation">.</span>loginPress<span class="token punctuation">,</span> oController<span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>InputListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Username"</span><span class="token punctuation">,</span>
                            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Input</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{app>/Username}"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>InputListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Password"</span><span class="token punctuation">,</span>
                            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Input</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{app>/Password}"</span><span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>InputType<span class="token punctuation">.</span>Password <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>First is the use of the press event on the Button control. The tap event (used in the original version of the app) <a href="https://sapui5.hana.ondemand.com/sdk/#docs/api/symbols/sap.m.Button.html#event:tap">is deprecated</a>. You will see that throughout the app I've replaced the use of 'tap' with 'press'.</p>
<p>Also, note how the handler is specified for the press event in the construction of the Button: [fnListenerFunction, oListenerObject] (and it's the same in the original). This form allows you to specify, as the second oListenerObject parameter, the context which 'this' will have in the fnListenerFunction handler. In other words, doing it this way will mean that when you refer to 'this' in your handler, it will do what you probably expect and refer to the controller.</p>
<p>Then we have the construction of the values for the Input controls. Because I loaded the data about the application connection into a named model (to keep that separate from the main business data) I have to prefix the model properties with &quot;app&gt;&quot; as mentioned above.</p>
<h3 id="login-controller-js">Login.controller.js</h3>
<p>So now we'll have a look at the Login controller, and if you compare this new version with the original, you'll see that there are a number of differences.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">"com.opensap.Login"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>

    <span class="token literal-property property">oSMPModel</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></code></pre>
<p>As described in the course, this app needs to create a connection with the SMP server. The API with which to do that is OData-based - an OData service at the address</p>
<pre class="language-url" tabindex="0"><code class="language-url"><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">smp-</span></span>&lt;your-id>trial.hanatrial.ondemand.com/odata/applications/latest/&lt;your-app-name>/</code></pre>
<p>and as you saw in this unit (W3U3) we need to perform an OData &quot;create&quot; operation on the Connections collection to create a new Connection entity. So to do this, I'm using a model to represent the OData service, and I'm storing it singularly in the controller - we don't need to set the model anywhere on the control tree, the create operation is just to make the connection and get the application connection ID (APPCID).</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">    <span class="token function-variable function">loginPress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">var</span> oAppData <span class="token operator">=</span> sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">getCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>oSMPModel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>oSMPModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>odata<span class="token punctuation">.</span>ODataModel</span><span class="token punctuation">(</span>
                oAppData<span class="token punctuation">.</span>BaseURL <span class="token operator">+</span> <span class="token string">"/odata/applications/latest/"</span> <span class="token operator">+</span> oAppData<span class="token punctuation">.</span>AppName
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<p>When the login button is pressed we use the application data (from model/app.json, stored in the named &quot;app&quot; model) to construct the URL of the SMP connections OData service and create an OData model based on that.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">        <span class="token keyword">this</span><span class="token punctuation">.</span>oSMPModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'/Connections'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">DeviceType</span><span class="token operator">:</span> <span class="token string">"Android"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
            jQuery<span class="token punctuation">.</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mResult</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                localStorage<span class="token punctuation">[</span><span class="token string">'APPCID'</span><span class="token punctuation">]</span> <span class="token operator">=</span> mResult<span class="token punctuation">.</span>ApplicationConnectionId<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showProducts</span><span class="token punctuation">(</span>mResult<span class="token punctuation">.</span>ApplicationConnectionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            jQuery<span class="token punctuation">.</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                jQuery<span class="token punctuation">.</span>sap<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Connection creation failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// Bypass if we already have an id</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">an application connection with the same id already exists</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>oError<span class="token punctuation">.</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    jQuery<span class="token punctuation">.</span>sap<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Bypassing failure: already have a connection"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showProducts</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">[</span><span class="token string">'APPCID'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre>
<p>Now we have this SMP model, performing the OData create operation (an HTTP POST request), sending the appropriate entity payload, is as simple as</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>oSMPModel<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'/Connections'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">DeviceType</span><span class="token operator">:</span> <span class="token string">'Android'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> …<span class="token punctuation">)</span></code></pre>
<p>That's it. We just catch the APPCID from the result object and here we're storing it in localStorage on the browser. This is a small workaround to the problem with the original app where you had to delete the connection from the SMP Admin console each time. The failure case being handled here is where we are told that an application connection already exists … if that's the case then we just grab what we have in localStorage and use that.</p>
<p>Unlike the original app version, we're not interested in actually storing any results so there's no need to add it to the model. By the way, if you look at how the APPCID is added to the model in the original app version, there's a pattern used which goes generally like this:</p>
<ol>
<li><code>var oData = sap.ui.getCore().getModel().getData();</code></li>
<li><code>oData.someNewProperty = &quot;value&quot;;</code></li>
<li><code>sap.ui.getCore().getModel().setData(oData);</code></li>
</ol>
<p>If you find yourself doing this, take a look at the <a href="https://sapui5.hana.ondemand.com/sdk/#docs/api/symbols/sap.ui.model.json.JSONModel.html#setData">optional second bMerge parameter of setData</a>. It uses jQuery.extend() and it might be what you're looking for - it will allow you to simply do this:</p>
<ol>
<li><code>sap.ui.getCore().getModel().setData({someNewProperty: &quot;value&quot;}, true);</code></li>
</ol>
<p>Anyway, we get the APPCID back from the SMP's OData service and then call showProducts (below) to actually start bringing in the business data and showing it.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">    <span class="token function-variable function">showProducts</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">sAPPCID</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> oAppData <span class="token operator">=</span> sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">getCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModel</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> oModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>odata<span class="token punctuation">.</span>ODataModel</span><span class="token punctuation">(</span>
            oAppData<span class="token punctuation">.</span>BaseURL <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> oAppData<span class="token punctuation">.</span>AppName<span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token string-property property">'X-SUP-APPCID'</span><span class="token operator">:</span> sAPPCID <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">getCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setModel</span><span class="token punctuation">(</span>oModel<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> oApp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oApp<span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"ProductList"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The showProducts function creates a new model. Yes, another one. This time, it's a model for the business data, available at the <a href="https://sapes1.sapdevcenter.com/sap/opu/odata/sap/ZGWSAMPLE_SRV">OData service</a> that was described in the course and is proxied behind the SMP service. So first we use the application data in the &quot;app&quot; model to construct the proxy URL, which will be something like this:</p>
<pre class="language-url" tabindex="0"><code class="language-url"><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">smp-</span></span>&lt;your-id>trial.hanatrial.ondemand.com/&lt;your-app-name>/</code></pre>
<p>But then notice that we don't do anything manually, unlike the original app. We don't specify the HTTP method (GET) and we don't make any explicit calls (like OData.read). We just create a new OData model, specifying the service URL, and an additional object containing custom headers that we want sent on every call. The header we want is of course the X-SUP-APPCID so that's what we specify. From them on we just let the model do the work for us.</p>
<p>What we certainly don't do here, which was done in the original app, is call OData.read (which, incidentally, <a href="https://sapui5.hana.ondemand.com/sdk/#docs/api/symbols/sap.ui.model.odata.ODataModel.html#read">doesn't store the returned data in the model</a>), and then manually shovel the raw JSON (the OData comes back as a JSON representation) into a single, central JSON model. There's no need, and this is really mixing up different mechanisms: OData and its corresponding model, JSON and its corresponding model, and their respective ways of working.</p>
<p>So you'll see, there are no explicit calls (HTTP requests) made for the business data. And you'll see that this hold true throughout the app (e.g. also later when we navigate from the ProductDetail view to the SupplierDetail view, following a navigation property). And remember, as described in the <a href="/blog/posts/2013/10/17/mobile-dev-course-w3u3-rewrite-index-and-structure/">Index &amp; Structure</a> post in this series, there is no explicit external OData library (the original app had brought in datajs-1.1.1.js as a 3rd party library) - the SAPUI5 framework takes care of this for you.</p>
<p>Ok, well that's it for this post.</p>
<p>See the end of the initial post &quot;<a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">Mobile Dev Course W3U3 Rewrite - Intro</a>&quot; for links to all the parts in this series.</p>
<p>Share &amp; enjoy!</p>
<p><a href="https://blogs.sap.com/2013/10/18/mobile-dev-course-w3u3-rewrite-app-login/">Originally published on SAP Community</a></p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2013/10/17/mobile-dev-course-w3u3-rewrite-index-and-structure/">Mobile Dev Course W3U3 Rewrite - Index and Structure</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2013/10/18/mobile-dev-course-w3u3-rewrite-productlist-productdetail-and-supplierdetail/">Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2013/10/18/mobile-dev-course-w3u3-rewrite-app-and-login/` was built on 2025-09-16T07:53:06.959Z -->
		<script type="module" src="/dist/xbxy_EL6cU.js"></script>
	</body>
</html>
