<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://qmacro.org/blog/posts/2013/10/18/mobile-dev-course-w3u3-rewrite-productlist-productdetail-and-supplierdetail/"><link rel="alternate" type="application/atom+xml" title="DJ's Weblog - Feed" href="https://qmacro.org/feed.xml"><link href="/assets/main.bed7db4098e5e4fe9224.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail | DJ Adams</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail"><meta property="og:site_name" content="DJ Adams"><meta property="og:type" content="website"><meta property="og:url" content="https://qmacro.org/blog/posts/2013/10/18/mobile-dev-course-w3u3-rewrite-productlist-productdetail-and-supplierdetail/"><meta name="description" content="Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail 18 Oct 2013 | 6 min read I rewrote the mobile dev course..."><meta property="og:description" content="Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail 18 Oct 2013 | 6 min read I rewrote the mobile dev course..."><meta name="description" content="Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail 18 Oct 2013 | 6 min read I rewrote the mobile dev course..."><meta property="og:image" content="https://qmacro.org/images/site-image.png"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-4WQKBG0L4Y');</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/">DJ Adams</a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/about">About Me</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/feed.xml">Feed</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Mobile Dev Course W3U3 Rewrite - ProductList, ProductDetail and SupplierDetail</h1><div class="post__details"><time datetime="2013-10-18">18 Oct 2013 </time><span>| </span><span>6 min read</span></div></header><main class="post__content"><p>I <a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">rewrote the mobile dev course sample app from W3U3</a>. This post explains what I changed in the ProductList, ProductDetail and SupplierDetail views / controllers. See the links at the bottom of the <a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">opening post</a> to get to explanations for the other areas.</p><h2>ProductList</h2><p>If you remember back to the Login controller (described in the previous post in this series) we arrive at the ProductList view after successfully logging in, creating the OData model for the business available at the OData service, and performing a move from the Login page to this ProductList page with oApp.to(&quot;ProductList&quot;), the navigation mechanism that is available in the App control, inherited from NavContainer.</p><h3>ProductList.view.js</h3><p>Here's what the ProductList view looks like.</p><pre class="language-javascript"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"com.opensap.ProductList"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br><br>    <span class="token function-variable function">getControllerName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token string">"com.opensap.ProductList"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br><br>    <span class="token function-variable function">createContent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oController</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><br>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Page</span><span class="token punctuation">(</span><span class="token string">"ProductPage"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Products"</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                    <span class="token literal-property property">headerText</span><span class="token operator">:</span> <span class="token string">"Product Overview"</span><span class="token punctuation">,</span><br>                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/ProductCollection"</span><span class="token punctuation">,</span><br>                        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>StandardListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"{Name}"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"{Description}"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">type</span><span class="token operator">:</span> sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>ListType<span class="token punctuation">.</span>Navigation<span class="token punctuation">,</span><br>                            <span class="token literal-property property">press</span><span class="token operator">:</span> <span class="token punctuation">[</span>oController<span class="token punctuation">.</span>handleProductListItemPress<span class="token punctuation">,</span> oController<span class="token punctuation">]</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">]</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Like the previous views, this isn't actually much different from the original version. I've left out stuff that wasn't needed, and in particular the icon property of each StandardListItem was pointing at the wrong model property name, resulting in no icon being shown in the list. I've removed the icon* properties as well as a couple of list properties (inset and type).</p><p>What I have done, though, mostly for fun, is to write the createContent function as a single statement. This in contrast to the multiple statements in the original, but perhaps more interestingly, the whole thing looks more declarative than imperative. This will come into play when we eventually look at declarative views in XML, which are actually my prefererence, and arguably the neatest and least amount of typing … which might surprise you. Anyway, more on that another time.</p><h3>ProductList.controller.js</h3><p>The ProductList controller is very simple; all it has to do is handle the press of the StandardListItem (see the press event specification in the view above).</p><pre class="language-javascript"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">"com.opensap.ProductList"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">handleProductListItemPress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"ProductDetail"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>            <span class="token literal-property property">context</span><span class="token operator">:</span> oEvent<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBindingContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Again, I've left out the empty boilerplate code from the original, and am just doing what's required, nothing more: getting the binding context of the source of the event (the particular StandardListItem that was pressed), and passing that in the navigation to the ProductDetail page.</p><blockquote><p>Note that I've been sort of interchanging the word page and view here and earlier. This is in relation to the App control, which has a 'pages' aggregation from the NavContainer control. As the documentation states, you don't have to put Page controls into this pages aggregation, you can put other controls that have a fullscreen semantic, and one of those possible controls is a View.</p></blockquote><h2>ProductDetail</h2><p>So we've navigated from the ProductList to the ProductDetail by selecting an item in the List control, and having that item's binding context (related to the OData model) passed to us. Here's what the view looks like.</p><pre class="language-javascript"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"com.opensap.ProductDetail"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">getControllerName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token string">"com.opensap.ProductDetail"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function-variable function">onBeforeShow</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oEvent<span class="token punctuation">.</span>data<span class="token punctuation">.</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setBindingContext</span><span class="token punctuation">(</span>oEvent<span class="token punctuation">.</span>data<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p>So in the ProductDetail view, where we want to simply show more detail about that particular Product entity, we first make sure that the passed context is bound (to the view).</p><pre class="language-javascript"><code class="language-javascript">  <span class="token function-variable function">createContent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oController</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><br>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"{Name}"</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">showNavButton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">navButtonPress</span><span class="token operator">:</span> <span class="token punctuation">[</span>oController<span class="token punctuation">.</span>handleNavButtonPress<span class="token punctuation">,</span> oController<span class="token punctuation">]</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>DisplayListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Name"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{Name}"</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>DisplayListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Description"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{Description}"</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>DisplayListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Price"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{Price} {CurrencyCode}"</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>StandardListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Supplier"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"{SupplierName}"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">type</span><span class="token operator">:</span> sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>ListType<span class="token punctuation">.</span>Navigation<span class="token punctuation">,</span><br>                            <span class="token literal-property property">press</span><span class="token operator">:</span> <span class="token punctuation">[</span>oController<span class="token punctuation">.</span>handleSupplierPress<span class="token punctuation">,</span> oController<span class="token punctuation">]</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">]</span><br>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>VBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                    <span class="token literal-property property">alignItems</span><span class="token operator">:</span> sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>FlexAlignItems<span class="token punctuation">.</span>Center<span class="token punctuation">,</span><br>                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Image</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">"{app>/ES1Root}{ProductPicUrl}"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">decorative</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">densityAware</span><span class="token operator">:</span> <span class="token boolean">false</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">]</span><br>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">]</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Once that's done, all we have to do is fill out the createContent function, which again is very similar to the original. Note that here I'm using two model properties together for the value of the &quot;Price&quot; item to show a currency value and code.</p><p>In the original version, there was some custom data attached to the Supplier item - specifically the SupplierId property from the Product. This was used, in the controller, to manually (and somewhat &quot;bluntly&quot;) construct an OData Entity URL for subsequent (manual) retrieval. Of couse, you might have guessed by now what I'm going to say. Not necessary at all. More on this shortly. But it's worth pointing out that the attaching of the custom data is quite a useful and widely available facility in general. It's widely available because it's part of the Element class, from which, ultimately, all controls inherit. So you can attach custom data in name/value pairs to any control you wish, more or less.</p><p>Finally, let's have a quick look at that VBox control containing the product image. I took a lead from the original app and decided to prefix the relative URL (which is what is contained in the ProductPicUrl property) with the generic (non-SMP-proxied) 'sapes1' URL base. And to achieve this prefixing I just concatenated a couple of model properties - one from the named &quot;app&quot; model (the ES1Root) and the other being the actual image relative URL.</p><p>Ok, let's have a look at the rewritten controller.</p><h3>ProductDetail.controller.js</h3><pre class="language-javascript"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">"com.opensap.ProductDetail"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">handleNavButtonPress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br><br>    <span class="token function-variable function">handleSupplierPress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"SupplierDetail"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>            <span class="token literal-property property">context</span><span class="token operator">:</span> oEvent<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBindingContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>As well as the back navigation, we have the handling of the press of the Supplier item in the ProductDetail view. This should take us to the SupplierDetail view to show us more information about the supplier.</p><p>So before we think about how we make this work, let's pause for a second and consider the business data that we're consuming through the OData service.</p><h2>OData Model and Service</h2><p>We have, in the OData service originating at <a href="https://sapes1.sapdevcenter.com/sap/opu/odata/sap/ZGWSAMPLE_SRV/">https://sapes1.sapdevcenter.com/sap/opu/odata/sap/ZGWSAMPLE_SRV/</a>, a number of EntitySets, or 'collections', including the <a href="https://sapes1.sapdevcenter.com/sap/opu/odata/sap/ZGWSAMPLE_SRV/BusinessPartnerCollection?sap-ds-debug=true">BusinessPartnerCollection</a> and the <a href="https://sapes1.sapdevcenter.com/sap/opu/odata/sap/ZGWSAMPLE_SRV/ProductCollection?sap-ds-debug=true">ProductCollection</a> - both of which have entities that we're interested in for our app. We start out with the ProductCollection, display a list, pick a specific product for more detail, and then go to the supplier for that product. If you look at the OData metadata for this service, you'll see that in the definition of the Product entity, there's a navigation property that will take us directly from the product entity to the related business partner entity. How useful is that? Yes, very! So let's use it.</p><p><img src="/images/2013/10/navprop.jpg" alt=""></p><p>Before we look at how we use it, let's review how the original app was doing things here to go from the selected product detail to the supplier. In the supplierTap function of the original ProductDetail controller, the OData.read function was called explicitly (ouch), on a manually constructed OData URL (ouch), which abruptly jumped straight to the BusinessPartnerCollection, ignoring this navigation feature (double-ouch). The supplier's ID (which had been squirrelled away in the custom data as mentioned earlier) was specified directly, as a key predicate, and a JSON representation was requested:</p><pre class="language-javascript"><code class="language-javascript">OData<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"https://sapes1.devcenter.com/sap/opu/odata/sap/ZGWSAMPLE_SRV/BusinessPartnerCollection('"</span> <span class="token operator">+</span> supplierId <span class="token operator">+</span> <span class="token string">"')?$format=json"</span><span class="token punctuation">,</span> …<span class="token punctuation">)</span></code></pre><p>Yes, you can guess the next bit 🙂 The JSON data was passed directly to the next view, bypassing any semblance of OData model usage. Ouch. I guess this also bypasses the SMP URL rewriting security and should have really been the SMP-based URL. And ouch.</p><p>So how did we do it here? Well, just by passing the context of the selected product, as usual. Just like we did when we went from the ProductList view to the ProductDetail view. And then following on from that in the SupplierDetail view with a reference to the relative 'Supplier' entity.</p><h2>SupplierDetail</h2><h3>SupplierDetail.view.js</h3><p>Ok, so here's the view.</p><pre class="language-javascript"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">jsview</span><span class="token punctuation">(</span><span class="token string">"com.opensap.SupplierDetail"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">getControllerName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token string">"com.opensap.SupplierDetail"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function-variable function">onBeforeShow</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oEvent<span class="token punctuation">.</span>data<span class="token punctuation">.</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setBindingContext</span><span class="token punctuation">(</span>oEvent<span class="token punctuation">.</span>data<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token function-variable function">createContent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oController</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> oPage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"{CompanyName}"</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">showNavButton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">navButtonPress</span><span class="token operator">:</span> <span class="token punctuation">[</span>oController<span class="token punctuation">.</span>handleNavButtonPress<span class="token punctuation">,</span> oController<span class="token punctuation">]</span><span class="token punctuation">,</span><br>            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>DisplayListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Company Name"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{CompanyName}"</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>DisplayListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Web Address"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{WebAddress}"</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>DisplayListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>                            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token string">"Phone Number"</span><span class="token punctuation">,</span><br>                            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">"{PhoneNumber}"</span><br>                        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">]</span><br>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">]</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        oPage<span class="token punctuation">.</span><span class="token function">bindElement</span><span class="token punctuation">(</span><span class="token string">"Supplier"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> oPage<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This view looks pretty normal and doesn't differ much from the original. We have the onBeforeShow and the createContent. But the key line is this:</p><pre class="language-javascript"><code class="language-javascript">oPage<span class="token punctuation">.</span><span class="token function">bindElement</span><span class="token punctuation">(</span><span class="token string">"Supplier"</span><span class="token punctuation">)</span></code></pre><p>At the point that this is invoked, there's already the binding context that refers to the specific product previously chosen, say, like this:</p><pre class="language-url"><code class="language-url"><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">sapes1.sapdevcenter.com</span></span><span class="token path"><span class="token path-separator">/</span>sap<span class="token path-separator">/</span>opu<span class="token path-separator">/</span>odata<span class="token path-separator">/</span>sap<span class="token path-separator">/</span>ZGWSAMPLE_SRV<span class="token path-separator">/</span>ProductCollection('HT-1007')</span></code></pre><p>(I'm using the 'sapes1' link rather than the SMP-rewritten one here so you can navigate them from here and have a look manually if you want.)</p><p>Following the navigation property mentioned earlier, to the supplier (the entity in the BusinessPartnerCollection) is simply a matter, OData-wise, of extending the path to navigate to the supplier, like this:</p><pre class="language-url"><code class="language-url"><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">sapes1.sapdevcenter.com</span></span><span class="token path"><span class="token path-separator">/</span>sap<span class="token path-separator">/</span>opu<span class="token path-separator">/</span>odata<span class="token path-separator">/</span>sap<span class="token path-separator">/</span>ZGWSAMPLE_SRV<span class="token path-separator">/</span>ProductCollection('HT-1007')<span class="token path-separator">/</span>Supplier</span></code></pre><p>So in OData terms, we're navigating. And in path terms, we're going to a relative &quot;Supplier&quot;, which is exactly what we're doing with the oPage.bindElement(&quot;Supplier&quot;). The bindElement mechanism, when called on an entity in an OData model, triggers an automatic OData &quot;read&quot; operation, i.e. an HTTP GET request, and updates the model. Bingo!</p><p>Looking at the Network tab of Chrome Developer Tools, this is what we see happens:</p><p><img src="/images/2013/10/calls.jpg" alt=""></p><p>The first call (ProductCollection?$skip…) was for the initial binding to &quot;/ProductCollection&quot; in the ProductList view. Then a product HT-1007 was selected, the App navigated to the ProductDetail view, and then the supplier item was pressed. And when the bindElement in the SupplierDetail view was called, this triggered the last call in the screenshot - to &quot;Supplier&quot;, relative to ProductCollection('HT-1007').</p><p>All automatic and comfortable!</p><h3>SupplierDetail.controller.js</h3><pre class="language-javascript"><code class="language-javascript">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">"com.opensap.SupplierDetail"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">handleNavButtonPress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>Let's finish off with a quick look at the corresponding controller for this view. It doesn't have much work to do - just navigate back when the nav button is pressed. And it's very similar to the original.</p><p>So there we have it. Embrace SAPUI5 and its myriad features (automatic module loading, well thought out controls, OData models, and more) and have fun building apps.</p><p>That's draws this series to an end. Thanks for reading. The link to the Github repo where the rewritten app can be found is in the <a href="/blog/posts/2013/10/16/mobile-dev-course-w3u3-rewrite-intro/">original post in this series</a>, and also here: <a href="https://github.com/qmacro/w3u3_redonebasic">https://github.com/qmacro/w3u3_redonebasic</a>.</p><p>Share &amp; enjoy!</p><p><a href="https://blogs.sap.com/2013/10/18/mobile-dev-course-w3u3-rewrite-productlist-productdetail/">Originally published on SAP Community</a></p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/sapcommunity/">#sapcommunity</a></div><style>.utterances {
  margin-left: inherit !important;
}</style><script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async></script><nav class="post__pagination"><a href="/blog/posts/2013/11/19/mobile-dev-course-w3u3-rewrite-xml-views-an-intro/"><span>←</span> <span>Mobile Dev Course W3U3 Rewrite - XML Views - An Intro</span> </a><a href="/blog/posts/2013/10/18/mobile-dev-course-w3u3-rewrite-app-and-login/"><span>Mobile Dev Course W3U3 Rewrite - App and Login</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a rel="me" href="https://github.com/qmacro" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a rel="me" href="https://www.youtube.com/djadams-qmacro" target="_blank" rel="noopener noreferrer">YouTube</a></li><li><a rel="me" href="https://www.linkedin.com/in/djadams/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a rel="me" href="https://hachyderm.io/@qmacro" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>