<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Custom Sorting and Grouping</title>
		<meta name="description" content="Reserving the right to be wrong.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">

      <meta property="og:title" content="Custom Sorting and Grouping">
        <meta property="og:site_name" content="DJ Adams">
          <meta property="og:image" content="/images/site-image.png">
        <meta property="og:description" content="Reserving the right to be wrong.">
        <meta property="og:url" content="https://qmacro.org/blog/posts/2013/11/29/custom-sorting-and-grouping/">
		
		
		
		<style>/* This is an arbitrary CSS string added to the bundle */
/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color: #fff;

	--text-color: var(--color-gray-90);
	--text-color-link: #2884d2;
	--text-color-link-active: #15b0ed;
	--text-color-link-visited: #9f4199;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--background-color: #15202b;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

@view-transition {
	navigation: auto;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden:not(:focus):not(:active) {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Fluid images via https://www.zachleat.com/web/fluid-images/ */
img{
  max-width: 100%;
}
img[width][height] {
  height: auto;
}
img[src$=".svg"] {
  width: 100%;
  height: auto;
  max-width: none;
}
video,
iframe {
	width: 100%;
	height: auto;
}
iframe {
	aspect-ratio: 16/9;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main,
footer {
	padding: 1rem;
}
/* main :first-child { */
/* 	margin-top: 0; */
/* } */

header {
	border-bottom: 1px dashed var(--color-gray-20);
}

#skip-link {
	text-decoration: none;
	background: var(--background-color);
	color: var(--text-color);
	padding: 0.5rem 1rem;
	border: 1px solid var(--color-gray-90);
	border-radius: 2px;
}

/* Prevent visually-hidden skip link fom pushing content around when focused */
#skip-link.visually-hidden:focus {
	position: absolute;
	top: 1rem;
	left: 1rem;
	/* Ensure it is positioned on top of everything else when it is shown */
	z-index: 999;
}

.links-nextprev {
	display: flex;
	justify-content: space-between;
	gap: .5em 1em;
	list-style: "";
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}
.links-nextprev > * {
	flex-grow: 1;
}
.links-nextprev-next {
	text-align: right;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
	color: seagreen;
}

pre,code[class*="language-"] {
	line-height: 1.2em !important;
	font-size: 0.93em !important;
}

pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	overflow-x: auto;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: center;
	padding: 1em;
}
.home-link {
	flex-grow: 1;
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: .5em 1em;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	counter-reset: start-from var(--postlist-index);
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	font-style: italic;
}

/* may want to make the description text smaller at some stage */
.post-description-list {
	font-size: 1.0em;
}

.post-description-main {
	font-style: italic;
}

.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

blockquote {
	margin-top: 0px;
	margin-left: 0px;
	margin-bottom: 15px;
	padding-left: 15px;
	border-left: 5px solid lightgray;
}
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}
.utterances {
  margin-left: inherit !important;
}</style>
		

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4WQKBG0L4Y"></script>
    

	</head>
	<body>
		<a href="#main" id="skip-link" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">DJ Adams</a>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/">Home</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/blog/">Blog</a></li>
					<li class="nav-item"><a href="/feed/feed.xml">Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="main">
			<heading-anchors>
				


<h1 id="custom-sorting-and-grouping">Custom Sorting and Grouping</h1>

<ul class="post-metadata">
	<li><time datetime="2013-11-29">29 November 2013</time></li>
	<li><a href="/tags/sapcommunity/" class="post-tag">sapcommunity</a></li>
</ul>

<p class="post-description-main"></p>

<p><em>Learn how to control the order of groups in a sorted list. You don't do it directly with the grouper function, you do it with the sorter function.</em></p>
<p>One of the features of the app that the participants build in the CD168 sessions at SAP TechEd Amsterdam is a list of sales orders that can be grouped according to status or price (the screenshot shows the orders grouped by price).</p>
<p><img src="/images/2013/11/groupbyprice.png" alt="Screenshot of an example of grouping by price"></p>
<p>This is achieved by specifying a value for the vGroup parameter on the Sorter, as documented in the <a href="https://sapui5.hana.ondemand.com/sdk/#docs/api/symbols/sap.ui.model.Sorter.html">sap.ui.model.Sorter API reference</a>:</p>
<p><em>Configure grouping of the content, can either be true to enable grouping based on the raw model property value, or a function which calculates the group value out of the context (e.g. oContext.getProperty(&quot;date&quot;).getYear() for year grouping). The control needs to implement the grouping behaviour for the aggregation which you want to group.</em></p>
<p>So what this means is that you either specify a boolean true value, or the name of a function.</p>
<ul>
<li>use a boolean true to have the entries grouped &quot;naturally&quot; by their value: useful and useable where you have texts that will be the same for some entries</li>
<li>specify the name of a function that will do some custom grouping: useful where you have numeric values that you might want to group into sizes or ranges</li>
</ul>
<p>Here in the example in the screenshot on the left, we're using a custom grouper function to arrange the sales orders into value groups (less than EUR 5000, less than EUR 10,000 and more than EUR 10,000).</p>
<h2 id="group-order-challenge">Group Order Challenge</h2>
<p>But what if you wanted to influence not only the sort but also the order of the groups themselves? Specifically in this screenshot example, what if we wanted to have the &quot;&lt; 5000 EUR&quot; group appear first, then the &quot;&gt; 10,000 EUR&quot; group and finally the &quot;&lt; 10,000 EUR&quot; group? (This is a somewhat contrived example but you get the idea). This very question is one I was asking myself while preparing for the CD168 session, and also one I was asked by an attendee.</p>
<p>To understand how to do it, you have to understand that the relationship between the sorter and the grouper can be seen as a &quot;master / slave&quot; relationship. This is in fact reflected in how you specify the grouper - as a subordinate of the master.</p>
<p><strong>The sorter drives everything, and the grouper just gets a chance to come along for the ride.</strong></p>
<p>So to answer the question, and to illustrate it in code step by step, I've put together an example. It takes a simple list of numbers 1 to 30 and displays them in a list, and groups them into three size categories. You can specify in which order the groups appear, but the key mechanism to achieve this, as you'll see, is actually in the sorter.</p>
<h2 id="simple-and-complex-sorting">Simple and Complex Sorting</h2>
<p>To understand further, you have to remember that there's a simple sorter specification and a more complex one. Using a simple sorter is often the case, and you'd specify it like this:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/records'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>StandardListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'{amount}'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">sorter</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Sorter</span><span class="token punctuation">(</span><span class="token string">"amount"</span><span class="token punctuation">)</span> <span class="token comment">// &lt;---</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>This is nice and simple and sorts based on the value of the amount property, default ascending.</p>
<p>The complex sorter is where you can specify your own custom sorting logic, and you do that by creating an instance of a Sorter and then specifying your custom logic for the fnCompare function.</p>
<p>We'll be using the sorter with its own custom sorting logic.</p>
<h2 id="step-by-step">Step By Step</h2>
<p>So here's the example, described step by step. It's also available as a Gist on Github: <a href="https://gist.github.com/qmacro/7702371">Custom Sorter and Grouper in SAPUI5</a> and exposed in a runtime context using the bl.ocks.org facility: <a href="http://bl.ocks.org/qmacro/7702371">http://bl.ocks.org/qmacro/7702371</a>.</p>
<p>As the source code is available in the Gist, I won't bother showing you the HTML and SAPUI5 bootstrap, I'll just explain the main code base.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token keyword">var</span> sSM <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token comment">// &lt; 10  Small</span>
<span class="token keyword">var</span> sML <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>  <span class="token comment">// &lt; 15  Medium</span>
               <span class="token comment">//   15+ Large</span></code></pre>
<p>Here we just specify the boundary values for chunking our items up into groups. Anything less than 10 is &quot;Small&quot;, less than 15 is &quot;Medium&quot;, otherwise it's &quot;Large&quot;. I've deliberately chosen groupings that are not of equal size (the range is 1-30) just for a better visual example effect.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token comment">// Generate the list of numbers and assign to a model</span>
<span class="token keyword">var</span> aValues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> aValues<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span><span class="token function">getCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setModel</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>json<span class="token punctuation">.</span>JSONModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">records</span><span class="token operator">:</span> aValues<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> v <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>So we generate a list of numbers (I was really missing Python's xrange here, apropo of nothing!) and add it as a model to the core.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token comment">// Sort order and title texts of the S/M/L groups</span>
<span class="token keyword">var</span> mGroupInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token constant">S</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">order</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"Small"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token constant">M</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">order</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"Medium"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token constant">L</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">order</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"Large"</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Here I've created a map object that specifies the order in which the Small, Medium and Large groups should appear in the list (Medium first, then Small, then Large). The texts are what should be displayed in the group subheader/dividers in the list display.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token comment">// Returns to what group (S/M/L) a value belongs</span>
<span class="token keyword">var</span> <span class="token function-variable function">fGroup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v <span class="token operator">&lt;</span> sSM <span class="token operator">?</span> <span class="token string">"S"</span> <span class="token operator">:</span> v <span class="token operator">&lt;</span> sML <span class="token operator">?</span> <span class="token string">"M"</span> <span class="token operator">:</span> <span class="token string">"L"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This is just a helper function to return which size category (S, M or L) a given value belongs to.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token comment">// Grouper function to be supplied as 3rd parm to Sorter</span>
<span class="token comment">// Note that it uses the mGroupInfo, as does the Sorter</span>
<span class="token keyword">var</span> <span class="token function-variable function">fGrouper</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> v <span class="token operator">=</span> oContext<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> group <span class="token operator">=</span> <span class="token function">fGroup</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> group<span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> mGroupInfo<span class="token punctuation">[</span>group<span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Here's our custom Grouper function that will be supplied as the third parameter to the Sorter. It pulls the value of the property from the context object it receives, uses the fGroup function (above) to determine the size category, and then returns what a group function should return - an object with key and text properties that are then used in the display of the bound items.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token comment">// The Sorter, with a custom compare function, and the Grouper</span>
<span class="token keyword">var</span> oSorter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Sorter</span><span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> fGrouper<span class="token punctuation">)</span><span class="token punctuation">;</span>
oSorter<span class="token punctuation">.</span><span class="token function-variable function">fnCompare</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Determine the group and group order</span>
    <span class="token keyword">var</span> agroup <span class="token operator">=</span> mGroupInfo<span class="token punctuation">[</span><span class="token function">fGroup</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>order<span class="token punctuation">;</span>
    <span class="token keyword">var</span> bgroup <span class="token operator">=</span> mGroupInfo<span class="token punctuation">[</span><span class="token function">fGroup</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>order<span class="token punctuation">;</span>
    <span class="token comment">// Return sort result, by group ...</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>agroup <span class="token operator">&lt;</span> bgroup<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>agroup <span class="token operator">></span> bgroup<span class="token punctuation">)</span> <span class="token keyword">return</span>  <span class="token number">1</span><span class="token punctuation">;</span>
     <span class="token comment">// ... and then within group (when relevant)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">></span> b<span class="token punctuation">)</span> <span class="token keyword">return</span>  <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Here's our custom Sorter. We create one as normal, specifying the fact that we want the &quot;value&quot; property to be the basis of our sorting. The 'null' is specified in the ascending/descending position (default is ascending), and then we specify our Grouper function. Remember, the grouper just hitches a ride on the sorter.</p>
<p>Because we want to influence the sort order of the groups as well as the order of the items within each group, we have to determine to what group each of the two values to be compared belong. If the groups are different, we just return the sort result (-1 or 1) at the group level. But if the two values are in the same group then we have to make sure that the sort result is returned for the items themselves.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token comment">// Simple List in a Page</span>
<span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">pages</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Sorted Groupings"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/records'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>StandardListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'{value}'</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">sorter</span><span class="token operator">:</span> oSorter
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeAt</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>And that's pretty much it. Once we've done the hard work of writing our custom sorting logic, and shared the group determination between the Sorter and the Grouper (DRY!) we can just specify the custom Sorter in our binding of the items.</p>
<p>And presto! We have what we want - a sorted list of items, grouped, and those groups also in an order that we specify.</p>
<p><img src="/images/2013/11/sortedgroupings.png" alt="Sorted groupings example screenshot"></p>
<h2 id="post-script">Post Script</h2>
<p>There was a comment on this post which was very interesting and described a situation where you want to sort, and group, based on different properties. This is also possible. To achieve sorting on one property and grouping based on another, you have to recall that you can pass either a single Sorter object or an array of them, in the binding.</p>
<p>So let's say you have an array of records in your data model, and these records have a &quot;beerName&quot; and a &quot;beerType&quot; property. You want to group by beerType, and within beerType you want the actual beerNames sorted.</p>
<p>In this case, you could have two Sorters: One for the beerType, with a Grouper function, and another for the beerName. Like this:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">fGrouper</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">oContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> sType <span class="token operator">=</span> oContext<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"beerType"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">"Undefined"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> sType<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> sType <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">pages</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"Craft Beer"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>List</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>m<span class="token punctuation">.</span>StandardListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">"{beerName}"</span><span class="token punctuation">,</span>
                            <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">"{beerType}"</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">sorter</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                            <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Sorter</span><span class="token punctuation">(</span><span class="token string">"beerType"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> fGrouper<span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token keyword">new</span> <span class="token class-name">sap<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>model<span class="token punctuation">.</span>Sorter</span><span class="token punctuation">(</span><span class="token string">"beerName"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                        <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">placeAt</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>I've put <a href="https://github.com/qmacro/sapui5bin/blob/master/SortingAndGrouping/TwoProperties.html">a complete example</a> together for this, and it's in the <a href="https://blogs.sap.com/?p=79248">sapui5bin Github repo</a>.</p>
<p>And while we're on the subject of code examples, there's a <a href="https://github.com/qmacro/sapui5bin/blob/master/SortingAndGrouping/SingleProperty.html">complete example for the main theme of this post</a> too.</p>
<p>Share &amp; enjoy!</p>
<hr>
<p><a href="https://blogs.sap.com/2013/11/29/custom-sorter-and-grouper/">Originally published on SAP Community</a></p>



<script src="https://utteranc.es/client.js" repo="qmacro/qmacro.github.io" issue-term="title" crossorigin="anonymous" async=""></script>

<ul class="links-nextprev"><li class="links-nextprev-prev">← Previous<br> <a href="/blog/posts/2013/11/27/sap-uk-and-ireland-user-group-conference-demo-jam/">SAP UK &amp; Ireland User Group Conference - Demo Jam!</a></li><li class="links-nextprev-next">Next →<br><a href="/blog/posts/2013/12/02/mobile-dev-course-w3u3-rewrite-xml-views-an-analysis/">Mobile Dev Course W3U3 Rewrite - XML Views - An Analysis</a></li>
</ul>

			</heading-anchors>
		</main>

		<!-- This page `/blog/posts/2013/11/29/custom-sorting-and-grouping/` was built on 2025-12-08T20:46:58.893Z -->
		<script type="module" src="/dist/t-8sxMV3B9.js"></script>
	</body>
</html>
