<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick hack: Calendar Inviter</title>
    <meta name="description" content="Reserving the right to be wrong.">
    <link rel="stylesheet" href="/blog/css/index.css">
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="DJ Adams">
    <link rel="alternate" href="/blog/feed/feed.json" type="application/json" title="DJ Adams">
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/blog/">DJ Adams</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/blog/">Home</a></li>
        <li class="nav-item"><a href="/blog/about/">About</a></li>
        <li class="nav-item"><a href="/blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/blog/tags/">Tags</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>Quick hack: Calendar Inviter</h1>

<time datetime="2014-01-02">02 Jan 2014</time><a href="/blog/tags/appsscript/" class="post-tag">appsscript</a><a href="/blog/tags/calendar/" class="post-tag">calendar</a><a href="/blog/tags/gmail/" class="post-tag">gmail</a><a href="/blog/tags/google/" class="post-tag">google</a><a href="/blog/tags/outlook/" class="post-tag">outlook</a>

<p>Working in different organisations sometimes means having different email addresses and calendars. Currently I have two Outlook instances I have to manage (one for <a href="http://www.bluefinsolutions.com">Bluefin</a> and one for a client) on top of my Google-based personal calendar.</p>
<p>Keeping them in sync is a struggle that I avoid, but there’s recently been a specific case where I do want to make the effort, and that’s time / location scheduling – where I’ll be, on what days. This information needs to be in all calendars, to share with work colleagues, and for my own sanity (I see my Google calendar as my master instance in this case).</p>
<p><img src="/blog/img/2014/01/calendars.jpg" alt="image">So I wrote a quick Google Apps Script hack to allow me to quickly specify the where/when events in a particular Google calendar that I maintain (called “Work”), and then have those events distributed, via invitations, to my other Outlook identities. It’s not very sophisticated – all it does is look through the Work calendar for all-day events matching a certain title pattern, then look at the guest list; if the emails I want to share the event with are not already on the list, they’re added, and invites are sent.</p>
<p>Because of <a href="https://code.google.com/p/google-apps-script-issues/issues/detail?id=574">an issue with the CalendarService component of Google Apps Script</a> (that’s been open since May 2011!) you can’t directly cause invites to be sent to new guests that you add to an existing event. So one workaround is to create the calendar invitation (ICS file) yourself and email it. It’s pretty simple (and Romain Vialard <a href="https://code.google.com/p/google-apps-script-issues/issues/detail?id=574#c2">has an example</a> in the commentary on the issue).</p>
<p>Actually creating the ICS file myself was a solution to not one but two issues. The ICS files that are auto-generated by Google Calendar when you add a guest via the UI contain entries like this for all-day events:</p>
<p>DTSTART;VALUE=DATE:20140305<br>
DTEND;VALUE=DATE:20140306</p>
<p>Unfortunately Outlook makes an incorrect guess as to the timezone for these dates, based on its own timezone, and when the recipient calendar is in a different timezone than the originating event (in my case UTC and UTC+1), it causes the replicated entry to be skewed by an hour, causing the all-day event to span the wrong days! So being in control of the ICS content generation means I can be more explicit which in turn means that Outlook doesn’t get it wrong.</p>
<p>DTSTART:20140305T000000Z<br>
DTEND:20140306T000000Z</p>
<p>So that’s it. <a href="https://gist.github.com/qmacro/8219400">I’ve made the script available as a Gist</a> on Github and here’s a screenshot of some typical results.</p>
<p><img src="/blog/img/2014/01/log.jpg" alt="image"></p>
<p>Share &amp; enjoy!</p>
<p></p>
<p></p>

<hr>
<ul><li>Next: <a href="/blog/2014/5/2/alt-k-reading-notes/">Alt-K: Reading Notes</a></li><li>Previous: <a href="/blog/2013/27/11/sap-uk-and-ireland-user-group-conference-demo-jam/">SAP UK &amp; Ireland User Group Conference - Demo Jam!</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /blog/2014/2/1/quick-hack-calendar-inviter/ -->
  </body>
</html>
